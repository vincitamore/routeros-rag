<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : NTP</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="System-Information-and-Utilities_119144657.html">System Information and Utilities</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : NTP
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Unknown User (olga)</span>, last updated by <span class='editor'> Jānis Bērziņš</span> on May 08, 2025
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742032820 {padding: 0px;}
div.rbtoc1747742032820 ul {margin-left: 0px;}
div.rbtoc1747742032820 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742032820'>
<ul class='toc-indentation'>
<li><a href='#NTP-RouterOSversion6'>RouterOS version 6</a>
<ul class='toc-indentation'>
<li><a href='#NTP-SNTPClientproperties:'>SNTP Client properties:</a></li>
<li><a href='#NTP-Clientsettingsexample:'>Client settings example:</a></li>
<li><a href='#NTP-NTPServersettings:'>NTP Server settings:</a></li>
</ul>
</li>
<li><a href='#NTP-RouterOSversion7'>RouterOS version 7</a>
<ul class='toc-indentation'>
<li><a href='#NTP-NTPClientproperties:'>NTP Client properties:</a></li>
<li><a href='#NTP-NTPServersettings:.1'>NTP Server settings:</a></li>
</ul>
</li>
<li><a href='#NTP-Logmessages'>Log messages</a></li>
</ul>
</div></p><p>RouterOS v6 implements the SNTP protocol defined in RFC4330, manycast mode is not supported. SNTP client is included in the<span> </span><em>system</em><span> </span>package. To use an NTP server,<span> </span><em>ntp</em><span> </span>package must be<span> </span><a href="https://help.mikrotik.com/docs/display/ROS/Packages" rel="nofollow">installed and enabled</a>.</p><p>RouterOS v7 main package includes NTP client and server functionality, which is based on RFC5905.</p><p>The client configuration is located in the<span> </span><strong>/system ntp client</strong><span> </span>console path, and the <strong><em>&quot;System &gt; SNTP Client&quot;</em></strong> (RouterOS version 6), <strong><em>&quot;System &gt; NTP Client&quot;</em></strong> (RouterOS version 7) WinBox window. <span style="color:var(--ds-text-accent-blue-bolder,#09326c);">This configuration is shared by the SNTP client implementation in the <em>system</em> package and the NTP client implementation in the <em>ntp</em> package. When <em>ntp</em> package is installed and enabled, the SNTP client is disabled automatically.</span></p><h1 id="NTP-RouterOSversion6"><span style="font-size: 20.0px;letter-spacing: -0.008em;">RouterOS version 6</span></h1><h2 id="NTP-SNTPClientproperties:"><span style="font-size: 20.0px;letter-spacing: -0.008em;">S</span><span>NTP Client </span>properties:</h2><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>enabled</strong><span> </span>(<em>yes, no default:<span> </span>no</em>)</td><td class="confluenceTd">Enable SNTP client for time synchronization</td></tr><tr><td class="confluenceTd"><strong>mode</strong><span> </span>(<em>broadcast, unicast, filed is read-only</em>)</td><td class="confluenceTd">Mode that the SNTP client will operate in. If no NTP servers are configured<span> </span><em>broadcast</em><span> </span>mode will be used. If there is a dynamic or static NTP server IP address or FQDN used it will automatically switch to unicast mode.</td></tr><tr><td class="confluenceTd"><strong>primary-ntp</strong><span> </span>(<em>IP address default:<span> </span>0.0.0.0</em>)</td><td class="confluenceTd"><p>IP address of the NTP server that has to be used for time synchronization. If both values are non-zero, then the SNTP client will alternate between the two server addresses, switching to the other when the request to the current server times out or when the &quot;KoD&quot; packet is received, indicating that the server is not willing to respond to requests from this client.</p><p>The following formats are accepted:</p><p><em>- ipv4</em><br/><em>- ipv6</em></p></td></tr><tr><td class="confluenceTd"><strong>secondary-ntp</strong><span> </span>(<em>IP address default:<span> </span>0.0.0.0</em>)</td><td class="confluenceTd">see<span> </span><strong>primary-ntp</strong></td></tr><tr><td class="confluenceTd"><strong>server-dns-names</strong><span> </span>(<em>Comma separated domain name list default:<span> </span></em>)</td><td class="confluenceTd">To set the NTP server using its domain name. The domain name will be resolved each time an NTP request is sent. Router has to have<span> </span><em>/ip dns</em><span> </span>configured.</td></tr></tbody></table></div><p><strong><span class="mw-headline">Status</span></strong></p><ul><li><strong>active-server</strong><span> </span>(IP address; read-only property) : Currently selected NTP server address. This value is equal to<span> </span><strong>primary-ntp</strong><span> </span>or<span> </span><strong>secondary-ntp</strong>.</li><li><strong>poll-interval</strong><span> </span>(Time interval; read-only property) : Current interval between requests sent to the active server. The initial value is 16 seconds, and it is increased by doubling to 15 minutes.</li></ul><p><strong><span class="mw-headline">Last received packet information</span></strong></p><p>Values of the following properties are reset when the SNTP client is stopped or restarted, either because of a configuration change, or because of a network error.</p><ul><li><strong>last-update-from</strong><span> </span>(IP address; read-only property) : Source IP address of the last received NTP server packed that was successfully processed.</li><li><strong>last-update-before</strong><span> </span>(Time interval; read-only property) : Time since the last successfully received server message.</li><li><strong>last-adjustment</strong><span> </span>(Time interval; read-only property) : Amount of clock adjustment that was calculated from the last successfully received NTP server message.</li><li><strong>last-bad-packet-from</strong><span> </span>(IP address; read-only property) : Source IP address of last received SNTP packed that was not successfully processed. Reason of the failure and time since this packet was received is available in the next two properties.</li><li><strong>last-bad-packet-before</strong><span> </span>(Time interval; read-only property) : Time since the last receive failure.</li><li><strong>last-bad-packet-reason</strong><span> </span>(Text; read-only property) : Text that describes the reason of the last receive failure. Possible values are:<ul><li><em>bad-packet-length</em><span> </span>- Packet length is not in the acceptable range.</li><li><em>server-not-synchronized</em><span> </span>- Leap Indicator field is set to &quot;alarm condition&quot; value, which means that clock on the server has not been synchronized yet.</li><li><em>zero-transmit-timestamp</em><span> </span>- Transmit Timestamp field value is 0.</li><li><em>bad-mode</em><span> </span>- Value of the Mode field is neither 'server' nor 'broadcast'.</li><li><em>kod-ABCD</em><span> </span>- Received &quot;KoD&quot; (Kiss-o'-Death) response.<span> </span><em>ABCD</em><span> </span>is the short &quot;kiss code&quot; text from the Reference Identifier field.</li><li><em>broadcast</em><span> </span>- Received broadcast message, but<span> </span><strong>mode</strong>=<em>unicast</em>.</li><li><em>non-broadcast</em><span> </span>- Received packed was server reply, but<span> </span><strong>mode</strong>=<em>broadcast</em>.</li><li><em>server-ip-mismatch</em><span> </span>- Received response from address that is not<span> </span><strong>active-server</strong>.</li><li><em>originate-timestamp-mismatch</em><span> </span>- Originate Timestamp field in the server response message is not the same as the one included in the last request.</li><li><em>roundtrip-too-long</em><span> </span>- request/response roundtrip exceeded 1 second.</li></ul></li></ul><h2 id="NTP-Clientsettingsexample:"><span style="font-size: 20.0px;letter-spacing: -0.008em;">Client settings example: </span></h2><p>To check the status of the NTP client in CLI, use the &quot;print&quot; command</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@ntp-example_v6] &gt; /system ntp client print 
           enabled: no
       primary-ntp: 0.0.0.0
     secondary-ntp: 0.0.0.0
  server-dns-names: 
              mode: unicast</pre>
</div></div><p>To enable the NTP client and set IP addresses or FQDN of the NTP servers:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@ntp-example_v6] &gt; /system ntp client set enabled=yes
[admin@ntp-example_v6] &gt; /system ntp client print 
             enabled: yes
         primary-ntp: 0.0.0.0
       secondary-ntp: 0.0.0.0
    server-dns-names: 
                mode: unicast
     dynamic-servers: x.x.x.x, x.x.x.x
       poll-interval: 15s
       active-server: x.x.x.x
    last-update-from: x.x.x.x
  last-update-before: 6s570ms
     last-adjustment: -1ms786us
[admin@ntp-example_v6] &gt; /system ntp client set primary-ntp=162.159.200.123
[admin@ntp-example_v6] &gt; /system ntp client print 
           enabled: yes
       primary-ntp: 162.159.200.123
     secondary-ntp: 0.0.0.0
  server-dns-names: 
              mode: unicast
   dynamic-servers: x.x.x.x, x.x.x.x
     poll-interval: 16s
     active-server: x.x.x.x</pre>
</div></div><h2 id="NTP-NTPServersettings:"><span class="mw-headline">NTP Server settings:</span></h2><p>Server configuration is located in<span> </span><strong>/system ntp server</strong></p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 73.5688%;"><colgroup><col style="width: 22.4185%;"/><col style="width: 77.5815%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><p><strong>enabled</strong><span> </span>(<em>yes</em><span> </span>or<span> </span><em>no</em>; default value:<span> </span><em>no</em>)</p></td><td class="confluenceTd">Enable  NTP server</td></tr><tr><td class="confluenceTd"><p><strong>broadcast</strong><span> </span>(<em>yes</em><span> </span>or<span> </span><em>no</em>; default value:<span> </span><em>no</em>)</p></td><td class="confluenceTd">Enable certain NTP server mode, for this mode to work you have to set up broadcast-addresses field</td></tr><tr><td class="confluenceTd"><p><strong>multicast</strong><span> </span>(<em>yes</em><span> </span>or<span> </span><em>no</em>; default value:<span> </span><em>no</em>)</p></td><td class="confluenceTd">Enable certain NTP server mode</td></tr><tr><td class="confluenceTd"><p><strong>manycast</strong><span> </span>(<em>yes</em><span> </span>or<span> </span><em>no</em>; default value:<span> </span><em>no</em>)</p></td><td class="confluenceTd">Enable certain NTP server mode</td></tr><tr><td class="confluenceTd"><p><strong>broadcast-addresses</strong><span> </span>(<em>IP address</em>; default value: )</p></td><td class="confluenceTd">Set broadcast address to use for NTP server broadcast mode</td></tr></tbody></table></div><p><em><strong>Example:</strong></em></p><p>Set up an NTP server for the local network that is 192.168.88.0/24</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/system ntp server set broadcast=yes broadcast-addresses=192.168.88.255 enabled=yes manycast=no</pre>
</div></div><h1 id="NTP-RouterOSversion7"><span style="font-size: 20.0px;letter-spacing: -0.008em;">RouterOS version 7</span></h1><h2 id="NTP-NTPClientproperties:"><span style="font-size: 20.0px;letter-spacing: -0.008em;">NTP Client properties:</span></h2><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 73.5688%;"><colgroup><col style="width: 22.4185%;"/><col style="width: 77.5815%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>enabled</strong><span> </span>(<em>yes, no default:<span> </span>no</em>)</td><td class="confluenceTd">Enable NTP client for time synchronization</td></tr><tr><td class="confluenceTd"><strong>mode</strong><span> </span>(<em>broadcast, manycast, multicast, unicast</em>)</td><td class="confluenceTd">Mode that the NTP client will operate in</td></tr><tr><td class="confluenceTd"><p><strong>NTP servers</strong></p></td><td class="confluenceTd"><p>The list of NTP servers. It is possible to add static entries.</p><p>The following formats are accepted:</p><p>- <em>FQDN (&quot;Resolved Address&quot; will appear in the &quot;Servers&quot;- window in an appropriate column if the address is resolved) or IP address can be used. If DHCP-Client property <strong>use-peer-ntp=yes</strong> - the dynamic entries advertised by <a href="https://help.mikrotik.com/docs/display/ROS/DHCP" rel="nofollow">DHCP</a></em><br/><em><span style="color:var(--ds-text,#333333);">-<span> </span></span><em style="text-align: left;">ipv4</em><br style="text-align: left;"/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em style="text-align: left;">ipv4</em><code style="text-align: left;">@</code><em style="text-align: left;">vrf</em><br style="text-align: left;"/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em style="text-align: left;">ipv6</em><br style="text-align: left;"/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em style="text-align: left;">ipv6</em><code style="text-align: left;">@</code><em style="text-align: left;">vrf</em><br style="text-align: left;"/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em style="text-align: left;">ipv6-linklocal</em><code style="text-align: left;">%</code><em style="text-align: left;">interface</em></em></p></td></tr><tr><td class="confluenceTd"><strong>vrf</strong><span> </span>(<em>default: main</em>)</td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">Virtual Routing and Forwarding</span></td></tr><tr><td class="confluenceTd"><span style="color:var(--ds-text-accent-blue-bolder,#09326c);"><strong>Servers</strong> (<em>Button/Section</em>)</span></td><td class="confluenceTd"><p><span style="color:var(--ds-text-accent-blue-bolder,#09326c);">A detailed table of dynamically and statically added NTP servers (Address, Resolved address, Min Poll, Max Poll, iBurst, Auth. Key)</span></p><p><span style="color:var(--ds-text-accent-blue-bolder,#09326c);">To set the NTP server using its FQDN. The domain name will be resolved each time an NTP request is sent. Router has to have <em>/ip/dns</em> configured.</span></p></td></tr><tr><td class="confluenceTd"><p><span style="color:var(--ds-text-accent-blue-bolder,#09326c);"><strong>Peers</strong></span></p></td><td class="confluenceTd"><div class="content-wrapper"><p>Current parameter values</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@ntp-example_v7] &gt; /system/ntp/monitor-peers
 type=&quot;ucast-client&quot; address=x.x.x.x refid=&quot;y.y.y.y&quot; stratum=3 hpoll=10 ppoll=10 root-delay=28.869 ms root-disp=50.994 ms 
   offset=-0.973 ms delay=0.522 ms disp=15.032 ms jitter=0.521 ms 
-- [Q quit|D dump|C-z pause]

</pre>
</div></div></div></td></tr><tr><td class="confluenceTd"><p><strong>Keys</strong></p></td><td class="confluenceTd"><div class="content-wrapper"><p>NTP symmetric keys, used for authentication between the NTP client and server. Key Identifier (Key ID) - an integer identifying the cryptographic key used to generate the message-authentication code.</p></div></td></tr></tbody></table></div><p><strong><span class="mw-headline">Status</span></strong></p><ul><li><span class="mw-headline"><strong>synchronized, stopped, waiting, using-local-clock </strong>- Current status of the NTP client</span></li><li><span class="mw-headline"><strong>Frequency drift</strong> - The fractional frequency drift per unit time.</span></li><li><span class="mw-headline"><strong>synced-server</strong> - The IP address of the NTP Server.</span></li><li><span class="mw-headline"><strong>synced-stratum</strong> - The accuracy of each server is defined by a number called the stratum, with the topmost level (primary servers) assigned as one and each level downwards (secondary servers) in the hierarchy assigned as one greater than the preceding level.</span></li><li><span class="mw-headline"><strong><span style="color:var(--ds-text,#333333);">system-offset</span></strong><span style="color:var(--ds-text,#333333);"> - This is a signed, fixed-point number indicating the offset of the NTP server's clock relative to the local clock, in seconds.</span></span></li></ul><h2 id="NTP-NTPServersettings:.1">NTP Server settings:</h2><p>Server configuration is located in<span> </span><strong>/system ntp server</strong></p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 73.5688%;"><colgroup><col style="width: 22.4187%;"/><col style="width: 77.5821%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>enabled</strong><span><span> </span></span>(<em style="letter-spacing: 0.0px;">yes</em><span style="letter-spacing: 0.0px;"> </span><span style="letter-spacing: 0.0px;">or</span><span style="letter-spacing: 0.0px;"> </span><em style="letter-spacing: 0.0px;">no</em><span style="letter-spacing: 0.0px;">; default value:</span><span style="letter-spacing: 0.0px;"> </span><em style="letter-spacing: 0.0px;">no</em><span style="letter-spacing: 0.0px;">)</span></td><td class="confluenceTd">Enable NTP server</td></tr><tr><td class="confluenceTd"><p><strong>broadcast</strong><span> </span>(<em>yes</em><span> </span>or<span> </span><em>no</em>; default value:<span> </span><em>no</em>)</p></td><td class="confluenceTd">Enable certain NTP server mode, for this mode to work you have to set up broadcast-addresses field</td></tr><tr><td class="confluenceTd"><p><strong>multicast</strong><span> </span>(<em>yes</em><span> </span>or<span> </span><em>no</em>; default value:<span> </span><em>no)</em></p></td><td class="confluenceTd">Enable certain NTP server mode</td></tr><tr><td class="confluenceTd"><p><strong>manycast</strong> (<em>yes</em><span> </span>or<span> </span><em>no</em>; default value:<span> </span><em>no)</em></p></td><td class="confluenceTd">Enable certain NTP server mode</td></tr><tr><td class="confluenceTd"><p><strong>broadcast-addresses</strong><span> </span>(<em>IP address</em>; default value: )</p></td><td class="confluenceTd">Set broadcast address to use for NTP server broadcast mode</td></tr><tr><td class="confluenceTd"><p><strong>vrf</strong> (<em>default: main</em>)</p></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">Virtual Routing and Forwarding</span></td></tr><tr><td class="confluenceTd"><p><strong>use-local-clock</strong> (<em>yes</em><span> </span><span>or</span><span> </span><em>no</em><span>; default value:</span><span> </span><em>no</em>)</p></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">The server will supply its local system time as valid if others are not available.</span></td></tr><tr><td class="confluenceTd"><p><strong>local-clock-stratum</strong></p></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">Manually set stratum if <strong>use-local-clock=yes</strong></span></td></tr><tr><td class="confluenceTd"><p><strong>auth-key</strong> (<span>default value:</span><span> </span><em>none</em>)</p></td><td class="confluenceTd">NTP symmetric key, used for authentication between the NTP client and server. Key Identifier (Key ID) - an integer identifying the cryptographic key used to generate the message-authentication code.</td></tr></tbody></table></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>If you use use-local-clock, then be aware that the router's internal CPU clock is not a reliable time source for precise timing operations, as its frequency may vary due to power management, thermal conditions, and hardware differences, even between identical models. This variation is expected and does not affect normal router performance. For accurate timekeeping, it is recommended to use network-based time synchronisation, such as NTP (Network Time Protocol).</p></div></div><h1 id="NTP-Logmessages"><span class="mw-headline">Log messages</span></h1><p>SNTP client can produce the following log messages. See the article &quot;<a href="https://help.mikrotik.com/docs/display/ROS/Log" rel="nofollow">log</a>&quot; on how to set up logging and how to inspect logs.</p><ul><li><strong>ntp</strong>,<strong>debug</strong><span> </span>gradually adjust by<span> </span><em>OFFS</em></li><li><strong>ntp</strong>,<strong>debug</strong><span> </span>instantly adjust by<span> </span><em>OFFS</em></li><li><strong>ntp</strong>,<strong>debug</strong><span> </span>Wait for<span> </span><em>N</em><span> </span>seconds before sending the next message</li><li><strong>ntp</strong>,<strong>debug</strong><span> </span>Wait for<span> </span><em>N</em><span> </span>seconds before restarting</li><li><strong>ntp</strong>,<strong>debug</strong>,<strong>packet</strong><span> </span>packet receive an error, restarting</li><li><strong>ntp</strong>,<strong>debug</strong>,<strong>packet</strong><span> </span>received<span> </span><em>PKT</em></li><li><strong>ntp</strong>,<strong>debug</strong>,<strong>packet</strong><span> </span>ignoring received<span> </span><em>PKT</em></li><li><strong>ntp</strong>,<strong>debug</strong>,<strong>packet</strong><span> </span>error sending to<span> </span><em>IP</em>, restarting</li><li><strong>ntp</strong>,<strong>debug</strong>,<strong>packet</strong><span> </span>sending to<span> </span><em>IP</em><span> </span><em>PKT</em></li></ul><p>Explanation of log message fields</p><ul><li><em>OFFS</em><span> </span>- difference of two NTP timestamp values, in hexadecimal.</li><li><em>PKT</em><span> </span>- dump of NTP packet. If the packet is shorter than the minimum 48 bytes, it is dumped as a hexadecimal string. Otherwise, the packet is dumped as a list of field names and values, one per log line. Names of fields follow RFC4330.</li><li><em>IP</em><span> </span>- remote IP address.</li></ul><p><strong>NOTE</strong>: the above logging rules work only with the built-in SNTP client, the separate NTP package doesn't have any logging facilities.</p><p><br/></p><p><br/></p>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:53</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
