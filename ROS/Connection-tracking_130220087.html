<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : Connection tracking</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="Firewall-and-Quality-of-Service_119144601.html">Firewall and Quality of Service</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : Connection tracking
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Artūrs C.</span>, last updated by <span class='editor'> Unknown User (elvijsi)</span> on Aug 21, 2024
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742025951 {padding: 0px;}
div.rbtoc1747742025951 ul {margin-left: 0px;}
div.rbtoc1747742025951 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742025951'>
<ul class='toc-indentation'>
<li><a href='#Connectiontracking-Introduction'>Introduction</a></li>
<li><a href='#Connectiontracking-Connectionstates'>Connection states</a></li>
<li><a href='#Connectiontracking-FastTrack'>FastTrack</a>
<ul class='toc-indentation'>
<li><a href='#Connectiontracking-Requirements'>Requirements</a></li>
<li><a href='#Connectiontracking-Example'>Example</a></li>
</ul>
</li>
<li><a href='#Connectiontracking-Connectiontrackingsettings'>Connection tracking settings</a>
<ul class='toc-indentation'>
<li><a href='#Connectiontracking-Properties'>Properties</a></li>
</ul>
</li>
<li><a href='#Connectiontracking-ConnectionList'>Connection List</a>
<ul class='toc-indentation'>
<li><a href='#Connectiontracking-Properties.1'>Properties</a></li>
</ul>
</li>
</ul>
</div></p><h1 id="Connectiontracking-Introduction">Introduction</h1><p><br/></p><p><span>Connection tracking allows the kernel to keep track of all logical network connections or sessions, and thereby relate all of the packets which may make up that connection. </span></p><p><span>NAT relies on this information to translate all related packets in the same way. </span></p><p><span>Because of connection tracking you can use stateful firewall functionality even with stateless protocols such as UDP.</span></p><p><span>Firewall features affected by connection tracking:</span></p><ul><li>NAT</li><li>firewall:<ul><li>connection-bytes</li><li>connection-mark</li><li>connection-type</li><li>connection-state</li><li>connection-limit</li><li>connection-rate</li><li>layer7-protocol</li><li>new-connection-mark</li><li>tarpit</li></ul></li></ul><p><span>List of tracked connections can be seen in<span style="color:var(--ds-icon-success,#22a06b);"> </span></span><span style="color:var(--ds-background-accent-red-bolder,#c9372C);"><span style="color:var(--ds-icon-success,#22a06b);">/ip firewall connection</span> </span><span>for IPv4 and </span><span style="color:var(--ds-icon-success,#22a06b);">/ipv6 </span><span style="color:var(--ds-background-accent-red-bolder,#c9372C);"><span style="color:var(--ds-icon-success,#22a06b);">firewall connection</span> </span><span>for IPv6.</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false">      [admin@3C22-atombumba] /ip firewall connection&gt; print
      Flags: S - seen-reply, A - assured
      #    PR.. SRC-ADDRESS           DST-ADDRESS           TCP-STATE   TIMEOUT
      0    udp  10.5.8.176:5678       255.255.255.255:5678              0s
      1    udp  10.5.101.3:646        224.0.0.2:646                     5s
      2    ospf 10.5.101.161          224.0.0.5                         9m58s
      3    udp  10.5.8.140:5678       255.255.255.255:5678              8s
      4 SA tcp  10.5.101.147:48984    10.5.101.1:8291       established 4m59s
</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false">      [admin@3C22-atombumba] /ipv6 firewall connection&gt; print
      Flags: S - seen reply, A - assured
      #    PRO.. SRC-ADDRESS                 DST-ADDRESS                 TCP-STATE
      0    udp   fe80::d6ca:6dff:fe77:3698   ff02::1
      1    udp   fe80::d6ca:6dff:fe98:7c28   ff02::1
      2    ospf  fe80::d6ca:6dff:fe73:9822   ff02::5
</pre>
</div></div><h1 id="Connectiontracking-Connectionstates">Connection states</h1><p>Based on connection table entries arrived packet can get assigned one of the connection states: <strong>new, invalid, established, related,</strong> or <strong>untracked</strong>.</p><p>There are two different methods when the packet is considered <strong>new</strong>. The first one is in the case of stateless connections (like UDP) when there is no connection entry in the connection table. The other one is in the case of a stateful protocol (TCP). In this case, a new packet that starts a new connection is always a TCP packet with an <em>SYN</em> flag.</p><p>If a packet is not new it can belong to either an <strong><em>established</em></strong> or <strong><em>related</em></strong> connection or not belong to any connection making it<em> <strong>invalid</strong></em>. A packet with an <strong><em>established</em></strong> state, as most of you already guessed, belongs to an existing connection from the connection tracking table. A <strong><em>related</em></strong> state is very similar, except that the packet belongs to a connection that is related to one of the existing connections, for example, ICMP error packets or FTP data connection packets.</p><p>Connection state <strong>notrack</strong> is a special case when <strong>RAW</strong> firewall rules are used to exclude connection from connection tracking. This rule would make all forwarded traffic bypass the connection tracking, improving packet processing speed through the device.</p><p>Any other packet is considered <strong><em>invalid</em></strong> and in most cases should be dropped.</p><p>Based on this information we can set a basic set of filter rules to speed up packet filtering and reduce the load on the CPU by accepting <em>established/related</em> packets, dropping <em>invalid</em> packets, and working on more detailed filtering only for<em> new</em> packets.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">ip firewall filter
add chain=input connection-state=invalid action=drop comment=&quot;Drop Invalid connections&quot;
add chain=input connection-state=established,related,untracked action=accept comment=&quot;Allow Established/Related/Untracked connections</pre>
</div></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Such a rule set must not be applied on routers with asymmetric routing, because asymmetrically routed packets may be considered invalid and dropped.</p></div></div><h1 id="Connectiontracking-FastTrack"><span>FastTrack</span></h1><p>IPv4 FastTrack is a special handler that bypasses Linux facilities allowing for faster packet forwarding. The handler is used for <strong>TCP</strong> and <strong>UDP</strong> connections marked with &quot;<span style="color:var(--ds-icon-success,#22a06b);"><code>fasttrack-connection</code></span>&quot; action. IPv4 FastTrack handler supports NAT (SNAT, DNAT, or both).</p><p>Note that not all packets of the connection can be FastTracked, so it is likely to see some packets going through a slow path even though the connection is marked for FastTrack. This is the reason why <strong>fasttrack-connection</strong> is usually followed by an identical &quot;<code><span style="color:var(--ds-icon-success,#22a06b);"><em>action=accept</em></span></code>&quot; rule.</p><p>FastTrack-ed packets are bypassing:</p><ul><li> firewall,</li><li>connection tracking,</li><li>simple queues,</li><li>queue tree with <em>parent=global</em>,</li><li>IP accounting,</li><li>IPSec,</li><li>hotspot universal client,</li><li>VRF assignment</li></ul><p>It is up to the administrator to make sure FastTrack does not interfere with other configuration.</p><h2 id="Connectiontracking-Requirements"><span class="mw-headline">Requirements</span></h2><p>IPv4 FastTrack is active if the following conditions are met:</p><ul><li>no<span> </span>mesh,<span> </span>metarouter<span> </span>interface configuration;</li><li>sniffer,<span> </span>torch, or<span> </span>traffic generator<span> </span>is not running;</li><li><em>/tool mac-scan</em> is not actively used;</li><li><em>/tool ip-scan</em> is not actively used;</li><li>FastPath and Route cache is enabled under <em>IP/Settings</em></li></ul><h2 id="Connectiontracking-Example">Example</h2><p>For example, for SOHO routers with factory default configuration, you could FastTrack all LAN traffic with this one rule placed at the top of the Firewall Filter. The same configuration accept rule is required:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/ip firewall filter add chain=forward action=fasttrack-connection connection-state=established,related
/ip firewall filter add chain=forward action=accept connection-state=established,related</pre>
</div></div><div role="region" aria-label="Tip" class="confluence-information-macro  confluence-information-macro-tip" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><ul><li>Connection is FastTracked until the connection is closed, timed-out, or router is rebooted.</li><li>Dummy rules will disappear only after FastTrack firewall rules will be deleted/disabled and the router rebooted.</li><li>While FastPath and FastTrack both are enabled on the device only one can be active at a time.</li></ul></div></div><p><br/></p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Queues (except Queue Trees parented to interfaces), firewall filter, and mangle rules will not be applied for FastTracked traffic.</p></div></div><h1 id="Connectiontracking-Connectiontrackingsettings"><span class="mw-headline">Connection tracking settings</span></h1><p><span>Connection tracking settings are managed from </span><span style="color:var(--ds-background-accent-red-bolder,#c9372C);"><span style="color:var(--ds-icon-success,#22a06b);"><code>/ip firewall connection tracking</code></span> </span><span>menu.</span></p><h3 id="Connectiontracking-Properties"><span class="mw-headline">Properties</span></h3><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="margin-left: 20.8665px;width: 98.9444%;"><colgroup><col style="width: 12.1929%;"/><col style="width: 87.8071%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>enabled</strong><span> </span>(<em>yes | no | auto</em>; Default:<span> </span><strong>auto</strong>)</td><td class="confluenceTd">Allows to disable or enable connection tracking. With disabled connection tracking  firewall features listed above will stop working. If set to &quot;<span style="color:var(--ds-icon-success,#22a06b);">auto</span>&quot; connection tracking is disabled until at least one firewall rule is added.</td></tr><tr><td class="confluenceTd"><strong>loose-tcp-tracking</strong><span> </span>(<em>yes</em>; Default:<span> </span><strong>yes</strong>)</td><td class="confluenceTd"><ul><li>In case loose-tcp-tracking=yes, the 2nd part (SYN,ACK) and 3rd part (ACK) of the handshake without having seen the first initial SYN will be considered ESTABLISHED</li><li>In case loose-tcp-tracking=no, the 2nd part (SYN,ACK) and 3rd part (ACK) without having seen the first initial SYN will be considered INVALID</li></ul></td></tr><tr><td class="confluenceTd"><strong>tcp-syn-sent-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>5s</strong>)</td><td class="confluenceTd">TCP SYN timeout.</td></tr><tr><td class="confluenceTd"><strong>tcp-syn-received-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>5s</strong>)</td><td class="confluenceTd">TCP SYN timeout.</td></tr><tr><td class="confluenceTd"><strong>tcp-established-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>1d</strong>)</td><td class="confluenceTd">Time after which established TCP connection times out.</td></tr><tr><td class="confluenceTd"><strong>tcp-fin-wait-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>10s</strong>)</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>tcp-close-wait-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>10s</strong>)</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>tcp-last-ack-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>10s</strong>)</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>tcp-time-wait-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>10s</strong>)</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>tcp-close-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>10s</strong>)</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>udp-timeout</strong><span> </span>(<em>time</em>; Default:<span> <strong>3</strong></span><strong>0s</strong>)</td><td class="confluenceTd">Specifies the timeout for UDP connections that have seen packets in one direction</td></tr><tr><td class="confluenceTd"><strong>udp-stream-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>3m</strong>)</td><td class="confluenceTd">Specifies the timeout of UDP connections that have seen packets in both directions</td></tr><tr><td class="confluenceTd"><strong>icmp-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>10s</strong>)</td><td class="confluenceTd">ICMP connection timeout</td></tr><tr><td class="confluenceTd"><strong>generic-timeout</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>10m</strong>)</td><td class="confluenceTd">Timeout for all other connection entries</td></tr></tbody></table></div><p><br/><strong>Read-only properties</strong></p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="margin-left: 20.8665px;width: 98.985%;"><colgroup><col style="width: 12.3102%;"/><col style="width: 87.6898%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>max-entries</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd"><p>Max amount of entries that the connection tracking table can hold. This value depends on the installed amount of RAM.</p><p>Note that the system does not create a maximum-size connection tracking table when it starts, it may increase if the situation demands it and the system still has free RAM, but the size will not exceed 1048576</p></td></tr><tr><td style="vertical-align: top;" class="confluenceTd"><strong>total-entries</strong><span> </span>(<em>integer</em>)</td><td style="vertical-align: top;" class="confluenceTd">Amount of connections that the connection table currently holds</td></tr></tbody></table></div><p><br/></p><h1 id="Connectiontracking-ConnectionList"><span class="mw-headline">Connection List</span></h1><p><span>List of tracked connections ban be seen in<span style="color:var(--ds-icon-success,#22a06b);"> </span></span><span style="color:var(--ds-background-accent-red-bolder,#c9372C);"><span style="color:var(--ds-icon-success,#22a06b);">/ip firewall connection</span> </span><span>for ipv4 and </span><span style="color:var(--ds-icon-success,#22a06b);">/ipv6 </span><span style="color:var(--ds-background-accent-red-bolder,#c9372C);"><span style="color:var(--ds-icon-success,#22a06b);">firewall connection</span> </span><span>for IPv6.</span></p><h2 id="Connectiontracking-Properties.1"><span class="mw-headline">Properties</span></h2><p>All properties in the connection list are read-only</p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 98.579%;"><colgroup class=""><col class="" style="width: 12.4026%;"/><col class="" style="width: 87.5974%;"/></colgroup><tbody class=""><tr class=""><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr class=""><td class="confluenceTd"><strong>assured</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">Indicates that this connection is assured and that it will not be erased if the maximum possible tracked connection count is reached.</td></tr><tr class=""><td class="confluenceTd"><strong>confirmed</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">Connection is confirmed and a packet is sent out from the device. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>connection-mark</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">Connection mark that was set by<span> the </span>mangle<span> </span>rule.</td></tr><tr class=""><td class="confluenceTd"><strong>connection-type</strong><span> </span>(<em>pptp | ftp</em>)</td><td class="confluenceTd">Type of connection, the property is empty if connection tracking is unable to determine a predefined connection type.</td></tr><tr class=""><td class="confluenceTd"><strong>dst-address</strong><span> </span>(<em>ip[:port]</em>)</td><td class="confluenceTd">Destination address and port (for <strong>IPv4</strong> if a protocol is port-based).</td></tr><tr><td class="confluenceTd"><strong>dst-port<span> </span></strong>(<em>integer</em>)</td><td class="confluenceTd">Destination port if protocol is port-based. <strong>IPv6</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>dstnat</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">A connection has gone through DST-NAT (for example, port forwarding).</td></tr><tr class=""><td class="confluenceTd"><strong>dying</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">The connection is dying due to a connection timeout. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>expected</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">Connection is set up using connection helpers (pre-defined service rules). <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>fasttrack</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">Whether the connection is FastTracked. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>gre-key</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Contents of the GRE Key field.</td></tr><tr class=""><td class="confluenceTd"><strong>gre-protocol</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">Protocol of the encapsulated payload.</td></tr><tr class=""><td class="confluenceTd"><strong>gre-version</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">A version of the GRE protocol was used in the connection.</td></tr><tr><td class="confluenceTd"><strong>hw-offload<span> </span></strong>(<em>yes | no</em>)</td><td class="confluenceTd"><strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>icmp-code</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">ICMP Code Field</td></tr><tr class=""><td class="confluenceTd"><strong>icmp-id</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Contains the ICMP ID</td></tr><tr class=""><td class="confluenceTd"><strong>icmp-type</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">ICMP Type Number</td></tr><tr class=""><td class="confluenceTd"><strong>orig-bytes</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Amount of bytes sent out from the source address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>orig-fasttrack-bytes</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Amount of FastTracked bytes sent out from the source address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>orig-fasttrack-packets</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Amount of FastTracked packets sent out from the source address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>orig-packets</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Amount of packets sent out from the source address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>orig-rate</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">The data rate at which packets are sent out from the source address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>protocol</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">IP protocol type</td></tr><tr class=""><td class="confluenceTd"><strong>repl-bytes</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Amount of bytes received from the destination address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>repl-fasttrack-bytes</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">Amount of FastTracked bytes received from the destination address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>repl-fasttrack-packets</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Amount of FastTracked packets received from the destination address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>repl-packets</strong><span> </span>(<em>integer</em>)</td><td class="confluenceTd">Amount of packets received from the destination address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>repl-rate</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">The data rate at which packets are received from the destination address using the specific connection. <strong>IPv4</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>reply-dst-address</strong><span> </span>(<em>ip[:port]</em>)</td><td class="confluenceTd">Destination address (and port for <strong>IPv4</strong>) expected of return packets. Usually the same as &quot;src-address: port&quot;</td></tr><tr><td class="confluenceTd"><strong>reply-dst-port<span> </span></strong>(<em>integer</em>)</td><td class="confluenceTd"><strong>IPv6</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>reply-src-address</strong><span> </span>(<em>ip[:port]</em>)</td><td class="confluenceTd">Source address (and port for <strong>IPv4</strong>) expected of return packets. Usually the same as &quot;dst-address: port&quot;</td></tr><tr class=""><td class="confluenceTd"><strong>seen-reply</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">The destination address has replied to the source address.</td></tr><tr class=""><td class="confluenceTd"><strong>src-address</strong><span> </span>(<em>ip[:port]</em>)</td><td class="confluenceTd">The source address and port (for <strong>IPv4</strong> if a protocol is port-based).</td></tr><tr><td class="confluenceTd"><strong>src-port<span> </span></strong>(<em>integer</em>)</td><td class="confluenceTd"><strong>IPv6</strong> only.</td></tr><tr class=""><td class="confluenceTd"><strong>srcnat</strong><span> </span>(<em>yes | no</em>)</td><td class="confluenceTd">Connection is going through SRC-NAT, including packets that were masqueraded through NAT.</td></tr><tr class=""><td class="confluenceTd"><strong>tcp-state</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd">The current state of TCP connection :<ul><li>&quot;established&quot;</li><li>&quot;time-wait&quot;</li><li>&quot;close&quot;</li><li>&quot;syn-sent&quot;</li><li>&quot;syn-received&quot;</li></ul></td></tr><tr class=""><td class="confluenceTd"><strong>timeout</strong><span> </span>(<em>time</em>)</td><td class="confluenceTd">Time after connection will be removed from the connection list.</td></tr></tbody></table></div>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/130220087/130220088.png">Screenshot_1.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:53</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
