<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : Bonding</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="High-Availability-Solutions_120324133.html">High Availability Solutions</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : Bonding
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Māris B.</span>, last updated by <span class='editor'> Ričards I.</span> on Feb 19, 2025
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="Bonding-/*&lt;![CDATA[*/div.rbtoc1747742029020{padding:0px;}div.rbtoc1747742029020ul{margin-left:0px;}div.rbtoc1747742029020li{margin-left:0px;padding-left:0px;}/*]]&gt;*/#Bonding-Summary#Bonding-SummaryQuickSetupGuide#Bonding-QuickSetupGuideLinkmonitoring#Bond"><span class="mw-headline"><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742029020 {padding: 0px;}
div.rbtoc1747742029020 ul {margin-left: 0px;}
div.rbtoc1747742029020 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742029020'>
<ul class='toc-indentation'>
<li><a href='#Bonding-'></a></li>
<li><a href='#Bonding-Summary'>Summary</a></li>
<li><a href='#Bonding-QuickSetupGuide'>Quick Setup Guide</a></li>
<li><a href='#Bonding-Linkmonitoring'>Link monitoring</a>
<ul class='toc-indentation'>
<li><a href='#Bonding-ARPMonitoring'>ARP Monitoring</a></li>
<li><a href='#Bonding-MIImonitoring'>MII monitoring</a></li>
</ul>
</li>
<li><a href='#Bonding-Bondingmodes'>Bonding modes</a>
<ul class='toc-indentation'>
<li><a href='#Bonding-802.3ad'>802.3ad</a></li>
<li><a href='#Bonding-balance-xor'>balance-xor</a></li>
<li><a href='#Bonding-balance-rr'>balance-rr</a></li>
<li><a href='#Bonding-active-backup'>active-backup</a></li>
<li><a href='#Bonding-broadcast'>broadcast</a></li>
<li><a href='#Bonding-balance-tlb'>balance-tlb</a>
<ul class='toc-indentation'>
<li><a href='#Bonding-Configurationexample'>Configuration example</a></li>
</ul>
</li>
<li><a href='#Bonding-balance-alb'>balance-alb</a></li>
</ul>
</li>
<li><a href='#Bonding-Bondingmonitoring'>Bonding monitoring</a></li>
<li><a href='#Bonding-PropertyDescription'>Property Description</a></li>
<li><a href='#Bonding-Seealso'>See also</a></li>
</ul>
</div></span></h1><h1 id="Bonding-Summary"><span class="mw-headline">Summary</span></h1><hr/><p>Bonding is a technology that allows aggregation of multiple ethernet-like interfaces into a single virtual link, thus getting higher data rates and providing failover. </p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Interface bonding does not create an interface with a larger link speed. Interface bonding creates a virtual interface that can load balance traffic over multiple interfaces. More details can be found in the<span> </span><a href="https://help.mikrotik.com/docs/display/ROS/Layer2+misconfiguration#Layer2misconfiguration-LAGinterfacesandloadbalancing" rel="nofollow">LAG interfaces and load balancing</a><span> </span>page.</p></div></div><p><br/></p><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-text,#172b4d);">CRS3xx, CRS5xx series switches, CCR2116, CCR2216 routers and 88E6393X, 88E6191X, 88E6190 switch chips support bridge hardware offloading with bonding interfaces. Only</span><span style="color:var(--ds-text,#172b4d);"> </span><code>802.3ad</code><span style="color:var(--ds-text,#172b4d);"> </span><span style="color:var(--ds-text,#172b4d);">and</span><span style="color:var(--ds-text,#172b4d);"> </span><code>balance-xor </code><span style="color:var(--ds-text,#172b4d);">bonding modes are hardware offloaded, other bonding modes will use the CPU's resources. T<span style="color:var(--ds-text,#333333);">he built-in switch chip will always use Layer2+Layer3+Layer4 for a transmit hash policy, changing the transmit hash policy manually will have no effect. See more details on <a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx,+CRS5xx,+CCR2116,+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Bonding" rel="nofollow">CRS3xx, CRS5xx, CCR2116, CCR2216 switch chip features</a>.</span></span></p></div></div><p><br/></p><h1 id="Bonding-QuickSetupGuide"><span class="mw-headline">Quick Setup Guide</span></h1><hr/><p>Let us assume that we have two Ethernet interfaces on each router (Router1 and Router2) and want to get the maximum data rate between these two routers. To make this possible, follow these steps:</p><ol><li>Make sure that you do not have IP addresses on interfaces that will be enslaved for bonding interface.</li><li><p class="auto-cursor-target">Add bonding interface and IP address on the Router1:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bonding add slaves=ether1,ether2 name=bond1
/ip address add address=172.16.0.1/24 interface=bond1</pre>
</div></div></li><li><p class="auto-cursor-target">Do the same thing on the Router2:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bonding add slaves=ether1,ether2 name=bond1
/ip address add address=172.16.0.2/24 interface=bond1</pre>
</div></div></li><li><p class="auto-cursor-target">Test the link from Router1:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@Router1] &gt; ping 172.16.0.2
  SEQ HOST                                 SIZE TTL TIME  STATUS                   
    0 172.16.0.2                             56  64 0ms  
    1 172.16.0.2                             56  64 0ms  
    2 172.16.0.2                             56  64 0ms  
    sent=3 received=3 packet-loss=0% min-rtt=0ms avg-rtt=0ms max-rtt=0ms</pre>
</div></div></li></ol><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-text,#333333);">The bonding interface needs a couple of seconds to get connectivity with its peers.</span></p></div></div><h1 id="Bonding-Linkmonitoring"><span class="mw-headline">Link monitoring</span></h1><hr/><p>It is critical that one of the available link monitoring options is enabled. In the above example, if one of the bonded links were to fail, the bonding driver will still continue to send packets over the failed link which will lead to network degradation. Bonding in RouterOS currently supports two schemes for monitoring a link state of slave devices: MII and ARP monitoring. It is not possible to use both methods at the same time due to restrictions in the bonding driver.</p><h2 id="Bonding-ARPMonitoring"><span class="mw-headline">ARP Monitoring</span></h2><p>ARP monitoring sends ARP queries and uses the response as an indication that the link is operational. The ARP replies are not validated, any received packet by the slave interface will result in the slave interface considered as active. This gives assurance that traffic is actually flowing over the links. If balance-rr and balance-xor modes are set, then the switch should be configured to evenly distribute packets across all links. Otherwise, all replies from the ARP targets will be received on the same link which could cause other links to fail. ARP monitoring is enabled by setting three properties -<span> </span>link-monitoring,<span> </span>arp-ip-targets<span> </span>and<span> </span>arp-interval. The meaning of each option is described later in this article. It is possible to specify multiple ARP targets that can be useful in High Availability setups. If only one target is set, the target itself may go down. Having additional targets increases the reliability of the ARP monitoring.</p><p>To enable ARP monitoring on Router1:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bonding set [find name=bond1] link-monitoring=arp arp-ip-targets=172.16.0.2</pre>
</div></div><p><span style="letter-spacing: 0.0px;">and Router2:</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bonding set [find name=bond1] link-monitoring=arp arp-ip-targets=172.16.0.1</pre>
</div></div><p><span style="letter-spacing: 0.0px;">We will not change</span><span style="letter-spacing: 0.0px;"> the </span><span style="letter-spacing: 0.0px;">arp-interval</span><span style="letter-spacing: 0.0px;"> </span><span style="letter-spacing: 0.0px;">value in our example, RouterOS sets</span><span style="letter-spacing: 0.0px;"> </span><span style="letter-spacing: 0.0px;">arp-interval</span><span style="letter-spacing: 0.0px;"> </span><span style="letter-spacing: 0.0px;">to 100ms by default. </span>Unplug one of the cables to test if the link monitoring works correctly, you might notice some ping timeouts until arp monitoring detects link failure.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false">[admin@MikroTik] &gt; ping 172.16.0.2
  SEQ HOST                                     SIZE TTL TIME  STATUS                                 
    0 172.16.0.2                                 56  64 0ms  
    1 172.16.0.2                                 56  64 0ms  
    2 172.16.0.2                                 56  64 0ms  
    3 172.16.0.2                                 56  64 0ms  
    4 172.16.0.2                                              timeout                                
    5 172.16.0.2                                 56  64 0ms  
    6 172.16.0.2                                 56  64 0ms  
    sent=7 received=6 packet-loss=14% min-rtt=0ms avg-rtt=0ms max-rtt=0ms</pre>
</div></div><p><br/></p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>For ARP monitoring to work properly it is not required to have any IP address on the device, ARP monitoring will work regardless of the IP address that is set on any interface.</p></div></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>When ARP monitoring is used, bonding slaves will send out ARP requests without a VLAN tag, even if an IP address is set on a VLAN interface in the same subnet as the<span> </span>arp-ip-targets</p></div></div><h2 id="Bonding-MIImonitoring"><span class="mw-headline">MII monitoring</span></h2><p>MII monitoring monitors only the state of the local interface.<span> </span><em>MII Type 1</em><span> </span>- a device driver determines whether a link is up or down. If the device driver does not support this option then the link will appear as always up. The main disadvantage is that MII monitoring can't tell if the link can actually pass packets or not, even if the link is detected as being up. MII monitoring is configured by setting the variables -<span> </span>link-monitoring and<span> </span>mii-interval.</p><p>To enable MII Type1 monitoring on Router1 and Router2:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bonding set [find name=bond1] link-monitoring=mii</pre>
</div></div><p><span style="letter-spacing: 0.0px;">We will leave</span><span style="letter-spacing: 0.0px;"> </span><span style="letter-spacing: 0.0px;">mii-interval</span><span style="letter-spacing: 0.0px;"> </span><span style="letter-spacing: 0.0px;">to its default value (100ms). </span>When unplugging one of the cables, the failure will be detected almost instantly compared to ARP link monitoring.</p><h1 id="Bonding-Bondingmodes"><span class="mw-headline">Bonding modes</span></h1><hr/><h2 id="Bonding-802.3ad"><span class="mw-headline">802.3ad</span></h2><p>802.3ad mode is an IEEE standard also called LACP (Link Aggregation Control Protocol). It includes automatic configuration of the aggregates, so minimal configuration of the switch is needed. This standard also mandates that frames will be delivered in order and connections should not see misordering of packets. The standard also mandates that all devices in the aggregate must operate at the same speed and duplex mode.</p><p>LACP balances outgoing traffic across the active ports based on hashed protocol header information and accepts incoming traffic from any active port. The hash includes the Ethernet source and destination address and if available, the VLAN tag, and the IPv4/IPv6 source and destination address. How this is calculated depends on<span> </span>transmit-hash-policy<span> </span>parameter. The ARP link monitoring is not recommended, because the ARP replies might arrive only on one slave port due to transmit hash policy on the LACP peer device. This can result in unbalanced transmitted traffic, so MII link monitoring is the recommended option.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The layer-3-and-4<span> </span>transmit hash mode is not fully compatible with LACP. More details can be found in<span> </span><a class="external-link" href="https://www.kernel.org/doc/Documentation/networking/bonding.txt" rel="nofollow" style="text-decoration: none;">https://www.kernel.org/doc/Documentation/networking/bonding.txt</a></p></div></div><h2 id="Bonding-balance-xor"><span class="mw-headline">balance-xor</span></h2><p>This mode balances outgoing traffic across the active ports based on the hashed protocol header information and accepts incoming traffic from any active port. The mode is very similar to<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#802.3ad" rel="nofollow" style="text-decoration: none;">LACP</a><span> </span>except that it is not standardized and works with<span> </span><strong>layer-3-and-4</strong><span> </span>hash policy. The mode can work together with static Link Aggregation Group (LAG) interfaces.</p><h2 id="Bonding-balance-rr"><span class="mw-headline">balance-rr</span></h2><p>If this mode is set, packets are transmitted in sequential order from the first available slave to the last. The balance-rr is the only mode that will send packets across multiple interfaces that belong to the same TCP/IP connection. When utilizing multiple sending and multiple receiving links, packets are often received out of order, which results in segment retransmission, for other protocols such as UDP it is not a problem if a client software can tolerate out-of-order packets. If a switch is used to aggregate links together, then appropriate switch port configuration is required, however many switches do not support balance-rr. <a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#Quick_Setup_Guide" rel="nofollow" style="text-decoration: none;">Quick setup guide</a><span> </span>demonstrates the usage of the balance-rr bonding mode. As you can see, it is quite simple to set up. Balance-rr is also useful for bonding several wireless links, however, it requires equal bandwidth for all bonded links. If the bandwidth of one bonded link drops, then the total bandwidth of bond will be equal to the bandwidth of the slowest bonded link.</p><h2 id="Bonding-active-backup"><span class="mw-headline">active-backup</span></h2><p>This mode uses only one active slave to transmit packets. The additional slave only becomes active if the primary slave fails. The MAC address of the bonding interface is presented onto the active port to avoid confusing the switch. Active-backup is the best choice in high availability setups with multiple switches that are interconnected.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The ARP monitoring in this mode will not work correctly if both routers are directly connected. In such setups,<span> </span>MII<span> </span>monitoring must be used or a switch should be put between routers.</p></div></div><h2 id="Bonding-broadcast"><span class="mw-headline">broadcast</span></h2><p>When ports are configured with broadcast mode, all slave ports transmit the same packets to the destination to provide fault tolerance. This mode does not provide load balancing.</p><h2 id="Bonding-balance-tlb"><span class="mw-headline">balance-tlb</span></h2><p>This mode balances outgoing traffic by peer. Each link can be a different speed and duplex mode and no specific switch configuration is required as for the other modes. The downside of this mode is that only MII link monitoring is supported (ARP link monitoring is ignored when configured) and incoming traffic is not balanced. Incoming traffic will use the link that is configured as &quot;primary&quot;.</p><h3 id="Bonding-Configurationexample">Configuration example</h3><p>Let's assume that the router has two links -<span> </span><strong>ether1</strong><span> </span>max bandwidth is 10Mbps and<span> </span><strong>ether2</strong><span> </span>max bandwidth is 5Mbps. The first link has more bandwidth so we set it as a primary link:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bonding add mode=balance-tlb slaves=ether1,ether2 primary=ether1</pre>
</div></div><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" draggable="false" src="attachments/8323193/54853766.jpg" data-image-src="attachments/8323193/54853766.jpg" data-unresolved-comment-count="0" data-linked-resource-id="54853766" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Bon-tlb.jpg" data-base-url="https://help.mikrotik.com/docs" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="8323193" data-linked-resource-container-version="40" tabindex="0" alt=""></span></p><p>No additional configuration is required for the switch. The image above illustrates how<span> </span>balance-tlb<span> </span>mode works. As you can see router can communicate to all the clients connected to the switch with a total bandwidth of both links (15Mbps). But as you already know, balance-tlb is not balancing incoming traffic. In our example, clients can communicate to the router with a total bandwidth of primary link which is 10Mbps in our configuration.</p><h2 id="Bonding-balance-alb"><span class="mw-headline">balance-alb</span></h2><p>The mode is basically the same as balance-tlb but incoming IPv4 traffic is also balanced. The receive load balancing is achieved by ARP negotiation. The bonding driver intercepts locally generated ARP messages on their way out and overwrites the source hardware address with the unique address of one of the slaves in the bond such that different peers use different hardware addresses. Only MII link monitoring is supported (ARP link monitoring is ignored when configured), the additional downside of this mode is that it requires device driver capability to change MAC address. The mode is not compatible with <span style="color:var(--ds-icon-success,#22a06b);">local-proxy-arp</span> setting.</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" draggable="false" src="attachments/8323193/54853767.jpg" data-image-src="attachments/8323193/54853767.jpg" data-unresolved-comment-count="0" data-linked-resource-id="54853767" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Bon-alb.jpg" data-base-url="https://help.mikrotik.com/docs" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="8323193" data-linked-resource-container-version="40" tabindex="0" alt=""></span><br/>The image above illustrates how<span> </span>balance-alb<span> </span>mode works. Compared to<span> </span>balance-tlb<span> </span>mode, traffic from clients can also use the secondary link to communicate with the router.</p><h1 id="Bonding-Bondingmonitoring">Bonding monitoring</h1><hr/><p>Since RouterOS 6.48 version, it is possible to monitor the bonding interface and bonding ports. For the <code>802.3ad</code> bonding mode, more detailed monitoring options are available.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false">/interface bonding monitor [find] 
                      mode: 802.3ad           active-backup
              active-ports: ether4            ether6
                            ether5            
            inactive-ports:                   ether7
            lacp-system-id: CC:2D:E0:11:22:33 
      lacp-system-priority: 65535             
    lacp-partner-system-id: B8:69:F4:44:55:66</pre>
</div></div><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="letter-spacing: 0.0px;width: 100.0%;"><colgroup><col style="width: 19.6093%;"/><col style="width: 80.3615%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>mode</strong> (<em>802.3ad | active-backup | balance-alb | balance-rr | balance-tlb | balance-xor | broadcast</em>)</td><td class="confluenceTd">Used bonding mode</td></tr><tr><td class="confluenceTd"><strong>active-ports</strong> (<em>interface</em>)</td><td class="confluenceTd">Shows the active bonding ports</td></tr><tr><td colspan="1" class="confluenceTd"><strong>inactive-ports </strong>(<em>interface</em>)</td><td colspan="1" class="confluenceTd">Shows the inactive bonding ports (e.g. a disabled or backup interface)</td></tr><tr><td class="confluenceTd"><strong>lacp-system-id</strong> (<em>MAC address</em>)</td><td class="confluenceTd">Shows the local LACP system ID</td></tr><tr><td class="confluenceTd"><strong>lacp-system-priority</strong> (<em>integer</em>)</td><td class="confluenceTd">Shows the local LACP priority</td></tr><tr><td class="confluenceTd"><strong>lacp-partner-system-id</strong> (<em>MAC address</em>)</td><td class="confluenceTd">Shows the partner LACP system ID</td></tr></tbody></table></div><p class="auto-cursor-target">To monitor individual bonding ports, use a<span style="color:var(--ds-text-accent-magenta,#943d73);"> <code>monitor-slaves</code></span> command.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false">/interface bonding monitor-slaves bond1
Flags: A - active, P - partner 
 AP port=ether4 key=17 flags=&quot;A-GSCD--&quot; partner-sys-id=D4:CA:6D:12:06:65 partner-sys-priority=65535 partner-key=9 partner-flags=&quot;A-GSCD--&quot; 

 AP port=ether5 key=17 flags=&quot;A-GSCD--&quot; partner-sys-id=D4:CA:6D:12:06:65 partner-sys-priority=65535 partner-key=9 partner-flags=&quot;A-GSCD--&quot; </pre>
</div></div><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 100.0%;"><colgroup><col style="width: 19.6745%;"/><col style="width: 80.2962%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><span><strong>port</strong> </span>(<em>interface</em>)</td><td class="confluenceTd">Used bonding port</td></tr><tr><td class="confluenceTd"><span><strong>key</strong> </span>(<em>integer</em>)</td><td class="confluenceTd">Shows the local LACP aggregation key. The lower 6 bits are automatically assigned based on individual port link speed and duplex. The upper 10 bits can be manually specified using the<code><span style="color:var(--ds-icon-success,#22a06b);"> lacp-user-key</span></code> setting (available only since RouterOS v7.3). </td></tr><tr><td class="confluenceTd"><span><strong>flags</strong> </span>(<em>string</em>)</td><td class="confluenceTd"><p>Shows the local LACP flags:</p><p>A - activity (link is active, otherwise passive)<br/>T - timeout (link is using short 1-second timeout, otherwise using 30-second timeout)<br/>G - aggregation (link can be aggregatable)<br/>S - synchronization (link is synchronized)<br/>C - collecting (link is able to collect incoming frames)<br/>D - distributing (link is able to distribute outgoing frames)<br/>F - defaulted (link is using defaulted partner information, indicated that no LACPDU has been received from the partner)<br/>E - expired (link has expired state)</p></td></tr><tr><td colspan="1" class="confluenceTd"><strong>partner-sys-id</strong> (<em>MAC address</em>)</td><td colspan="1" class="confluenceTd">Shows the partner LACP system ID</td></tr><tr><td colspan="1" class="confluenceTd"><strong>partner-sys-priority</strong> (<em>integer</em>)</td><td colspan="1" class="confluenceTd">Shows the partner LACP priority</td></tr><tr><td colspan="1" class="confluenceTd"><strong>partner-key</strong> (<em>integer</em>)</td><td colspan="1" class="confluenceTd">Shows the partner LACP aggregation key</td></tr><tr><td colspan="1" class="confluenceTd"><strong>partner-flags</strong> (<em>string</em>)</td><td colspan="1" class="confluenceTd">Shows the partner LACP flags</td></tr></tbody></table></div><h1 id="Bonding-PropertyDescription"><span class="mw-headline">Property Description</span></h1><hr/><p>This section describes the available bonding settings. </p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>arp</strong><span> </span>(<em>disabled | enabled | proxy-arp | reply-only</em>; Default:<span> </span><strong>enabled</strong>)</td><td class="confluenceTd">Address Resolution Protocol for the interface.<ul class="bullets"><li>disabled<span> </span>- the interface will not use ARP</li><li>enabled<span> </span>- the interface will use ARP</li><li>proxy-arp<span> </span>- the interface will use the ARP proxy feature</li><li>reply-only<span> </span>- the interface will only reply to requests originated from matching IP address/MAC address combinations which are entered as static entries in the &quot;/ip arp&quot; table. No dynamic entries will be automatically stored in the &quot;/ip arp&quot; table. Therefore for communications to be successful, a valid static entry must already exist.</li></ul></td></tr><tr><td class="confluenceTd"><strong>arp-interval</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>00:00:00.100</strong>)</td><td class="confluenceTd">Time in milliseconds defines how often to monitor ARP requests</td></tr><tr><td class="confluenceTd"><strong>arp-ip-targets</strong><span> </span>(<em>IP address</em>; Default: )</td><td class="confluenceTd">IP target address which will be monitored if<span> </span>link-monitoring<span> </span>is set to arp. You can specify multiple IP addresses, separated by a comma</td></tr><tr><td class="confluenceTd"><strong>comment</strong><span> </span>(<em>string</em>; Default: )</td><td class="confluenceTd">Short description of the interface</td></tr><tr><td class="confluenceTd"><strong>disabled</strong><span> </span>(<em>yes | no</em>; Default:<span> </span><strong>no</strong>)</td><td class="confluenceTd">Changes whether the bonding interface is disabled</td></tr><tr><td class="confluenceTd"><strong>down-delay</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>00:00:00</strong>)</td><td class="confluenceTd">If a link failure has been detected, the bonding interface is disabled for<span> a </span>down-delay<span> </span>time. The value should be a multiple of<span> </span>mii-interval, <span style="color:var(--ds-text,#333333);">otherwise, it will be rounded down to the nearest value. This property only has an effect when <code>link-monitoring</code> is set to <code>mii</code>.</span></td></tr><tr><td class="confluenceTd"><strong>forced-mac-address</strong><span> </span>(<em>MAC address</em>; Default:<span> </span><strong>none</strong>)</td><td class="confluenceTd">By default, the bonding interface will use the MAC address of the first selected slave interface. This property allows to configure static MAC address for the bond interface (all zeros, broadcast or multicast addresses will not apply). RouterOS will automatically change the MAC address for slave interfaces and it will be visible in<span> </span><code>/interface ethernet</code><span> </span>configuration export</td></tr><tr><td class="confluenceTd"><strong>lacp-rate</strong><span> </span>(<em>1sec | 30secs</em>; Default:<span> </span><strong>30secs</strong>)</td><td class="confluenceTd">Link Aggregation Control Protocol rate specifies how often to exchange with LACPDUs between bonding peers. Used to determine whether a link is up or other changes have occurred in the network. LACP tries to adapt to these changes providing failover.</td></tr><tr><td class="confluenceTd"><strong>lacp-user-key </strong>(<em>integer: 0..1023</em>; Default: <strong>0</strong>)</td><td class="confluenceTd">Specifies the upper 10 bits of the port key. The lower 6 bits are automatically assigned based on individual port link speed and duplex. The setting is available only since RouterOS v7.3.</td></tr><tr><td class="confluenceTd"><strong>link-monitoring</strong><span> </span>(<em>arp | mii | none</em>; Default:<span> </span><strong>mii</strong>)</td><td class="confluenceTd">Method to use for monitoring the link (whether it is up or down)<ul class="bullets"><li>arp<span> </span>- uses Address Resolution Protocol to determine whether the remote interface is reachable</li><li>mii<span> </span>- uses Media Independent Interface to determine link status. Link status determination relies on the device driver.</li><li>none<span> </span>- no method for link monitoring is used.</li></ul><strong>Note:</strong><span> </span>some bonding modes require specific link monitoring to work properly.</td></tr><tr><td class="confluenceTd"><strong>min-links</strong><span> </span>(<em>integer: 0..4294967295</em>; Default:<span> </span><strong>0</strong>)</td><td class="confluenceTd">How many active slave links needed for bonding to become active</td></tr><tr><td class="confluenceTd"><strong>mii-interval</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>00:00:00.100</strong>)</td><td class="confluenceTd">How often to monitor the link for failures (the parameter used only if<span> </span>link-monitoring<span> </span>is mii)</td></tr><tr><td class="confluenceTd"><strong>mlag-id</strong><span> </span>(<em><em style="text-align: left;">integer: 0..4294967295</em><span style="color:var(--ds-text,#172b4d);">;<span> </span></span></em><span style="color:var(--ds-text,#172b4d);">Default:</span>)</td><td class="confluenceTd">Changes MLAG ID for bonding interface. The same MLAG ID should be used on both peer devices to successfully create a single MLAG. See more details on <a href="https://help.mikrotik.com/docs/display/ROS/Multi-chassis+Link+Aggregation+Group" rel="nofollow">MLAG</a>.</td></tr><tr><td class="confluenceTd"><strong>mode</strong><span> </span>(<em>802.3ad | active-backup | balance-alb | balance-rr | balance-tlb | balance-xor | broadcast</em>; Default:<span> </span><strong>balance-rr</strong>)</td><td class="confluenceTd">Specifies one of the bonding policies<ul class="bullets"><li>802.3ad<span> </span>- IEEE 802.3ad dynamic link aggregation. In this mode, the interfaces are aggregated in a group where each slave shares the same speed. It provides fault tolerance and load balancing. Slave selection for outgoing traffic is done according to the<span> </span>transmit-hash-policy<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#802.3ad" rel="nofollow" style="text-decoration: none;">more&gt;</a></li><li>active-backup<span> </span>- provides link backup. Only one slave can be active at a time. Another slave only becomes active, if the first one fails.<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#active-backup" rel="nofollow" style="text-decoration: none;">more&gt;</a></li><li>balance-alb<span> </span>- adaptive load balancing. The same as<span> </span>balance-tlb<span> </span>but received traffic is also balanced. The device driver should have support for changing it's MAC address.<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#balance-alb" rel="nofollow" style="text-decoration: none;">more&gt;</a></li><li>balance-rr<span> </span>- round-robin load balancing. Slaves in a bonding interface will transmit and receive data in sequential order. It provides load balancing and fault tolerance.<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#balance-rr" rel="nofollow" style="text-decoration: none;">more&gt;</a></li><li>balance-tlb<span> </span>- Outgoing traffic is distributed according to the current load on each slave. Incoming traffic is not balanced and is received by the current slave. If receiving slave fails, then another slave takes the MAC address of the failed slave.<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#balance-tlb" rel="nofollow" style="text-decoration: none;">more&gt;</a></li><li>balance-xor<span> </span>- Transmit based on the selected<span> </span>transmit-hash-policy. This mode provides load balancing and fault tolerance.<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#balance-xor" rel="nofollow" style="text-decoration: none;">more&gt;</a></li><li>broadcast<span> </span>- Broadcasts the same data on all interfaces at once. This provides fault tolerance but slows down traffic throughput on some slow machines.<span> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Interface/Bonding#broadcast" rel="nofollow" style="text-decoration: none;">more&gt;</a></li></ul></td></tr><tr><td class="confluenceTd"><strong>mtu</strong><span> </span>(<em>integer</em>; Default:<span> </span><strong>1500</strong>)</td><td class="confluenceTd">Maximum Transmit Unit in bytes. Must be smaller or equal to the smallest L2MTU value of a bonding slave. L2MTU of a bonding interface is determined by the lowest L2MTU value among its slave interfaces</td></tr><tr><td class="confluenceTd"><strong>name</strong><span> </span>(<em>string</em>; Default: )</td><td class="confluenceTd">Name of the bonding interface</td></tr><tr><td class="confluenceTd"><strong>primary</strong><span> </span>(<em>string</em>; Default: <strong>none</strong>)</td><td class="confluenceTd">Controls the primary interface between active slave ports, works only for active-backup, balance-tlb and balance-alb modes. For active-backup mode, it controls which running interface is supposed to send and receive the traffic. For balance-tlb mode, it controls which running interface is supposed to receive all the traffic, but for balance-alb mode, it controls which interface is supposed to receive the unbalanced traffic (the non-IPv4 traffic). When none of the interfaces are selected as primary, device will automatically select the interface that is configured as the first one.</td></tr><tr><td class="confluenceTd"><strong>slaves</strong><span> </span>(<em>string</em>; Default:<span> </span><strong>none</strong>)</td><td class="confluenceTd">At least two ethernet-like interfaces separated by a comma, which will be used for bonding</td></tr><tr><td class="confluenceTd"><strong>up-delay</strong><span> </span>(<em>time</em>; Default:<span> </span><strong>00:00:00</strong>)</td><td class="confluenceTd">If a link has been brought up, the bonding interface is disabled for<span> </span>up-delay<span> </span>time and after this time it is enabled. The value should be a multiple of<span> </span>mii-interval<span style="color:var(--ds-text,#333333);">, otherwise, it will be rounded down to the nearest value. This property only has an effect when <code>link-monitoring</code> is set to <code>mii</code>.</span></td></tr><tr><td class="confluenceTd"><strong>transmit-hash-policy</strong><span> </span>(<em>encap-2-and-3 | encap-3-and-4 | layer-2 | layer-2-and-3 | layer-3-and-4</em>; Default:<span> </span><strong>layer-2</strong>)</td><td class="confluenceTd"><p>Selects the transmit hash policy to use for slave selection in balance-xor and 802.3ad modes</p><ul class="bullets"><li data-uuid="472ba209-6735-497b-9f9a-3abd995f0ff9">encap-2-and-3 - This policy works like the layer-2-and-3 method for distributing traffic, but uses a process to also analyze the encapsulated packet headers. If an encapsulation protocol (like tunneling) is used, it may select the inner headers instead of the outer ones. RouterOS can use this feature when tunnels like 6to4, GRE, GRE6, IPIP, IPIP6, PPPoE, or PPTP are run over a bonding interface.</li><li data-uuid="220fb43c-a00d-4b0f-97ca-eeb5a9b90ed1">encap-3-and-4 - This policy works like the layer-3-and-4 method for distributing traffic, but uses a process to also analyze the encapsulated packet headers. If an encapsulation protocol (like tunneling) is used, it may select the inner headers instead of the outer ones. RouterOS can use this feature when tunnels like 6to4, GRE, GRE6, IPIP, IPIP6, PPPoE, or PPTP are run over a bonding interface.</li><li>layer-2<span> </span>- Uses XOR of hardware MAC addresses to generate the hash. This algorithm will place all traffic to a particular network peer on the same slave. This algorithm is 802.3ad compliant.</li><li>layer-2-and-3<span> </span>- This policy uses a combination of layer2 and layer3 protocol information to generate the hash. Uses XOR of hardware MAC addresses and IP addresses to generate the hash. This algorithm will place all traffic to a particular network peer on the same slave. For non-IP traffic, the formula is the same as for the layer2 transmit hash policy. This policy is intended to provide a more balanced distribution of traffic than layer2 alone, especially in environments where a layer3 gateway device is required to reach most destinations. This algorithm is 802.3ad compliant.</li><li>layer-3-and-4<span> </span>- This policy uses upper layer protocol information, when available, to generate the hash. This allows for traffic to a particular network peer to span multiple slaves, although a single connection will not span multiple slaves. For fragmented TCP or UDP packets and all other IP protocol traffic, the source and destination port information is omitted. For non-IP traffic, the formula is the same as for the layer2 transmit hash policy. This algorithm is not fully 802.3ad compliant.</li></ul></td></tr></tbody></table></div><h1 id="Bonding-Seealso"><span class="mw-headline">See also</span></h1><ul><li><a class="external-link" href="https://wiki.mikrotik.com/images/f/f7/X1-Bondingv01.2006.pdf" rel="nofollow" style="text-decoration: none;">Bonding presentation at the MUM</a></li><li><a class="external-link" href="https://wiki.mikrotik.com/wiki/Bonding_Examples" rel="nofollow" style="text-decoration: none;" title="Bonding Examples">Bonding Examples</a></li></ul>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/8323193/21725197.png">Bon-tlb.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/8323193/21725198.png">Bon-alb.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/8323193/54853766.jpg">Bon-tlb.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/8323193/54853767.jpg">Bon-alb.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:53</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
