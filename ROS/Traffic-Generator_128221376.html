<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : Traffic Generator</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="119144606.html">Diagnostics, monitoring and troubleshooting</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : Traffic Generator
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Unknown User (emils)</span>, last updated by <span class='editor'> Druvis Timma</span> on Jul 10, 2024
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><span class="mw-headline"><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742046947 {padding: 0px;}
div.rbtoc1747742046947 ul {margin-left: 0px;}
div.rbtoc1747742046947 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742046947'>
<ul class='toc-indentation'>
<li><a href='#TrafficGenerator-Summary'>Summary</a></li>
<li><a href='#TrafficGenerator-'></a></li>
<li><a href='#TrafficGenerator-General'>General</a></li>
<li><a href='#TrafficGenerator-PacketTemplate'>Packet Template</a></li>
<li><a href='#TrafficGenerator-PortConfiguration'>Port Configuration</a></li>
<li><a href='#TrafficGenerator-Stats'>Stats</a>
<ul class='toc-indentation'>
<li><a href='#TrafficGenerator-LatencyDistribution'>Latency Distribution</a></li>
<li><a href='#TrafficGenerator-StreamStats'>Stream Stats</a></li>
<li><a href='#TrafficGenerator-PortStats'>Port Stats</a></li>
<li><a href='#TrafficGenerator-RawStats'>Raw Stats</a></li>
</ul>
</li>
<li><a href='#TrafficGenerator-Streams'>Streams</a></li>
<li><a href='#TrafficGenerator-ConfigurationExamples'>Configuration Examples</a>
<ul class='toc-indentation'>
<li><a href='#TrafficGenerator-IPsectunnelperformancetest'>IPsec tunnel performance test</a></li>
</ul>
</li>
</ul>
</div></span></p><h1 id="TrafficGenerator-Summary"><span class="mw-headline">Summary</span></h1><p>Traffic Generator is a tool that allows evaluating the performance of DUT (Device Under Test) or SUT (System Under Test).</p><p>The tool can generate and send RAW packets over specific ports. It also collects latency and jitter values, TX/RX rates, counts lost packets, and detects Out-of-Order (OOO) packets.</p><p>Traffic Generator can be used similar to <a href="https://help.mikrotik.com/docs/display/ROS/Bandwidth+Test" rel="nofollow">bandwidth test </a>tool as well as generate packets that will be routed back to packet generator for advanced status collection.</p><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>In a device, which generates packets, it will not be possible to capture packets generated by the traffic-generator with a sniffer tool, torch, or firewall on the outgoing interface.</p><p>Since this tool could be used maliciously, it is possible to lock this functionality by entering the command '/system device-mode update traffic-gen=no' and holding the reset button afterwards.</p></div></div><h1 id="TrafficGenerator-"><span class="mw-headline"><iframe class="youtube-player" type="text/html" style="width: 400px; height: 300px"
	src="//www.youtube.com/embed/hR7fmPOPCvM?wmode=opaque" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen>
</iframe>
    
</span></h1><h1 id="TrafficGenerator-General"><span class="mw-headline">General</span></h1><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator</pre>
</div></div><p>This menu allows to set general traffic generator properties and contains commands to quickly start and stop the tool.</p><p><br/><strong>Properties</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.0332%;"><colgroup><col style="width: 9.98094%;"/><col style="width: 90.0191%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>latency-distribution-max</strong> (<em>time</em>; Default: <strong>100us</strong>)</td><td class="confluenceTd">Maximal latency range for latency distribution measurements. Based on this value, RouterOS will decide what latency range to use as the latency-distribution-measure-interval property</td></tr><tr><td class="confluenceTd"><strong>measure-out-of-order</strong> (<em>yes | no</em>; Default: )</td><td class="confluenceTd">Whether to measure Out-of-Order packets. The default value is based on CPU type (multi-core CPU default <strong>no</strong>; single-core CPU default <strong>yes</strong>). When the property is enabled on the multi-core device, a single stream will utilize only a single CPU core</td></tr><tr><td class="confluenceTd"><strong>stats-samples-to-keep</strong> (<em>integer</em>; Default: <strong>100</strong>)</td><td class="confluenceTd">How many data examples to collect</td></tr><tr><td class="confluenceTd"><strong>test-id</strong> (<em>integer [0..255]</em>; Default: <strong>0</strong>)</td><td class="confluenceTd"><br/></td></tr></tbody></table></div><p><br/><strong>Read-Only Properties</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.3958%;"><colgroup><col style="width: 9.91173%;"/><col style="width: 90.0883%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>latency-distribution-samples</strong> (<em>integer</em>)</td><td class="confluenceTd">Shows how many individual time periods the latency-distribution-measure-interval is divided into</td></tr><tr><td class="confluenceTd"><strong>latency-distribution-measure-interval</strong> (<em>time</em>)</td><td class="confluenceTd">Shows total latency measurement range</td></tr><tr><td class="confluenceTd"><strong>running</strong> (<em>yes | no</em>)</td><td class="confluenceTd">Shows whether the traffic generator tool is started.</td></tr></tbody></table></div><p><br/><strong>Commands</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.5468%;"><colgroup><col style="width: 9.89727%;"/><col style="width: 90.1027%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>quick</strong> ()</td><td class="confluenceTd">This command allows to quickly start the packet generator and print the stats output to the terminal. Command also accepts several parameters that override settings in packet template and stream settings. Accepted parameters are <strong>duration, entries-to-show, freeze-frame-interval, id, interface, mbps, measure-out-of-order, packet-count, packet-size, port, pps, stream, test-id, tx-template</strong><ul><li>tx-template - packet templates to generate traffic (max 16 templates)</li><li>duration - how long to run the test</li><li>entries-to-show - how many status lines print to the terminal</li><li>freeze-frame-interval - how often to update the status to the terminal</li></ul><p>The rest of the parameters are not command-specific and are described elsewhere.</p>Parameters specified when running quick command override configured values. In case if a parameter is specified only for one header then the value is multiplied for all the other headers (if required).</td></tr><tr><td class="confluenceTd"><strong>start</strong> ()</td><td class="confluenceTd">Commands start the traffic generator tool in the background. It accepts one parameter <strong>test-id</strong></td></tr><tr><td class="confluenceTd"><strong>stop</strong> ()</td><td class="confluenceTd">Command stops the started traffic generator tool by <strong>start</strong> command.</td></tr><tr><td class="confluenceTd"><strong>inject</strong> ()</td><td class="confluenceTd">Inject raw data into the interface.</td></tr><tr><td class="confluenceTd"><strong>inject-pcap</strong> ()</td><td class="confluenceTd">Inject raw data directly from pcap file.</td></tr></tbody></table></div><h1 id="TrafficGenerator-PacketTemplate"><span class="mw-headline">Packet Template</span></h1><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator packet-template</pre>
</div></div><p>This sub-menu allows building packets based on provided parameters. Based on parameters you can build IP packets with VLAN tags and set UDP ports. A raw packet template is generated based on provided parameters.</p><p>If you require more low-level packets or take full advantage of the traffic generator, then please use a raw-packet-template builder to build the packet.</p><p>If the same type of header is present in the packet more than once then header field values are passed as a comma-separated list. (For example, if there are two IP headers then source addresses are given like &quot;IP-src=1.1.1.1,2.2.2.2&quot;).</p><p>For quicker header construction many of the header field values are assumed. For example, if the header stack is &quot;mac, IP&quot; then the traffic generator can assume that the mac-protocol value is &quot;IP&quot;. Or if the &quot;port&quot; or &quot;interface&quot; setting is specified traffic generator can assume &quot;mac-src&quot; to be the MAC address of the interface). Assumed values have distinct names that start with &quot;assumed-&quot; and are read-only. Manually specified values override assumed ones.</p><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body">Assumed values are not automatically updated. New values are assumed after template edit. &quot;packet-template set 0&quot; is enough to trigger new assumed values</div></div><p><strong>Properties</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.577%;"><colgroup><col style="width: 16.5112%;"/><col style="width: 83.4888%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>comment</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Short description of the packet you are building.</td></tr><tr><td class="confluenceTd"><strong>compute-checksum-from-offset</strong> (<em>no-checksum | integer[0..4294967295]</em>; Default: )</td><td class="confluenceTd">specifies the byte offset from where in the packet 2-byte checksum will be calculated (Example: set to 14, to skip packets Ethernet header when calculating checksum)</td></tr><tr><td class="confluenceTd"><strong>data</strong> (<em>incrementing | random | specific-byte | uninitialized</em>; Default: <strong>uninitialized</strong>)</td><td class="confluenceTd">Specifies how packet payload will be filled:<ul><li><strong>uninitialized</strong> - packets data (after the header) is uninitialized, but not zero. Fastest.</li><li><strong>specific-byte</strong> - works together with setting data-byte</li><li><strong>incrementing</strong> - packets data filled with &quot;00 01 02 03&quot; and so on</li><li><strong>random</strong> - packets data filled with random bytes. Slowest.</li></ul></td></tr><tr><td class="confluenceTd"><strong>data-byte</strong> (<em>hex [0..FF]]</em>; Default: <strong>0</strong>)</td><td class="confluenceTd">A byte will be used to fill the packet payload.</td></tr><tr><td class="confluenceTd"><strong>interface</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Optional parameter of packet template. This is mutually exclusive with the &quot;port&quot; setting. Specifying &quot;interface&quot; allows users not to create a port entry for interface in the port menu. In fact, a port entry is created dynamically. This is useful for running quick tests.</td></tr><tr><td class="confluenceTd"><strong>ip-dscp</strong> (<em>list of integer[0..255] (max 16 times)</em>; Default: )</td><td class="confluenceTd">Single or list of DS Fields that will be set in IP header (DS Field contains DSCP value and the ECN value)</td></tr><tr><td class="confluenceTd"><strong>ip-dst</strong> (<em>list of IP/Netmask (max 16 times)</em>; Default: )</td><td class="confluenceTd">List of destination IP addresses that will be used when generating IP headers.</td></tr><tr><td class="confluenceTd"><strong>ip-frag-off</strong> (<em>list of integer[0..65535] (max 16 times)</em>; Default: )</td><td class="confluenceTd">List of fragmentation offsets in IP header.</td></tr><tr><td class="confluenceTd"><strong>ip-gateway</strong> (<em>IP</em>; Default: )</td><td class="confluenceTd">In situations when sender and receiver are the same devices, it is impossible to determine next-hop automatically from <strong>ip-dst</strong>. If ip-gateway is specified packet template will assume the destination mac address based on resolved ip-gateway.</td></tr><tr><td class="confluenceTd"><strong>ip-id</strong> (<em>list of integer [0..65535]</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>ip-protocol</strong> (<em>list of IP protocols (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>ip-src</strong> (<em>list of IP/Mask (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>ip-ttl</strong> (<em>list of integer [0..255] (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>mac-dst</strong> (<em>list of MAC/MASK (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>mac-protocol</strong> (<em>list of mac protocols (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>mac-src</strong> (<em>list of MAC/MASK (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>name</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Descriptive name of the template.</td></tr><tr><td class="confluenceTd"><strong>port</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Optional parameter of packet template. This suggests a port through which packets generated using this template should be sent out. Port can also be specified in other places such as in stream settings. This is mutually exclusive with interface setting.</td></tr><tr><td class="confluenceTd"><strong>raw-header</strong> (<em>string (max 16 times)</em>; Default: )</td><td class="confluenceTd">Raw packet header as string in hexadecimal format.</td></tr><tr><td class="confluenceTd"><strong>udp-dst-port</strong> (<em>list of port [0..65535]/mask [0..FFFF] (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>udp-src-port</strong> (<em>list of port [0..65535]/mask [0..FFFF] (max 16 times)</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>vlan-id</strong> (; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>vlan-priority</strong> (; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>vlan-protocol</strong> (; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>header-stack</strong> (<em>list of ip | mac | raw | udp | vlan (max 16 times)</em>; Default: <strong>ip</strong>)</td><td class="confluenceTd">A sequence of headers that a generated packet should have.<p>Currently supports:</p><ul><li><strong>mac</strong> - Ethernet header (14 bytes)</li><li><strong>vlan</strong> - Ethernet VLAN tag (4 bytes)</li><li><strong>ip</strong> - IPv4 header (20 bytes)</li><li><strong>udp</strong> - UDP header (8 bytes)</li><li><strong>raw</strong> - arbitrary bytes specified as a hex string</li></ul><p><br/>Most header types can be present in the header multiple times. There can be only 2 IP headers and 1 UDP header per packet. Some limitations are imposed on possible sequences of headers based on our practical experience with network protocols (for example VLAN header can follow only a mac header or other VLAN header).</p>The traffic generator suggests the first header for a packet template (in the port menu). But it is not enforced.</td></tr></tbody></table></div><h1 id="TrafficGenerator-PortConfiguration"><span class="mw-headline">Port Configuration</span></h1><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator port</pre>
</div></div><p>This menu allows configuring ports that will be associated with a specific interface and will be used to receive/send generated packets.</p><p><br/><strong>Properties</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.5166%;"><colgroup><col style="width: 8.17621%;"/><col style="width: 91.8238%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>disabled</strong> (<em>yes | no</em>; Default: <strong>no</strong>)</td><td class="confluenceTd">Whether the port is disabled and does not participate in receiving/sending the packets</td></tr><tr><td class="confluenceTd"><strong>name</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Descriptive name of the port</td></tr><tr><td class="confluenceTd"><strong>interface</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Name of the interface associated with the port.</td></tr></tbody></table></div><p><br/><strong>Read-Only Properties</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.3958%;"><colgroup><col style="width: 8.03106%;"/><col style="width: 91.9689%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>dynamic</strong> (<em>yes | no</em>)</td><td class="confluenceTd">Whether the port configuration is generated automatically.</td></tr><tr><td class="confluenceTd"><strong>first-header</strong> (<em>ip | mac | raw | udp | vlan</em>)</td><td class="confluenceTd">Shows suggested the first header for packets to be sent out of the specified interface. This information can be used when creating packet templates.</td></tr><tr><td class="confluenceTd"><strong>inactive</strong> (<em>yes | no</em>)</td><td class="confluenceTd">Whether the port is inactive and can't participate in tx/rx of the packets.</td></tr></tbody></table></div><h1 id="TrafficGenerator-Stats"><span class="mw-headline">Stats</span></h1><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator stats</pre>
</div></div><p>If the traffic generator is not running in <strong>quick</strong> mode then all statistics about the test is stored in this menu.</p><h2 id="TrafficGenerator-LatencyDistribution"><span class="mw-headline">Latency Distribution</span></h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false"> /tool traffic-generator stats latency-distribution</pre>
</div></div><p>This sub-menu shows how many packets are received in a specific latency range. Latency range can be viewed by streams or by sequences (for example, <strong>print stream-num=3</strong>, <strong>print seq=10</strong>)</p><p>Here is an example output of the latency graph:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@test-host] /tool traffic-generator stats latency-distribution&gt; print            
 # LATENCY                 COUNT        SHARE GRAPH                                               
 0 0-15.5us                    0           0%
 1 15.5us-31us                 0           0%
 2 31us-46.5us                 0           0%
 3 46.5us-62.1us               0           0%
 4 62.1us-77.6us               0           0%
 5 77.6us-93.1us               0           0%
 6 93.1us-109us                0           0%
 7 109us-124us                 0           0%
 8 124us-140us                 0           0%
 9 140us-155us                 0           0%
10 155us-171us                 0           0%
11 171us-186us                 4           0% *                                                   
12 186us-202us                29           0% *                                                   
13 202us-217us                90       0.001% *                                                   
14 217us-233us               302       0.004% *                                                   
15 233us-248us               630       0.009% *                                                   
16 248us-264us               789       0.011% *                                                   
17 264us-279us             1 384       0.021% -*                                                  
18 279us-295us             1 990        0.03% --*                                                 
19 295us-310us             2 966       0.045% ---*                                                
20 310us-326us             4 089       0.062% -----*                                              
21 326us-341us             4 958       0.075% ------*                                             
22 341us-357us             6 059       0.091% -------*                                            
23 357us-372us             6 660       0.101% --------*                                           
24 372us-388us             8 320       0.126% ----------*                                         
25 388us-403us             9 988       0.151% -------------*                                      
26 403us-419us            11 781       0.178% ---------------*                                    
27 419us-434us            12 512       0.189% ----------------*                                   
28 434us-450us            13 836        0.21% -----------------*                                  
29 450us-465us            15 681       0.238% --------------------*                               
30 465us-481us            17 740       0.269% ----------------------*                             
31 481us-496us            19 913       0.302% --------------------------*                         
32 496us-512us            21 106        0.32% ---------------------------*                        
33 512us-528us            22 848       0.346% -----------------------------*                      
34 528us-543us            25 059        0.38% --------------------------------*                   
35 543us-559us            26 593       0.403% ----------------------------------*                 
36 559us-574us            27 663       0.419% -----------------------------------*                
37 574us-590us            29 351       0.445% -------------------------------------*              
38 590us-605us            31 265       0.474% ----------------------------------------*           
39 605us-621us            33 224       0.504% -------------------------------------------*        
40 621us-636us            34 464       0.523% --------------------------------------------*       
41 636us-652us            35 630        0.54% ----------------------------------------------*     
42 652us-667us            37 245       0.565% ------------------------------------------------*   
43 667us-683us            38 158       0.579% -------------------------------------------------*  
44 683us-698us            38 626       0.586% --------------------------------------------------* 
45 698us-714us            38 985       0.591% --------------------------------------------------* 
46 714us-729us            39 061       0.592% --------------------------------------------------* 
47 729us-745us            39 750       0.603% ---------------------------------------------------*
48 745us-760us            39 145       0.594% --------------------------------------------------* 
49 760us-776us            39 162       0.594% --------------------------------------------------* 
50 776us-791us            38 197       0.579% -------------------------------------------------*  
51 791us-807us            37 811       0.573% -------------------------------------------------*  
52 807us-822us            37 364       0.567% ------------------------------------------------*   
53 822us-838us            36 770       0.558% -----------------------------------------------*    
54 838us-853us            35 831       0.543% ----------------------------------------------*     
55 853us-869us            35 380       0.536% ----------------------------------------------*     
56 869us-884us            34 472       0.523% --------------------------------------------*       
57 884us-900us            33 672       0.511% -------------------------------------------*        
58 900us-915us            33 799       0.513% --------------------------------------------*       
59 915us-931us            32 754       0.497% ------------------------------------------*         
60 931us-946us            32 339        0.49% ------------------------------------------*         
61 946us-962us            32 419       0.492% ------------------------------------------*         
62 962us-977us            32 107       0.487% -----------------------------------------*          
63 977us-993us            31 552       0.478% -----------------------------------------*          
64 0-993us             1 221 523       18.54%</pre>
</div></div><p><strong>Properties</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 101.631%;"><colgroup><col style="width: 5.79962%;"/><col style="width: 94.2004%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>count</strong> (<em>integer</em>)</td><td class="confluenceTd">Number of packets in the current latency range</td></tr><tr><td class="confluenceTd"><strong>graph</strong> (<em>string</em>)</td><td class="confluenceTd">graphical representation of share</td></tr><tr><td class="confluenceTd"><strong>latency</strong> (<em>string</em>)</td><td class="confluenceTd">latency range</td></tr><tr><td class="confluenceTd"><strong>share</strong> (<em>percent</em>)</td><td class="confluenceTd">Percentage of packets falling in this latency range.</td></tr></tbody></table></div><h2 id="TrafficGenerator-StreamStats"><span class="mw-headline">Stream Stats</span></h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator stats stream</pre>
</div></div><p>This sub-menu stores statistics sorted by streams. Output is the same as in <strong>quick</strong> mode.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@test-host] /tool traffic-generator stats stream&gt; print 
 # SEQ    NUM     TX-PACKET   TX-RATE     RX-PACKET   RX-RATE   LOST-PACKET LOST-RATE
 0 1      3          43 064 499.5Mbps        25 180 292.0Mbps        17 884 207.4Mbps
 1 1      4          43 062 499.5Mbps        39 946 463.3Mbps         3 116  36.1Mbps
 2 1      TOT        86 126 999.0Mbps        65 126 755.4Mbps        21 000 243.6Mbps
 3 2      3          43 544 505.1Mbps        30 449 353.2Mbps        13 095 151.9Mbps
 4 2      4          43 543 505.0Mbps        42 982 498.5Mbps           561   6.5Mbps
 5 2      TOT        87 087 1010.2...        73 431 851.7Mbps        13 656 158.4Mbps

... 

59 20     TOT        87 277 1012.4...        73 755 855.5Mbps        13 522 156.8Mbps
60 21     3          43 546 505.1Mbps        30 605 355.0Mbps        12 941 150.1Mbps
61 21     4          43 546 505.1Mbps        42 682 495.1Mbps           864  10.0Mbps
62 21     TOT        87 092 1010.2...        73 287 850.1Mbps        13 805 160.1Mbps
63 TOT    3         913 942 504.8Mbps       629 210 347.5Mbps       284 732 157.2Mbps
64 TOT    4         913 939 504.8Mbps       898 374 496.2Mbps        15 565   8.5Mbps
65 TOT    TOT     1 827 881 1009.6...     1 527 584 843.8Mbps       300 297 165.8Mbps</pre>
</div></div><h2 id="TrafficGenerator-PortStats"><span class="mw-headline">Port Stats</span></h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator stats port</pre>
</div></div><p>This sub-menu stores statistics sorted by rx/tx ports.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@test-host] /tool traffic-generator stats port&gt; print 
 # SEQ    PORT        RX-UNK-PACKET    RX-UNK-BYTE RX-UNK...     TX-PACKET   TX-RATE     RX-PACKET
 0 1      port0:et...             0              0      0bps        43 064 499.5Mbps        39 946
 1 1      port1:et...             0              0      0bps        43 062 499.5Mbps        25 180
 2 1      TOT                     0              0      0bps        86 126 999.0Mbps        65 126
 3 2      port0:et...             0              0      0bps        43 544 505.1Mbps        42 982
 4 2      port1:et...             0              0      0bps        43 543 505.0Mbps        30 449
 5 2      TOT                     0              0      0bps        87 087 1010.2...        73 431
 6 3      port0:et...             0              0      0bps        43 540 505.0Mbps        42 615
 7 3      port1:et...             0              0      0bps        43 540 505.0Mbps        30 191
 8 3      TOT                     0              0      0bps        87 080 1010.1...        72 806</pre>
</div></div><h2 id="TrafficGenerator-RawStats"><span class="mw-headline">Raw Stats</span></h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator stats raw</pre>
</div></div><p>This sub-menu stores raw statistics data.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@test-host] /tool traffic-generator stats raw&gt; print 
 # SEQ    PORT       NUM     TX-PACKET   TX-RATE     RX-PACKET   RX-RATE   LOST-PACKET LOST-RATE
 0 1      port0:e... 3          43 064 499.5Mbps             0      0bps        43 064 499.5Mbps
 1 1      port1:e... 3               0      0bps        25 180 292.0Mbps       -25 180 292.0Mbps
 2 1      TOT        3          43 064 499.5Mbps        25 180 292.0Mbps        17 884 207.4Mbps
 3 1      port0:e... 4               0      0bps        39 946 463.3Mbps       -39 946 463.3Mbps
 4 1      port1:e... 4          43 062 499.5Mbps             0      0bps        43 062 499.5Mbps
 5 1      TOT        4          43 062 499.5Mbps        39 946 463.3Mbps         3 116  36.1Mbps
 6 1      port0:e... TOT        43 064 499.5Mbps        39 946 463.3Mbps         3 118  36.1Mbps
 7 1      port1:e... TOT        43 062 499.5Mbps        25 180 292.0Mbps        17 882 207.4Mbps
 8 2      port0:e... 3          43 544 505.1Mbps             0      0bps        43 544 505.1Mbps
 9 2      port1:e... 3               0      0bps        30 449 353.2Mbps       -30 449 353.2Mbps
10 2      TOT        3          43 544 505.1Mbps        30 449 353.2Mbps        13 095 151.9Mbps</pre>
</div></div><h1 id="TrafficGenerator-Streams"><span class="mw-headline">Streams</span></h1><p><strong>Properties</strong></p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.3354%;"><colgroup><col style="width: 16.2838%;"/><col style="width: 83.7162%;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>disabled</strong> (<em>yes | no</em>; Default: <strong>no</strong>)</td><td class="confluenceTd">Whether the stream is disabled</td></tr><tr><td class="confluenceTd"><strong>mbps</strong> (<em>integer [0..4294967295]</em>; Default: <strong>0</strong>)</td><td class="confluenceTd">Value in Megabits per second that stream will try to generate.</td></tr><tr><td class="confluenceTd"><strong>name</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Descriptive name of the stream.</td></tr><tr><td class="confluenceTd"><strong>num</strong> (<em>integer [0..15]</em>; Default: <strong>0</strong>)</td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong>packet-size</strong> (<em>integer[1..65535] [-integer[1..65535]]</em>; Default: <strong>0</strong>)</td><td class="confluenceTd">Generated the size of the packets in bytes. Can be set as the range for random packet size generation.</td></tr><tr><td class="confluenceTd"><strong>port</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Name of the port from the Port menu that will be used to transmit packets.</td></tr><tr><td class="confluenceTd"><strong>pps</strong> (<em>integer [0..4294967295]</em>; Default: <strong>0</strong>)</td><td class="confluenceTd">Packets per second that stream will try to generate.</td></tr><tr><td class="confluenceTd"><strong>tx-template</strong> (<em>string</em>; Default: )</td><td class="confluenceTd">Name of the packet template from packet-template or raw-packet-template menus used as the packet content source.</td></tr></tbody></table></div><h1 id="TrafficGenerator-ConfigurationExamples"><span class="mw-headline">Configuration Examples</span></h1><h2 id="TrafficGenerator-IPsectunnelperformancetest"><span class="mw-headline">IPsec tunnel performance test</span></h2><p>Consider following test setup</p><p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" draggable="false" src="attachments/128221376/131366955.jpg" data-image-src="attachments/128221376/131366955.jpg" data-unresolved-comment-count="0" data-linked-resource-id="131366955" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Traffic-gen-routing-ipsec.jpg" data-base-url="https://help.mikrotik.com/docs" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="128221376" data-linked-resource-container-version="6" tabindex="0" alt=""></span></p><p>System Under Test (SUT) consists of two routers connected to a traffic generator server. The connection between both SUT routers is IPSec encrypted.</p><p>The traffic generator will run two streams:</p><ul><li>in a direction from 1.1.1.0/24 network to 2.2.2.0/24 network</li><li>in a direction from 2.2.2.0/24 network to 1.1.1.0/24 network.</li></ul><p><br/><strong>R1 routing and IPsec setup</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/ip address
add address=192.168.33.1/30 interface=ether1
add address=1.1.1.2/24 interface=ether2

/ip route 
add dst-address=2.2.2.0/24 gateway=192.168.33.2

/ip ipsec proposal
set default enc-algorithms=aes-128

/ip ipsec peer
add address=192.168.33.2 secret=123

/ip ipsec policy
add sa-src-address=192.168.33.1 sa-dst-address=192.168.33.2 \
    src-address=1.1.1.0/24 dst-address=2.2.2.0/24 tunnel=yes</pre>
</div></div><p><strong>R2 routing and IPsec setup</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/ip address
add address=192.168.33.2/30 interface=ether1
add address=2.2.2.2/24 interface=ether2

/ip route 
add dst-address=1.1.1.0/24 gateway=192.168.33.1

/ip ipsec proposal
set default enc-algorithms=aes-128

/ip ipsec peer
add address=192.168.33.1 secret=123

/ip ipsec policy
add sa-src-address=192.168.33.2 sa-dst-address=192.168.33.1 \
    src-address=2.2.2.0/24 dst-address=1.1.1.0/24 tunnel=yes</pre>
</div></div><p><strong>Traffic generator server setup</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/ip address
add address=1.1.1.1/24 interface=ether2
add address=2.2.2.1/24 interface=ether3</pre>
</div></div><p>First, we will define which ports will be used as traffic generator tx/rx ports</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator port
add disabled=no interface=ether2 name=port0
add disabled=no interface=ether3 name=port1</pre>
</div></div><p>To construct the actual packet that will be generated, packet-template is used.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator packet-template
add header-stack=mac,ip,udp ip-dst=2.2.2.1/32 ip-gateway=1.1.1.2 ip-src=1.1.1.1/32 \
    name=routing-1 port=port0
add header-stack=mac,ip,udp ip-dst=1.1.1.1/25 ip-gateway=2.2.2.2 ip-src=2.2.2.1/32 \
    name=routing-2 port=port1</pre>
</div></div><p>Notice that mac addresses were not specified since the template generator can assume the next-hop mac address automatically by sending ARP messages. Since we are doing routing and destination IP is not directly reachable, we have set <strong>the ip-gateway</strong> parameter to determine the next-hop mac-address.</p><p>When running <strong>print</strong> you can see all assumed (detected) values including mac addresses.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@test-host] /tool traffic-generator packet-template&gt; print 
 0 name=&quot;routing-1&quot; header-stack=mac,ip,udp port=port0 
   assumed-mac-dst=00:0C:42:00:38:9D assumed-mac-src=00:0C:42:40:94:25 
   assumed-mac-protocol=ip assumed-ip-dscp=0 assumed-ip-id=0 
   assumed-ip-frag-off=0 assumed-ip-ttl=64 assumed-ip-protocol=udp 
   ip-src=1.1.1.1/32 ip-dst=2.2.2.1/32 assumed-udp-src-port=100 
   assumed-udp-dst-port=200 ip-gateway=1.1.1.2 data=uninitialized data-byte=0 

 1 name=&quot;routing-2&quot; header-stack=mac,ip,udp port=port1 
   assumed-mac-dst=00:0C:42:00:38:D1 assumed-mac-src=00:0C:42:40:94:26 
   assumed-mac-protocol=ip assumed-ip-dscp=0 assumed-ip-id=0 
   assumed-ip-frag-off=0 assumed-ip-ttl=64 assumed-ip-protocol=udp 
   ip-src=2.2.2.1/32 ip-dst=1.1.1.1/32 assumed-udp-src-port=100 
   assumed-udp-dst-port=200 ip-gateway=2.2.2.2 data=uninitialized data-byte=0</pre>
</div></div><p>For example, if any router in SUT were to change, assumed mac-addresses would not be updated automatically. To update packet templates simply issue command:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator packet-template set [find]</pre>
</div></div><p>The last part is to configure streams</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/tool traffic-generator stream
add disabled=no mbps=500 name=str1 id=3 packet-size=1450 port=port0 pps=0 \
    tx-template=routing-1
add disabled=no mbps=500 name=str3 id=4 packet-size=1450 port=port1 pps=0 \
    tx-template=routing-2</pre>
</div></div><p>Notice that each stream has a unique <strong>id</strong> value. This value identifies stream packets, otherwise, the traffic generator will not work.</p><p><br/>Now we are ready to run the test. In this case, <strong>quick</strong> mode will be used:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@test-host] /tool traffic-generator&gt; quick mbps=450
SEQ    NUM     TX-PACKET   TX-RATE     RX-PACKET   RX-RATE        RX-OOO   LOST-PACKET LOST-RATE 
37     4          39 488 458.0Mbps        39 270 455.5Mbps        15 509           218   2.5Mbps 
37     TOT        78 976 916.1Mbps        76 485 887.2Mbps        22 529         2 491  28.8Mbps 
38     3          38 957 451.9Mbps        37 657 436.8Mbps         7 078         1 300  15.0Mbps 
38     4          38 958 451.9Mbps        38 402 445.4Mbps        14 763           556   6.4Mbps 
38     TOT        77 915 903.8Mbps        76 059 882.2Mbps        21 841         1 856  21.5Mbps 
39     3          38 816 450.2Mbps        37 893 439.5Mbps         7 307           923  10.7Mbps 
39     4          38 815 450.2Mbps        38 642 448.2Mbps        15 110           173   2.0Mbps 
39     TOT        77 631 900.5Mbps        76 535 887.8Mbps        22 417         1 096  12.7Mbps 
40     3          39 779 461.4Mbps        37 415 434.0Mbps         7 136         2 364  27.4Mbps 
40     4          39 780 461.4Mbps        39 567 458.9Mbps        15 908           213   2.4Mbps 
40     TOT        79 559 922.8Mbps        76 982 892.9Mbps        23 044         2 577  29.8Mbps 
41     3          39 218 454.9Mbps        37 089 430.2Mbps         7 075         2 129  24.6Mbps 
41     4          39 218 454.9Mbps        38 663 448.4Mbps        15 752           555   6.4Mbps 
41     TOT        78 436 909.8Mbps        75 752 878.7Mbps        22 827         2 684  31.1Mbps 
42     3          39 188 454.5Mbps        37 906 439.7Mbps         6 729         1 282  14.8Mbps 
42     4          39 187 454.5Mbps        38 954 451.8Mbps        15 565           233   2.7Mbps 
42     TOT        78 375 909.1Mbps        76 860 891.5Mbps        22 294         1 515  17.5Mbps 
TOT    3       1 645 468 454.4Mbps     1 568 201 433.1Mbps       280 174        77 267  21.3Mbps 
TOT    4       1 645 464 454.4Mbps     1 626 896 449.3Mbps       627 480        18 568   5.1Mbps 
TOT    TOT     3 290 932 908.9Mbps     3 195 097 882.4Mbps       907 654        95 835  26.4Mbps</pre>
</div></div><p>Stats show throughput of each stream and total throughput of both streams, Out-of-order packet count, Lost rate, latency, and jitter.</p>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/128221376/128221377.png">Traffic-gen-routing-ipsec.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/128221376/131366955.jpg">Traffic-gen-routing-ipsec.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:54</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
