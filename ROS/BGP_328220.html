<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : BGP</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="Routing_328222.html">Routing</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : BGP
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Māris B.</span>, last updated on May 19, 2025
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><span class="mw-headline"><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742032024 {padding: 0px;}
div.rbtoc1747742032024 ul {margin-left: 0px;}
div.rbtoc1747742032024 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742032024'>
<ul class='toc-indentation'>
<li><a href='#BGP-Summary'>Summary</a></li>
<li><a href='#BGP-BGPTerminology'>BGP Terminology</a></li>
<li><a href='#BGP-BGPBasics'>BGP Basics</a>
<ul class='toc-indentation'>
<li><a href='#BGP-InstanceMenu'>Instance Menu</a></li>
<li><a href='#BGP-ConnectionMenu'>Connection Menu</a></li>
<li><a href='#BGP-SessionMenu'>Session Menu</a></li>
<li><a href='#BGP-TemplateMenu'>Template Menu</a></li>
</ul>
</li>
<li><a href='#BGP-Best-PathSelection'>Best-Path Selection</a></li>
<li><a href='#BGP-RoutingFilterNotes'>Routing Filter Notes</a></li>
<li><a href='#BGP-RunningMorethanOneInstance'>Running More than One Instance</a></li>
<li><a href='#BGP-BGPBasedVPLS'>BGP Based VPLS</a></li>
<li><a href='#BGP-L3VPN(VPNv4,VPNv6)'>L3VPN (VPNv4, VPNv6)</a>
<ul class='toc-indentation'>
<li><a href='#BGP-RouteDistinguisher'>Route Distinguisher</a></li>
<li><a href='#BGP-Properties'>Properties</a></li>
</ul>
</li>
<li><a href='#BGP-EVPN'>EVPN</a></li>
</ul>
</div></span></p><h1 id="BGP-Summary"><span class="mw-headline">Summary</span></h1><p>The Border Gateway Protocol (BGP) allows setting up an inter-domain dynamic routing system that automatically updates routing tables of devices running BGP in case of network topology changes.</p><p>BGP is an inter-autonomous system routing protocol based on the distance-vector algorithm. It is used to exchange routing information across the Internet and is the only protocol that is designed to deal with a network of the Internet's size and the only protocol that can deal well with having multiple connections to unrelated routing domains.</p><p>BGP is designed to allow for sophisticated administrative routing policies to be implemented. It does not exchange information about network topology but rather reachability information. As such, BGP is better suited to inter-AS environments and special cases like informational feeds. If you just need to enable dynamic routing in your network, consider OSPF instead.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The feature is not supported on SMIPS devices (hAP lite, hAP lite TC, and hAP mini).</p></div></div><p><br/>Standards and Technologies:</p><ul class="bullets"><li><a class="external-link" href="https://tools.ietf.org/html/rfc4271" rel="nofollow">RFC 4271</a> Border Gateway Protocol 4</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc4456" rel="nofollow">RFC 4456</a> BGP Route Reflection</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc5065" rel="nofollow">RFC 5065</a> Autonomous System Confederations for BGP</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc1997" rel="nofollow">RFC 1997</a> BGP Communities Attribute</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc8092" rel="nofollow">RFC 8092</a> BGP Large Communities</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc4360" rel="nofollow">RFC 4360</a>, <a class="external-link" href="https://tools.ietf.org/html/rfc5668" rel="nofollow">5668</a> BGP Extended Communities</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc2385" rel="nofollow">RFC 2385</a> TCP MD5 Authentication for BGPv4</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc5492" rel="nofollow">RFC 5492</a> Capabilities Advertisement with BGP-4</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc2918" rel="nofollow">RFC 2918</a> Route Refresh Capability</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc4760" rel="nofollow">RFC 4760</a> Multiprotocol Extensions for BGP-4</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc2545" rel="nofollow">RFC 2545</a> Use of BGP-4 Multiprotocol Extensions for IPv6 Inter-Domain Routing</li><li><a class="external-link" href="https://tools.ietf.org/html/rfc4893" rel="nofollow">RFC 4893</a> BGP Support for Four-octet AS Number Space</li><li><p><a class="external-link" href="https://tools.ietf.org/html/rfc4364" rel="nofollow">RFC 4364</a> BGP/MPLS IP Virtual Private Networks (VPNs)</p></li><li><a class="external-link" href="https://tools.ietf.org/html/rfc4761" rel="nofollow">RFC 4761 </a>Virtual Private LAN Service (VPLS) Using BGP for Auto-Discovery and Signalling</li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);"><a class="external-link" href="https://tools.ietf.org/html/rfc6286" rel="nofollow">RFC 6286</a> - AS-wide Unique BGP Identifier for BGP-4</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);"><a class="external-link" href="https://tools.ietf.org/html/rfc4273" rel="nofollow">RFC 4273</a> - SNMP peer table monitoring (OID<span style="color:var(--ds-text,#333333);"> <span style="text-decoration: none;">1.3.6.1.2.1.15.3.1</span></span>) (IPv4 only)</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);"><a class="external-link" href="https://www.rfc-editor.org/rfc/rfc6793" rel="nofollow">RFC 6793</a> -  4-byte ASN support and Aggregator attribute.</span></li></ul><p><br/></p><h1 id="BGP-BGPTerminology">BGP Terminology</h1><ul><li>AS - <span style="text-decoration: none;color:var(--ds-text,#172b4d);">Autonomous System</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);">ASN - Autonomous System Number</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);">NLRI - Network Layer Reachability Information is what is being exchanged between BGP peers and represents how to reach the prefixes.</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);">IGP - Interior Gateway Protocol</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);">EGP - Exterior Gateway protocol</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);">RR - Route reflector is the router in the BGP network that reflects advertisements to all the neighbors, avoiding the requirement for full BGP mesh. </span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Route server - is the BGP router that does not participate in traffic forwarding. Routes are typically not even installed in the FIB.</span></li><li><span style="text-decoration: none;color:var(--ds-text,#172b4d);">loopback address - a /32 address configured on a dummy bridge interface, that can act as a loopback.</span></li></ul><h1 id="BGP-BGPBasics"><span class="mw-headline">BGP Basics</span></h1><p>BGP routers exchange reachability information by means of a transport protocol, which in the case of BGP is TCP (port 179). Upon forming a TCP connection these routers exchange <strong>OPEN</strong> messages to negotiate and confirm supported capabilities.</p><p>After agreeing on capabilities to use, the session is considered to be established and peers can start to exchange NLRIs via <strong>UPDATE</strong> messages. This information contains an indication of what sequence of full paths (BGP AS numbers) the route should take in order to reach the destination network (NLRI prefix).</p><p>The peers initially exchange their full routing tables and after the initial exchange, incremental updates are sent as the routing tables change. Thus, BGP does not require a periodic refresh of the entire BGP routing table.</p><p>BGP maintains the routing table version number which must be the same between any two given peers for the duration of the connection.</p><p><strong>KEEPALIVE</strong> messages are sent periodically to ensure that the connection is up and running, if <strong>KEEPALIVE</strong> messages are not received within the <strong>Hold Time</strong> interval, the connection will be closed.</p><p>To respond to errors or special conditions, <strong>NOTIFICATION</strong> messages can be generated and sent to the remote peer, notification message type also indicates whether the connection should be immediately closed.</p><p>There can be two types of BGP connections:</p><ul><li><strong>iBGP</strong> - is an &quot;internal&quot; link connecting peers from the same AS</li><li><strong>eBGP</strong> - is an &quot;external&quot; link connecting peers belonging to two different AS-es</li></ul><p>A particular AS might have multiple BGP speakers and provide transit service to other AS-es. This implies that BGP speakers must maintain a consistent view of routing within the AS.  A consistent view of the routes exterior to the AS is provided by having all BGP routers within the AS establish direct iBGP connections with each other (full mesh) or by utilizing a Router Reflector setup.</p><p>Using a set of administrative policies BGP speakers within the AS come to an agreement as to which entry/exit point to use for a particular destination. This information is communicated to the interior routers of the AS using the interior routing protocol (IGP), for example, OSPF, RIP, or static routing. In certain setups, iBGP can take the IGP protocol role as well.</p><p>For certain BGP attributes handling behavior may change depending on what type of connection is set up, for example, the LOCAL-PREF attribute is not advertised to eBGP peers.</p><p>RouterOS divides configuration and session monitoring into four menus:</p><ul><li data-uuid="eb318c26-4419-46ea-8da2-c606ab0d95eb">instance menu (<span style="color:var(--ds-text-accent-blue,#0055cc);"><code>/routing/bgp/instance</code></span>)</li></ul><ul><li>connection menu (<span style="color:var(--ds-text-accent-blue,#0055cc);"><code>/routing/bgp/connection</code></span>)</li><li>sessions menu(<span style="color:var(--ds-text-accent-blue,#0055cc);"><code>/routing/bgp/session</code></span>)</li><li>template menu (<span style="color:var(--ds-text-accent-blue,#0055cc);"><code>/routing/bgp/template</code></span>)</li></ul><h2 style="text-align: left;" id="BGP-InstanceMenu">Instance Menu</h2><p>Starting from ROSv7.20, instead of auto detecting instance based on router-ids, BGP routing instances are now explicitly defined in instance menu.</p><p>BGP routing instance is necessary for best path route selection and other instance dependant features like VPN, EVPN and so on.</p><div class="table-wrap"><table style="margin-left: 14.4318px;" class="confluenceTable"><colgroup class=""><col class=""/><col class=""/><col class=""/></colgroup><tbody class=""><tr class=""><th class="highlight-#deebff confluenceTh" colspan="2" data-highlight-colour="#deebff">Property</th><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff">Description</th></tr><tr class=""><td colspan="2" class="confluenceTd"><strong title="">as</strong><span title=""> </span>(<em title="">integer [0..4294967295]</em>; Default: )</td><td class="confluenceTd">32-bit BGP autonomous system number. Value can be entered in AS-Plain and AS-Dot formats. The parameter is also used to set up the BGP confederation, in the following format: <span style="color:var(--ds-text-accent-blue,#0055cc);"><em><code>confederation_as/as</code></em></span>. For example, if your AS is 34 and your confederation AS is 43, then as configuration should be <code><span style="color:var(--ds-text-accent-green-bolder,#164b35);">as</span>=43/34</code>.</td></tr><tr class=""><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7"><strong title="">cluster-id</strong><span title=""> </span>(<em title="">IP address</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">In case this instance is a route reflector: the cluster ID of the router reflector cluster to this instance belongs. This attribute helps to recognize routing updates that come from another route reflector in this cluster and avoid routing information looping. Note that normally there is only one route reflector in a cluster; in this case, 'cluster-id' does not need to be configured and BGP router ID is used instead</td></tr><tr class=""><td colspan="2" class="confluenceTd"><strong title="">ignore-as-path-len<span title=""> </span></strong>(<em title="">yes | no</em>; Default:<span title=""> </span>no)</td><td class="confluenceTd">Whether to ignore<span title=""> the </span><strong title="">AS_PATH</strong><span title=""> </span>attribute in the BGP route selection algorithm. Works on input.</td></tr><tr class=""><td colspan="2" class="confluenceTd"><strong title="">router-id<span title=""> </span></strong>(<em title="">IP | name</em>; Default: main )</td><td class="confluenceTd"><p title="">BGP Router ID to be used. Use the ID from the <span style="color:var(--ds-icon-accent-blue,#1d7afc);">/routing/router-id</span> configuration by specifying the reference name, or set the ID directly by specifying IP.</p><p title="">Equal r<span style="text-decoration: none;color:var(--ds-text,#172b4d);">outer-ids are also used to group peers into one instance.</span></p></td></tr><tr class=""><td colspan="2" class="confluenceTd"><strong title="">routing-table</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">Name of the routing table, to install routes in. </td></tr><tr class=""><td class="highlight-grey confluenceTd" colspan="2" data-highlight-colour="grey"><strong title="">vrf</strong><span title=""> </span>(<em title="">name</em>; Default: main )</td><td class="highlight-grey confluenceTd" data-highlight-colour="grey">Name of the VRF BGP connections operates on. By default always use the &quot;main&quot; routing table.</td></tr></tbody></table></div><h2 id="BGP-ConnectionMenu"><span class="mw-headline">Connection Menu</span></h2><p><span class="mw-headline">Let's look at a very basic eBGP configuration example assuming, that Router1 IP is 192.168.1.1, AS 65531 and Router2 IP 192.168.1.2, AS 65532:</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">#Router1
/routing/bgp/instnace
add name=i1 as=65531

/routing/bgp/connection
add name=toR2 remote.address=192.168.1.2 instance=i1 local.role=ebgp</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">#Router2
/routing/bgp/instnace
add name=i1 as=65532

/routing/bgp/connection
add name=toR1 remote.address=192.168.1.1 instance=i1 local.role=ebgp</pre>
</div></div><p style="text-align: left;">The BGP connection menu defines BGP outgoing connections as well as acts as a template matcher for incoming BGP connections.</p><p style="text-align: left;"> <span style="color:var(--ds-text-accent-green-bolder,#164b35);"><code>local.role </code></span>parameter is used to indicate that this connection will be the eBGP. Also, notice that the connection does not require a remote AS number to be specified, RouterOS can determine a remote AS number dynamically from the first received <strong>OPEN</strong> message.</p><p style="text-align: left;">The parameter equivalent to other vendors and older RouterOS &quot;update-source&quot; is &quot;<span style="color:var(--ds-text-accent-green-bolder,#164b35);"><code>local.address</code></span>&quot;. In most cases, it can be left unconfigured, and let the router determine the address.</p><p><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">When a local address is not specified, BGP will try to guess the local address depending on the current setup:</span></span></p><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if the peer is iBGP</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if loopback available </span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">pick the highest loopback address</span></span></li></ul></li><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if loopback is not available</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">pick any highest IP address on the router</span></span></li></ul></li></ul></li><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if the peer is eBGP</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if a remote peer's IP is <span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">not from a directly connected network:</span></span></span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">and multihop is not set, then throw an error</span></span></li><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">and multihop is enabled:</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if loopback available</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">pick the highest loopback address</span></span></li></ul></li><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if loopback is not available</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">pick any highest IP address on the router</span></span></li></ul></li></ul></li></ul></li><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if a remote peer's IP is<span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);"> from a directly connected network:</span></span></span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);"><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">and multihop is not set</span></span>:</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">pick the local routers IP address from that connected network</span></span></li></ul></li><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">and multihop is set:</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if loopback available</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">pick the highest loopback address</span></span></li></ul></li><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">if loopback is not available</span></span><ul><li><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">pick any highest IP address on the router</span></span></li></ul></li></ul></li></ul></li></ul></li></ul><p><br/></p><p style="text-align: left;"><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">In addition to connection-specific parameters, template-specific parameters are also directly exposed in this menu, for easier configuration in simple scenarios (when templates are not necessary).</span></span></p><p style="text-align: left;"><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);">A list of all connection-specific parameters can be seen in the table below:</span></span></p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 99.92372%;"><colgroup><col style="width: 2.2154317%;"/><col style="width: 15.584415%;"/><col style="width: 82.20015%;"/></colgroup><tbody><tr><th class="highlight-#deebff confluenceTh" colspan="2" data-highlight-colour="#deebff">Property</th><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff">Description</th></tr><tr><td colspan="2" class="confluenceTd"><strong title="">name</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">Name of the BGP connection</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7"><strong title="">connect</strong><span title=""> </span>(<em title="">yes | no</em>; Default:<span title=""> yes</span>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Whether to allow the router to initiate the connection.</td></tr><tr><td colspan="2" class="confluenceTd"><strong>listen</strong><span> </span>(<em>yes | no</em>; Default: yes)</td><td class="confluenceTd">Whether to listen for incoming connections.</td></tr><tr><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff"><strong>local</strong> - a group of parameters associated with the local side of the connection</td></tr><tr><td class="confluenceTd"><br/></td><td class="confluenceTd"><strong title="">.address</strong><span title=""> </span>(<em title="">IPv4/6</em>; Default: ::)</td><td class="confluenceTd">Local connection address.</td></tr><tr><td class="confluenceTd"><br/></td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.port</strong>(<em title="">integer [0..65535]</em>; Default:179 )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Local connection port.</td></tr><tr><td class="confluenceTd"><br/></td><td class="confluenceTd"><strong title="">.role</strong>(ebgp | ebgp-customer | ebgp-peer | ebgp-provider | ebgp-rs | ebgp-rs-client | ibgp | ibgp-rr; Default: )</td><td class="confluenceTd">BGP role, in most common scenarios it should be set to iBGP or eBGP. More information on BGP roles can be found<span style="text-decoration: none;color:var(--ds-text,#172b4d);"> in the corresponding RFC draft </span><a class="external-link" href="https://datatracker.ietf.org/doc/draft-ietf-idr-bgp-open-policy/?include_text=1" rel="nofollow" style="text-decoration: none;">https://datatracker.ietf.org/doc/draft-ietf-idr-bgp-open-policy/?include_text=1</a><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td></tr><tr><td class="confluenceTd"><br/></td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.ttl</strong><span title=""> </span>(<em title="">integer [1..255]</em>; Default:)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Time To Live (hop limit) that will be recorded in sent TCP packets.</td></tr><tr><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff"><strong>remote</strong> - a group of parameters associated with the remote side of the connection</td></tr><tr><td rowspan="5" class="confluenceTd"><br/><br/><br/></td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.address</strong><span title=""> </span>(<em title="">IPv4/6</em>; Default: ::)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Remote address used to connect and/or listen to.</td></tr><tr><td class="confluenceTd"><strong title="">.port</strong>(<em title="">integer [0..65535]</em>; Default:179 )</td><td class="confluenceTd">Local connection port.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.as</strong>(<em title="">integer []</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Remote AS number. If not specified BGP will determine remote AS automatically from the OPEN message.</td></tr><tr><td class="confluenceTd"><strong title="">.allowed-as</strong>()</td><td class="confluenceTd">List of remote AS numbers that are allowed to connect. Useful for dynamic peer configuration.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.ttl</strong><span title=""> </span>(<em title="">integer [1..255]</em>; Default:)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Acceptable minimum Time To Live, the hop limit for this TCP connection. For example, if 'ttl=255' then only single-hop<span title=""> </span>neighbors<span title=""> will be able to establish the connection. This property only affects EBGP peers.</span></td></tr><tr><td colspan="2" class="confluenceTd"><strong>tcp-md5-key</strong><span> </span>(<em>string</em>; Default: )</td><td class="confluenceTd">The key used to authenticate the connection with TCP MD5 signature as described in RFC 2385. If not specified, authentication is not used.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7"><strong title="">templates</strong><span title=""> </span>(<em title="">name[,name]</em>; Default: default)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">List of the template names, to inherit parameters from. Useful for dynamic BGP peers.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">instance<span title=""> </span></strong>(<em title="">name[,name]</em>; Default: default)</td><td class="confluenceTd">Name of the instance this connection is assigned to.</td></tr></tbody></table></div><h2 style="text-align: left;" id="BGP-SessionMenu">Session Menu</h2><p style="text-align: left;">To see the actual active sessions with selected template parameters and negotiated capabilities refer to the BGP sessions menu:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@MikroTik] /routing/bgp/session&gt; print 
Flags: E - established 
 0 E name=&quot;toR2&quot; 
     remote.address=192.168.1.2 .as=65532 .id=192.168.1.1 .refused-cap-opt=no 
     .capabilities=mp,rr,as4 .afi=ip,ipv6 .messages=43346 .bytes=3635916 .eor=&quot;&quot; 
     local.address=192.168.1.1 .as=65531 .id=192.168.44.2 .capabilities=mp,rr,gr,as4 .messages=2 
     .bytes=71 .eor=&quot;&quot; 
     output.procid=97 .keep-sent-attributes=no 
     .last-notification=ffffffffffffffffffffffffffffffff0015030601 
     input.procid=97 .limit-process-routes=500000 ebgp limit-exceeded 
     hold-time=3m keepalive-time=1m uptime=4s70ms</pre>
</div></div><p>This menu shows read-only cached BGP session information. It will show the current status of the session, flags, last received notification, and negotiated session parameters.</p><p>Even if the BGP session is not active anymore, the cache can still be stored for some time. Routes received from a particular session are removed only if the cache expires, this allows mitigating extensive routing table recalculations if the BGP session is flapping.</p><p style="text-align: left;"><br/></p><p style="text-align: left;">Also, in this menu is located a session-specific set of commands.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff">Command</th><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff">Description</th></tr><tr><td class="confluenceTd"><strong title="">clear</strong></td><td class="confluenceTd"><p>Clear the session flags. For example, to be able to re-establish a session after the prefix limit is reached &quot;limit-exceeded&quot; flag must be cleared. It can be done by specifying &quot;<span style="color:var(--ds-text-accent-green-bolder,#164b35);"><code>flag</code></span>&quot; parameter, which is able to take the following values:</p><ul><li>input-last-notification  </li><li>limit-exceeded  </li><li>output-last-notification  </li><li>refused-cap-opt  </li><li>stopped</li></ul></td></tr><tr><td class="confluenceTd"><strong title="">dump-saved-advertisements</strong></td><td class="confluenceTd">Dump saved advertisements from specified BGP session in the *.pcap file. The filename to store data is set by &quot;<span style="color:var(--ds-text-accent-green-bolder,#164b35);"><code>save-to</code></span>&quot; parameter.</td></tr><tr><td class="confluenceTd"><strong title="">refresh</strong></td><td class="confluenceTd">Send route refresh to a specified BGP session. Is used to trigger re-sending all the routes from the remote peer. &quot;<code><span style="color:var(--ds-text-accent-green-bolder,#164b35);">address-family</span></code>&quot; parameters allow specifying for which address family to send route refresh.</td></tr><tr><td class="confluenceTd"><strong title="">resend</strong></td><td class="confluenceTd"><p>Resend prefixes to a specified BGP session. The command takes two parameters:</p><ul><li>&quot;<code><span style="color:var(--ds-text-accent-green-bolder,#164b35);">address-family</span></code>&quot; - parameters allow specifying for which address family to resend prefixes.</li><li>&quot;<span style="color:var(--ds-text-accent-green-bolder,#164b35);"><code>save-to</code></span>&quot; - the name of the pcap file where to dump resent messages, can be used for debugging purposes.</li></ul></td></tr><tr><td class="confluenceTd"><strong title="">reset</strong></td><td class="confluenceTd">Reset specified BGP session.</td></tr><tr><td class="confluenceTd"><strong title="">stop</strong></td><td class="confluenceTd">Stop specified BGP session.</td></tr></tbody></table></div><p style="text-align: left;"><br/></p><h2 style="text-align: left;" id="BGP-TemplateMenu">Template Menu</h2><p><br/></p><p><span style="text-decoration: none;color:var(--ds-text,#172b4d);">The template contains all BGP protocol-related configuration options. It can be used as a template for dynamic peers and to apply a similar configuration to a group of peers. Note that this is not the same as peer groups on Cisco devices, where the group is more than just a common configuration.</span></p><p><br/></p><p><span style="text-decoration: none;color:var(--ds-text,#172b4d);">List of available template parameters:</span></p><div class="table-wrap"><table class="wrapped confluenceTable" style="margin-left: 14.4318px;"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="highlight-#deebff confluenceTh" colspan="2" data-highlight-colour="#deebff" title="Background colour : Light blue 35%">Property</th><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff" title="Background colour : Light blue 35%">Description</th></tr><tr><td colspan="2" class="confluenceTd"><strong>add-path-out</strong><span> </span>(<em>all<br/>|none</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">afi</strong><span title=""> </span>(<em title="">ip | ipv6 | l2vpn | l2vpn-cisco | vpnv4</em>; Default:<span title=""> </span><strong title="">ip</strong>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">List of address families about which this peer will exchange routing information. The remote peer must support (they usually do) BGP capabilities optional parameter to negotiate any other families than IP.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">as</strong><span title=""> </span>(<em title="">integer [0..4294967295]</em>; Default: )</td><td class="confluenceTd">32-bit BGP autonomous system number. Value can be entered in AS-Plain and AS-Dot formats. The parameter is also used to set up the BGP confederation, in the following format: <span style="color:var(--ds-text-accent-blue,#0055cc);"><em><code>confederation_as/as</code></em></span>. For example, if your AS is 34 and your confederation AS is 43, then as configuration should be <code><span style="color:var(--ds-text-accent-green-bolder,#164b35);">as</span>=43/34</code>. Overrides instance ASN.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">cisco-vpls-nlri-len-fmt</strong><span title=""> </span>(<em title="">auto-bits | auto-bytes | bits | bytes</em>; Default: )</td><td class="confluenceTd">VPLS NLRI length format type. Used for compatibility with Cisco VPLS. [[Read more&gt;&gt;]].</td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">disabled</strong><span title=""> </span>(<em title="">yes | no</em>; Default:<span title=""> </span><strong title="">no</strong>)</td><td class="confluenceTd">Whether the template is disabled.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">hold-time</strong><span title=""> </span>(<em title="">time[3s..1h] | infinity</em>; Default:<span title=""> </span><strong title="">3m</strong>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">Specifies the BGP Hold Time value to use when negotiating with peers.<p title="">According to the BGP specification, if the router does not receive successive<span> </span><strong>KEEPALIVE</strong><span> </span>and/or<span> </span><strong>UPDATE</strong><span> </span>and/or<span> </span><strong>NOTIFICATION</strong><span> </span>messages within the period specified in the Hold Time field of the<span> </span><strong>OPEN</strong><span> </span>message, then the BGP connection to the peer will be closed.</p><p title="">The minimal hold-time value of both peers will be used (note that the special value 0 or 'infinity' is lower than any other value)</p><ul title=""><li><span style="color:var(--ds-icon-success,#22a06b);">infinity</span><span> </span>- never expire the connection and never send keepalive messages.</li></ul></td></tr><tr><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff"><strong title="">input </strong>- a group of parameters associated with BGP input</td></tr><tr><td rowspan="16" class="confluenceTd"><br/></td><td class="confluenceTd"><strong title="">.accept-comunities</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">A quick way to filter incoming updates with specific communities. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.accept-ext-communities</strong>(<em title="">string</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">A quick way to filter incoming updates with specific extended communities. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="confluenceTd"><strong title="">.accept-large-comunities</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">A quick way to filter incoming updates with specific large communities. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.accept-nlri</strong>(<em title="">string</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">Name of the ipv4/6 address-list. A quick way to filter incoming updates with specific NLRIs. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session restart.<br/></span></td></tr><tr><td class="confluenceTd"><strong title="">.filter-unknown</strong>(<em title="">string</em>; Default: )</td><td class="confluenceTd">A quick way to filter incoming updates with specific &quot;unknown&quot; attributes. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.affinity</strong>(afi  | alone | instance | main | remote-as | vrf; Default: alone )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><p>Configure input multi-core processing. Read more in <a href="Routing-Protocol-Multi-core-Support_34897937.html">Routing Protocol Multi-core Support</a> article.</p><ul style="text-decoration: none;"><li class="auto-cursor-target"><strong>alone</strong> - input and output of each session are processed in its own process, most likely the best option when there are a lot of cores and a lot of peers</li><li class="auto-cursor-target"><strong>afi, instance, vrf, remote-as</strong> - try to run input/output of new session in process with similar parameters</li><li class="auto-cursor-target"><strong>main</strong> - run input/output in the main process (could potentially increase performance on single-core even possibly on multi-core devices with a small amount of cores)</li><li class="auto-cursor-target"><strong>input</strong> - run output in the same process as input (can be set only for output affinity)</li></ul></td></tr><tr><td class="confluenceTd"><strong>.allow-as</strong><span> </span>(<em>integer [0..10]</em>; Default: )</td><td class="confluenceTd">Indicates how many times to allow your own AS number in AS-PATH, before discarding a prefix.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.filter </strong>(<em title="">name</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">Name of the routing filter chain to be used on input prefixes. This happens after NLRIs are processed. If the chain is not specified, then BGP by default accepts everything.</td></tr><tr><td class="confluenceTd"><strong title="">.filter-comunities</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">A quick way to filter incoming updates with specific communities. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.filter-ext-communities</strong>(<em title="">string</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">A quick way to filter incoming updates with specific extended communities. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="confluenceTd"><strong title="">.filter-large-comunities</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">A quick way to filter incoming updates with specific large communities. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.filter-nlri</strong>(<em title="">string</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Name of the filter chain that will filter<span style="text-decoration: none;color:var(--ds-text,#172b4d);"> incoming IPv4/IPv6 NLRIs directly before they are  stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session restart.<br/></span></td></tr><tr><td class="confluenceTd"><strong title="">.filter-unknown</strong>(<em title="">string</em>; Default: )</td><td class="confluenceTd">A quick way to filter incoming updates with specific &quot;unknown&quot; attributes. It <span style="text-decoration: none;color:var(--ds-text,#172b4d);">allows filtering incoming messages directly before they are even parsed and stored in memory, that way significantly reducing memory usage. Regular input filter chain can only reject prefixes which means that it will still eat memory and will be visible in </span><span style="text-decoration: none;color:var(--ds-text-accent-blue,#0055cc);">/routing route</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> table as &quot;not active, filtered&quot;. Changes to be applied required session refresh.<br/></span></td></tr><tr><td class="confluenceTd"><span title=""><strong title="">.limit-nlri-diversity </strong>(<em title="">integer</em>; Default: )</span></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><span title=""><strong title="">.limit-process-routes-ipv4 </strong>(<em title="">integer</em>; Default: )</span></td><td class="confluenceTd">Try to limit the amount of received IPv4 routes to the specified number. This number does not represent the exact number of routes going to be installed in the routing table by the peer. <a href="https://help.mikrotik.com/docs/display/ROS/BGP#BGP-Commands" rel="nofollow">BGP session &quot;clear&quot;</a> command must be used to reset the flag if the limit is reached.</td></tr><tr><td class="confluenceTd"><span title=""><strong title="">.limit-process-routes-ipv6 </strong>(<em title="">integer</em>; Default: )</span></td><td class="confluenceTd">Try to limit the amount of received IPv6 routes to the specified number. This number does not represent the exact number of routes going to be installed in the routing table by the peer. BGP session &quot;clear&quot; command must be used to reset the flag if the limit is reached.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">keepalive-time</strong><span title=""> </span>(<em title="">time [1s..30m]</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">The interval between keepalive messages, if not set by default keepalive is 1/3 of the <span style="color:var(--ds-icon-success,#22a06b);"><code>hold-time</code></span>. </td></tr><tr><td colspan="2" class="confluenceTd"><strong>multihop</strong><span> </span>(<em>yes | no</em>; Default:<span> </span><strong>no</strong>)</td><td class="confluenceTd">Specifies whether the remote peer is more than one hop away.<p>This option affects outgoing next-hop selection as described in RFC 4271 (for EBGP only, excluding EBGP peers local to the confederation).</p><p>It also affects:</p><ul><li>whether to accept connections from peers that are not in the same network (the remote address of the connection is used for this check);</li><li>whether to accept incoming routes with NEXT_HOP attribute that is not in the same network as the address used to establish the connection;</li><li>the target-scope of the routes installed from this peer; routes from multi-hop or IBGP peers resolve their next-hops through IGP routes by default.</li></ul></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">name</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">Name of the BGP template</td></tr><tr><td colspan="2" class="confluenceTd"><strong>nexthop-choice</strong><span> </span>(<em>default | force-self | propagate</em>; Default:<span> </span><strong>default</strong>)</td><td class="confluenceTd">Affects the outgoing<span> </span><strong>NEXT_HOP</strong><span> </span>attribute selection. Note that next-hops set in filters always take precedence. Also note that the next-hop is not changed on route reflection, except when it's set in the filter.<ul><li><span style="color:var(--ds-icon-success,#22a06b);">default</span><span> </span>- select the next-hop as described in RFC 4271</li><li><span style="color:var(--ds-icon-success,#22a06b);">force-self</span><span> </span>- always use a local address of the interface that is used to connect to the peer as the next-hop;</li><li><span style="color:var(--ds-icon-success,#22a06b);">propagate</span><span> </span>- try to propagate further the next-hop received; i.e. if the route has BGP<span> </span><strong>NEXT_HOP</strong><span> </span>attribute, then use it as the next-hop, otherwise, fall back to the default case</li></ul></td></tr><tr><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff" title="Background colour : Light blue 35%"><strong title="">output</strong> - a group of parameters associated with BGP output</td></tr><tr><td rowspan="11" class="confluenceTd"><br/></td><td class="confluenceTd"><strong title="">.as-override<span title=""> </span>(<em title="">yes | no</em>; Default:<span title=""> </span>no)</strong></td><td class="confluenceTd"><p>If set, then all instances of the remote peer's AS number in the BGP AS-PATH attribute are replaced with the local AS number before sending a route update to that peer. Happens before routing filters and prepending.</p></td></tr><tr><td class="confluenceTd"><strong title="">.affinity</strong>(afi  | alone | instance | main | remote-as | vrf; Default: )</td><td class="confluenceTd"><p>Configure output multicore processing. Read more in <a href="Routing-Protocol-Multi-core-Support_34897937.html">Routing Protocol Multi-core Support</a> article.</p><ul style="text-decoration: none;"><li class="auto-cursor-target"><strong>alone</strong> - input and output of each session is processed in its own process, the most likely best option when there are a lot of cores and a lot of peers</li><li class="auto-cursor-target"><strong>afi, instance, vrf, remote-as</strong> - try to run input/output of new session in process with similar parameters</li><li class="auto-cursor-target"><strong>main</strong> - run input/output in the main process (could potentially increase performance on single-core even possibly on multicore devices with small amount of cores)</li><li class="auto-cursor-target"><strong>input</strong> - run output in the same process as input (can be set only for output affinity)</li></ul></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.default-originate</strong><span title=""> </span>(<em title="">always | if-installed | never</em>; Default:<span title=""> </span><strong title="">never</strong>)   </td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">Specifies default route (0.0.0.0/0) distribution method. </td></tr><tr><td class="confluenceTd"><strong>default-prepend</strong><span> </span>(<em>integer [0..255]</em>; Default: )</td><td class="confluenceTd"><br/></td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.filter-chain </strong>(<em title="">name</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">Name of the routing filter chain to be used on the output prefixes. If the chain is not specified, then BGP by default accepts everything.</td></tr><tr><td class="confluenceTd"><strong title="">.filter-select </strong>(<em title="">name</em>; Default: )</td><td class="confluenceTd">Name of the routing select chain to be used for prefix selection. If not specified, then default selection is used.</td></tr><tr><td class="confluenceTd"><strong title="">.keep-sent-attributes </strong>(<em title="">yes | no</em>; Default: no)</td><td class="confluenceTd">Store in memory sent prefix attributes, required for &quot;<span style="color:var(--ds-background-accent-orange-bolder,#c25100);"><code>dump-saved-advertisements</code></span>&quot; command to work. By default, sent-out prefixes are not stored to preserve the router's memory. An option should be enabled only for debugging purposes when necessary to see currently advertised prefixes.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.network</strong>(<em title="">name</em>; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">Name of the address list used to send local networks. The network is sent only if a matching IGP route exists in the routing table.</td></tr><tr><td class="confluenceTd"><strong title="">.no-client-to-client-reflection</strong><span title=""> </span>(yes | no; Default: )</td><td class="confluenceTd">Disable client-to-client route reflection in Route Reflector setups.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%"><strong title="">.no-early-cut</strong><span title=""> </span>(yes | no; Default: )</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7" title="Background colour : Light grey 100%">The early cut is the mechanism, to guess (based on default RFC behavior) what would happen with the sent NPLRI when received by the remote peer. If the algorithm determines that the NLRI is going to be dropped, a peer will not even try to send it. However such behavior may not be desired in specific scenarios, then then this option should be used to disable the early cut feature.</td></tr><tr><td class="confluenceTd"><strong title="">redistribute</strong><span title=""> </span>(bgp<em>, connected, bgp-mpls-vpn , dhcp, fantasy, modem, ospf, rip, static, vpn</em>; Default:)</td><td class="confluenceTd">Enable redistribution of specified route types.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">remove-private-as</strong><span title=""> </span>(<em title="">yes | no</em>; Default:<span title=""> </span><strong title="">no</strong></td><td class="confluenceTd">If set, then the BGP <strong>AS-PATH</strong> attribute is removed before sending out route updates if the attribute contains only private AS numbers.<p title="">The removal process happens before routing filters are applied and before the local, AS <span>number is prepended to the AS path.</span></p></td></tr><tr><td class="highlight-grey confluenceTd" colspan="2" data-highlight-colour="grey" title="Background colour :"><br/></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour :"><p title=""><br/></p></td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">routing-table</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">Name of the routing table, to install routes in. Overrides instance parameter.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">save-to</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">Filename to be used to save BGP protocol-specific packet content (Exported PDU) into pcap file. This method allows much simpler peer-specific packet capturing for debugging purposes. Pcap files in this format can also be loaded to create virtual BGP peers to recreate conditions that happened at the time when packet capture was running.</td></tr><tr><td class="highlight-grey confluenceTd" colspan="2" data-highlight-colour="grey" title="Background colour :"><strong title="">templates</strong><span title=""> </span>(<em title="">name[,name]</em>; Default: )</td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour :">List of template names from which to inherit parameters. Useful feature, to easily configure groups with overlapping configuration options.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title="">use-bfd</strong><span title=""> </span>(<em title="">yes | no</em>; Default:<span title=""> </span><strong title="">no</strong>)</td><td class="confluenceTd">Whether to use the<span title=""> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/BFD" rel="nofollow" style="text-decoration: none;" title="">BFD</a><span title=""> </span>protocol for faster connection state detection.</td></tr><tr><td class="highlight-grey confluenceTd" colspan="2" data-highlight-colour="grey" title="Background colour :"><strong title="">vrf</strong><span title=""> </span>(<em title="">name</em>; Default: main )</td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour :">Name of the VRF BGP connections operates on. By default always use the &quot;main&quot; routing table. Overrides instance parameter.</td></tr></tbody></table></div><p><br/></p><p><br/></p><h1 id="BGP-Best-PathSelection">Best-Path Selection</h1><p>BGP routers can receive multiple copies of the global routing table from multiple providers.</p><p>There should be some way to compare those multiple BGP routing tables and select the best route to the destination, the solution is the BGP Best Path Selection Algorithm.</p><p>The route is evaluated by the algorithm only if it is valid. In general, the route is considered valid if:</p><ul class="bullets"><li>NEXT_HOP of the route is valid and reachable</li><li>AS_PATH received from external peers does not contain the local AS</li><li>the route is not rejected by routing filters</li></ul><p>For more information read <a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:BGP_nexthop_selection_and_validation_in_RouterOS_3.x" rel="nofollow" style="text-decoration: none;" title="Manual:BGP nexthop selection and validation in RouterOS 3.x">nexthop selection and validation</a>.</p><p>The best path algorithm also compares routes received only by a <strong>single BGP instance</strong>. Routes installed by different BGP instances are compared by the general algorithm, i.e. route distances are compared and the route with a lower distance is preferred.</p><p>If all the criteria are met, then the following actions take place:</p><ol class="bullets" style="text-decoration: none;"><li>The first path received is automatically considered the 'best path'. Any further received paths are compared to the first received to determine if the new path is better.</li><li>Prefer the path with the highest <strong>WEIGHT</strong>. <br/>This parameter is not a part of the BGP standard, it is invented to quickly locally select the best route. A parameter is local to the router (assigned with routing filters in the BGP input) and cannot be advertised. A route without assigned WEIGHT has a default value of 0.</li><li>Prefer the path with the highest <strong>LOCAL_PREF</strong>. <br/>This attribute is used only within an AS. A path without the LOCAL_PREF attribute has a value of 100 by default.</li><li>Prefer the path with the shortest <strong>AS_PATH</strong>. (skipped if <span style="color:var(--ds-text-accent-green-bolder,#164b35);"><code>input.ignore-as-path-len</code></span> set to <strong>yes</strong>).<br/>Each AS_SET counts as 1, regardless of the set size. The AS_CONFED_SEQUENCE and AS_CONFED_SET are not included in the AS_PATH length.</li><li><s>Prefer the path that was locally originated via aggregate or BGP network</s></li><li>Prefer the path with the lowest <strong>ORIGIN</strong> type.<p>Interior Gateway Protocol (IGP) is lower than Exterior Gateway Protocol (EGP), and EGP is lower than INCOMPLETE</p>in other words <strong>IGP &lt; EGP &lt; INCOMPLETE</strong></li><li>Prefer the path with the lowest <strong>multi-exit discriminator</strong> (MED).<p>The router compares the MED attribute only for paths that have the same neighboring (leftmost) AS unless <span style="color:var(--ds-icon-success,#22a06b);"><code>input.always-compare-med</code></span> is enabled. <br/>Paths without explicit MED value are treated with MED of 0.</p></li><li>Prefer <strong>eBGP</strong> over <strong>iBGP</strong> paths</li><li>Prefer lowest <strong>IGP metric</strong>.</li><li>Prefer the route that comes from the BGP router with the lowest <strong>router ID</strong>. If a route carries the <strong>ORIGINATOR_ID</strong> attribute, then the <strong>ORIGINATOR_ID</strong> is used instead of the router ID.</li><li>Prefer the route with the shortest <strong>route reflection cluster list</strong>. Routes without a cluster list are considered to have a cluster list of length 0.</li><li>Prefer the path that comes from the lowest neighbor address</li></ol><p><br/></p><h1 id="BGP-RoutingFilterNotes">Routing Filter Notes</h1><p>On BGP output routing filters are executed before BGP itself is modifying attributes, for example, if <code><span style="color:var(--ds-text-accent-green-bolder,#164b35);">nexthop-choice</span></code> is set to<code><span style="color:var(--ds-text-accent-green-bolder,#164b35);"> force-self</span></code>, then the gateway set in the routing filters will be overridden.</p><p>On BGP input routing filters are applied to the received attributes, which means that, for example, setting the gateway will work no matter what <code><span style="color:var(--ds-text-accent-green-bolder,#164b35);">nexhop-choice</span></code> value is set.</p><h1 id="BGP-RunningMorethanOneInstance">Running More than One Instance</h1><p>As we already know for best path selection to work properly, BGP routes must be received from the same instance. But in certain scenarios it is necessary to run multiple BGP instances with their own separate tables. <br/>BGP determines whether sessions belongs to the same instance by comparing configured local router IDs. <br/><br/>For example config below will run each peer in its own BGP instance</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/routing/bgp/connection
add name=inst1_peer remote.address=192.168.1.1 as=1234 local.role=ebgp router-id=1.1.1.1
add name=inst2_peer remote.address=192.168.1.2 as=5678 local.role=ebgp router-id=2.2.2.2</pre>
</div></div><p><br/>When <span style="color:var(--ds-text-accent-green-bolder,#164b35);"><code>router-id</code></span> is not specified BGP will pick the &quot;default&quot; ID from <span style="color:var(--ds-text-accent-blue,#0055cc);"><code>/routing id</code></span>.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Starting from v7.20 instance is no longer determined by router-id.</p></div></div><p><br/></p><h1 id="BGP-BGPBasedVPLS"><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><code>BGP Based VPLS</code></span></h1><p><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);"><code><strong>Sub Menu:</strong> </code></span><code>/routing/bgp/vpls</code></span></p><p><span style="text-decoration: none;color:var(--ds-text,#172b4d);">This menu lists all the configured BGP-based VPLS instances. These instances allow the router to advertise VPLS BGP NLRI and indicate that the router belongs to a specific customer VPLS network.</span></p><p><span style="text-decoration: none;color:var(--ds-text,#172b4d);">MP-BGP-based autodiscovery and signaling (RFC 4761).</span></p><p><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Cisco VPLS BGP-based auto-discovery (draft-ietf-l2vpn-signaling-08).</span></p><p>Support for multiple import/export route target extended communities for BGP-based VPLS (both, RFC 4761 and draft-ietf-l2vpn-signaling-08).</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff" scope="col" title="Background colour : Light blue 35%">Property</th><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff" scope="col" title="Background colour : Light blue 35%">Description</th></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">bridge</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">name</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">The name of the bridge where dynamically created VPLS interfaces should be added as ports.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">bridge-cost</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">integer [0..4294967295]</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">bridge-horizon</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">none | integer [0..4294967295]</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">If set to</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><strong style="text-decoration: none;text-align: left;">none</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">bridge horizon will not be used.</span></td></tr><tr><td style="text-align: left;vertical-align: top;" class="confluenceTd"><strong>bridge-pvid</strong><span> </span>(integer 1..4094)</td><td style="text-align: left;vertical-align: top;" class="confluenceTd">Used to assign port VLAN ID (pvid) for dynamically bridged interface.</td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">cisco-id</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> ()</span></td><td class="confluenceTd">Unique identifier. A parameter must be set for cisco-style VPLS signaling. In most cases this should not be used, any modern software supports RFC 4761 style signaling (see site-id parameter). Parameter is a merge of l2-router-id and RD, for example: 10.155.155.1&amp;6550:123</td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">comment</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">string</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Short description of the item.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">disabled</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">yes | no</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Defines whether an item is ignored or used.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">export-route-target</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(list of RTs)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">The setting is used to tag BGP NLRI with one or more route targets which on the remote side is used by <code><span style="color:var(--ds-text-accent-green-bolder,#164b35);">import-route-targets</span></code>.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">import-route-targets</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">list of RTs</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">The setting is used to determine if BGP NLRI is related to a particular VPLS, by comparing route targets received from BGP NLRI.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">local-pref </strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">integer[0..4294967295]</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">name</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">string</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">; Default: )</span></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">pw-control-word</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">default | disabled | enabled</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Enables/disables Control Word usage.</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> Read more in the <a href="VPLS-Control-Word_128974851.html">VPLS Control Word</a> article.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">pw-l2mtu</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">integer[32..65535]</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Advertised pseudowire MTU value.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">pw-type</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">raw-ethernet | tagged-ethernet | vpls</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">The parameter is available starting from v5.16. It allows choosing advertised encapsulation in NLRI used only for comparison. It does not affect the functionality of the tunnel.</span><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:MPLS_L2VPN_vs_Juniper" rel="nofollow" style="text-decoration: none;text-align: left;" title="Manual:MPLS L2VPN vs Juniper"><code>See pw-type usage example &gt;&gt;</code></a></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">rd</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">string</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Specifies the value that gets attached to VPLS NLRI so that receiving routers can distinguish advertisements that may otherwise look the same. This implies that a unique route-distinguisher for every VPLS must be used. It is not necessary to use the same route distinguisher for some VPLS on all routers forming that VPLS as distinguisher is not used for determining if some BGP NLRI is related to a particular VPLS (Route Target attribute is used for this), but it is mandatory to have different distinguishers for different VPLSes. Accepts 3 types of formats. <a href="#BGP-RouteDistinguisher">Read more&gt;&gt;</a></span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">site-id</strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);"> </span><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">integer [0..65535]</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Unique site identifier. Each site must have a unique site-id. A parameter must be set for RFC 4761 style VPLS signaling.</span></td></tr><tr><td class="confluenceTd"><strong style="text-decoration: none;text-align: left;">vrf </strong><span style="text-decoration: none;color:var(--ds-text,#172b4d);">(</span><em style="text-decoration: none;text-align: left;">name</em><span style="text-decoration: none;color:var(--ds-text,#172b4d);">)</span></td><td class="confluenceTd">Name of the VRF table.</td></tr></tbody></table></div><h1 id="BGP-L3VPN(VPNv4,VPNv6)"><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><code>L3VPN (VPNv4, VPNv6)</code></span></h1><p><span style="color:var(--ds-icon-accent-blue,#1d7afc);"><span style="color:var(--ds-text,#333333);"><code><strong>Sub Menu:</strong> </code></span><code>/routing/bgp/vpn</code></span></p><h3 id="BGP-RouteDistinguisher">Route Distinguisher</h3><p>Route Distinguisher is a 64-bit integer, which is divided into three parts:</p><ul><li>type (always 2 bytes),</li><li>administrator subfield,</li><li>value or service provider subfield.</li></ul><p>Currently, there are three format types defined.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh"><strong>2bytes</strong></th><th scope="col" class="confluenceTh">2bytes</th><th scope="col" class="confluenceTh">2bytes</th><th scope="col" class="confluenceTh">2bytes</th></tr><tr><th scope="col" class="confluenceTh"><strong>Type1</strong></th><td scope="col" style="text-align: center;" class="confluenceTd">ASN</td><td colspan="2" scope="colgroup" style="text-align: center;" class="confluenceTd">4byte value</td></tr><tr><th class="confluenceTh"><strong>Type2</strong></th><td colspan="2" style="text-align: center;" class="confluenceTd">4-byte IP</td><td style="text-align: center;" class="confluenceTd">value</td></tr><tr><th class="confluenceTh">Type3</th><td colspan="2" style="text-align: center;" class="confluenceTd">4-byte ASN</td><td style="text-align: center;" class="confluenceTd">value</td></tr></tbody></table></div><p><br/></p><h3 id="BGP-Properties">Properties</h3><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 87.14969%;"><colgroup><col style="width: 5.313653%;"/><col style="width: 28.413284%;"/><col style="width: 66.199265%;"/></colgroup><tbody><tr><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7"><strong>disabled</strong><span> </span>(<em>yes | no</em>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><br/></td></tr><tr><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff"><strong>export</strong> - a group of parameters associated with the vpnv4 export</td></tr><tr><td rowspan="4" class="confluenceTd"><br/><br/><br/></td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.filter-chain</strong><span title=""> </span>(<em>name</em>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">The name of the routing filter chain that is used to filter prefixes before exporting.</td></tr><tr><td class="confluenceTd"><strong title="">.filter-select</strong>(<em>name</em>)</td><td class="confluenceTd">The name of the select filter chain that is used to select prefixes to be exported exporting.</td></tr><tr><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.redistribute</strong>(<em title="">bgp | connected | dhcp | fantasy | modem | ospf | rip | static | vpn</em>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Enable redistribution of specified route types from VRF to VPNv4.</td></tr><tr><td class="confluenceTd"><strong title="">.route-targets</strong>(<em>rt[,rt]</em>)</td><td class="confluenceTd">List of route targets added when exporting VPNv4 routes. The accepted RT format is similar to the one for Route Distinguishers.</td></tr><tr><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff"><strong>import</strong> - a group of parameters associated with the vpnv4 import</td></tr><tr><td rowspan="3" class="confluenceTd"><br/></td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.filter-chain</strong><span title=""> </span>(<em>name</em>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">The name of the routing filter chain that is used to filter prefixes during import.</td></tr><tr><td class="confluenceTd"><strong title="">.route-targets</strong>(<em>rt[,rt]</em>)</td><td class="confluenceTd">List of route targets that will be used to import VPNv4 routes. The accepted RT format is similar to the one for Route Distinguishers.</td></tr><tr><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour :"><strong title="">.router-id</strong>(<em>name | ip</em>)</td><td class="confluenceTd">The router ID of the BGP instance that will be used for the BGP best path selection algorithm.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title=""><strong>label-allocation-policy</strong></strong> (<em>per-prefix | per-vrf</em>)</td><td class="confluenceTd"><br/></td></tr><tr><td colspan="2" class="confluenceTd"><strong title=""><strong>name</strong></strong></td><td class="confluenceTd"><br/></td></tr><tr><td colspan="2" class="confluenceTd"><strong title=""><strong>route-distinguisher<span> </span></strong></strong>(rd)</td><td class="confluenceTd">Helps to distinguish between overlapping routes from multiple VRFs. Should be unique per VRF. Accepts 3 types of formats. <a href="#BGP-RouteDistinguisher">Read more&gt;&gt;</a></td></tr><tr><td colspan="2" class="confluenceTd"><strong title=""><strong>vrf<span title=""> </span></strong></strong>(<em title="">name</em>)</td><td class="confluenceTd">Name of the VRF table that this VPN instance will use.</td></tr><tr><td colspan="2" class="confluenceTd"><strong title=""><strong>instance </strong></strong><em>(name)</em><strong title=""><strong><br/></strong></strong></td><td class="confluenceTd">Name of the instance this VPN is assigned to.</td></tr></tbody></table></div><h1 id="BGP-EVPN">EVPN</h1><p><strong>Sub-menu:</strong> <span style="color:var(--ds-icon-accent-blue,#1d7afc);"><code>/routing bgp evpn</code></span></p><p>See EVPN documentation.</p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 99.92372%;"><colgroup class=""><col class="" style="width: 2.215432%;"/><col class="" style="width: 15.584415%;"/><col class="" style="width: 82.20015%;"/></colgroup><tbody class=""><tr class=""><th class="highlight-#deebff confluenceTh" colspan="2" data-highlight-colour="#deebff">Property</th><th class="highlight-#deebff confluenceTh" data-highlight-colour="#deebff">Description</th></tr><tr class=""><td colspan="2" class="confluenceTd"><strong title="">name</strong><span title=""> </span>(<em title="">string</em>; Default: )</td><td class="confluenceTd">Name of the entry</td></tr><tr class=""><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7"><strong title="">instance</strong><span title=""> </span>(<em>name</em>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">BGP instance this EVPN is assigned to.</td></tr><tr class=""><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff"><strong>export</strong> - a group of parameters associated with the route export</td></tr><tr class=""><td class="confluenceTd"><br/></td><td class="confluenceTd"><strong title="">.route-targets</strong><span title=""> </span>(<em title="">Iist of RTs</em>)</td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#333333);">List of route targets that will be added to EVPN routes when exporting.</span></td></tr><tr class=""><td class="highlight-#deebff confluenceTd" colspan="3" data-highlight-colour="#deebff"><strong>import</strong> - a group of parameters associated with the route import</td></tr><tr class=""><td class="confluenceTd"><br/></td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><strong title="">.route-targets</strong><span title=""> </span>(<em title="">Iist of RTs</em>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7"><span style="text-decoration: none;color:var(--ds-text,#333333);">List of route targets that will be used to import EVPN routes.</span></td></tr><tr class=""><td colspan="2" class="confluenceTd"><strong>rd</strong><span> </span>(<em>string</em>)</td><td class="confluenceTd"><span style="text-decoration: none;color:var(--ds-text,#333333);">Specifies the value that gets attached to route so that receiving routers can distinguish advertisements that may otherwise look the same. Used to distinguish between tenants using overlapping IP ranges. Also can be used to simplify convergence and redundancy within Virtual Network. RDs form MLAG pairs should be unique, too.</span></td></tr><tr class=""><td class="highlight-#f4f5f7 confluenceTd" colspan="2" data-highlight-colour="#f4f5f7"><strong title="">vni</strong><span title=""> </span>(<em>range of integers[0..4294967295]</em>)</td><td class="highlight-#f4f5f7 confluenceTd" data-highlight-colour="#f4f5f7">Range of Virtual Network Identifiers. </td></tr><tr class=""><td colspan="2" class="confluenceTd"><strong title="">vrf<span title=""> </span></strong>(<em>name</em>)</td><td class="confluenceTd"><br/></td></tr></tbody></table></div><p><br/></p>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:53</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
