<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : Netwatch</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="119144606.html">Diagnostics, monitoring and troubleshooting</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : Netwatch
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Artūrs C.</span>, last updated by <span class='editor'> Lība Klepecka</span> on May 07, 2025
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742046175 {padding: 0px;}
div.rbtoc1747742046175 ul {margin-left: 0px;}
div.rbtoc1747742046175 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742046175'>
<ul class='toc-indentation'>
<li><a href='#Netwatch-Summary'>Summary</a></li>
<li><a href='#Netwatch-Properties'>Properties</a></li>
<li><a href='#Netwatch-Type-specificoptions'>Type-specific options</a>
<ul class='toc-indentation'>
<li><a href='#Netwatch-icmpICMPprobeoptions'>ICMP probe options</a></li>
<li><a href='#Netwatch-tcpTCP-CONNECT'>TCP-CONNECT</a></li>
<li><a href='#Netwatch-TCP-CONNECTpass-failcriteria'>TCP-CONNECT pass-fail criteria</a></li>
<li><a href='#Netwatch-httpHTTP-GETprobeoptions'>HTTP-GET probe options</a></li>
<li><a href='#Netwatch-httpsHTTPS-GETprobeoptions'>HTTPS-GET probe options</a></li>
<li><a href='#Netwatch-HTTP-GET/HTTPS-GETprobepass/failcriteria'>HTTP-GET/HTTPS-GET probe pass/fail criteria</a></li>
<li><a href='#Netwatch-dnsDNSprobeoptions'>DNS probe options</a></li>
</ul>
</li>
<li><a href='#Netwatch-Probestatistics/variables'>Probe statistics/variables</a>
<ul class='toc-indentation'>
<li><a href='#Netwatch-Generic:'>Generic:</a></li>
<li><a href='#Netwatch-ICMP:'>ICMP:</a></li>
<li><a href='#Netwatch-TCP:'>TCP:</a></li>
<li><a href='#Netwatch-HTTP:'>HTTP:</a></li>
<li><a href='#Netwatch-HTTPS:'>HTTPS:</a></li>
<li><a href='#Netwatch-DNS:'>DNS:</a></li>
</ul>
</li>
<li><a href='#Netwatch-Logs'>Logs</a></li>
<li><a href='#Netwatch-Status'>Status</a></li>
<li><a href='#Netwatch-QuickExample'>Quick Example</a></li>
</ul>
</div></p><h1 id="Netwatch-Summary">Summary</h1><p>Netwatch monitors the state of hosts on the network. Monitoring can be done with the following probe types:<br/>1) ICMP - pings to a specified IP address - hosts, with an option to adjust threshold values<br/>2) Simple - uses ping, without use of advanced metrics<br/>3) TCP conn, to test the TCP connection<br/>4) HTTP GET/HTTPS GET, request against a server you are monitoring<br/>5) DNS - sends DNS query to DNS server and checks for response.<br/><br/>For each entry in the Netwatch table, you can specify an IP address, ping interval, and console scripts. The main advantage of Netwatch is its ability to issue arbitrary console commands on host state changes.</p><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body">Since 7.4, Netwatch functionality has been expanded, prior versions only support simple ICMP probes. While upgrading to the new version, old Netwatch entries will be unchanged, reporting probe type &quot;simple&quot; - preserving the same functionality.</div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Default Netwatch values are always used -  <strong>even if they were not defined</strong> by the user. Make sure to check the &quot;status&quot; page of the probe to see if the default thresholds are appropriate for your use case. Default threshold values can be found under the &quot;probe options&quot; section on this page.</p></div></div><h1 id="Netwatch-Properties">Properties</h1><p><strong>Sub-menu:</strong><span style="color:var(--ds-text,#172b4d);"> </span><code>/tool/netwatch</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>host</strong><span> </span>(Default:&quot;&quot;)</td><td style="text-align: left;" class="confluenceTd"><p>The IP address of the server to be probed. Formats:</p><p><span style="color:var(--ds-text,#333333);">-<span> </span></span><em>ipv4</em><br/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em>ipv4</em><code>@</code><em>vrf</em><br/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em>ipv6</em><br/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em>ipv6</em><code>@</code><em>vrf</em><br/><span style="color:var(--ds-text,#333333);">-<span> </span></span><em>ipv6-linklocal</em><code>%</code><em>interface<br/>- domain name </em>(for type=dns)</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>type</strong><span> </span>(icmp <em>| tcp-conn | http-get | <em style="text-align: left;">http-get | dns | </em>simple;</em> Default: <strong>simple</strong>)</td><td style="text-align: left;" class="confluenceTd"><p>Type of the probe:<br/>- <a href="#Netwatch-icmp"> icmp </a>- (ping-style) series of ICMP request-response with statistics<br/>- <a href="#Netwatch-tcp"> tcp-conn </a>- test TCP connection (3-way handshake) to a server specified by IP and port<br/>- <a href="#Netwatch-http">http-get</a> - do an HTTP Get request and test for a range of correct replies<br/>- <a href="#Netwatch-https">https-get</a> - do an HTTP Get request and test for a range of correct replies<br/>- <a href="#Netwatch-dns"> dns </a>- do a specified DNS query for domain name<br/>- simple - simplified ICMP probe, with fewer options than &quot;ICMP&quot; type, used for backward compatibility with the older Netwatch version</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>interval</strong> (Default:<strong> 10s</strong>)</td><td style="text-align: left;" class="confluenceTd"><p>The time interval between probe tests</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>timeout</strong> (Default: <strong>3s</strong>)</td><td style="text-align: left;" class="confluenceTd"><p>Max time limit to wait for a response</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>src-address</strong> (Default:<strong>&quot;&quot;</strong>)</td><td style="text-align: left;" class="confluenceTd"><p>Source IP address which the Netwatch will try to use in order to reach the host. If address is not present, then the host will be considered as &quot;down&quot;.</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>start-delay</strong> (Default:<strong> 3s</strong>)</td><td style="text-align: left;" class="confluenceTd"><p>Time to wait before starting probe (on add, enable, or system start)</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>startup-delay </strong>(Default: <strong>5m</strong>)</td><td style="text-align: left;" class="confluenceTd"><p>Time to wait until starting Netwatch probe after system startup</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>up-script </strong>(Default:&quot;&quot;)</td><td style="text-align: left;" class="confluenceTd"><p>Script to execute on the event of probe state change 'fail' --&gt; 'OK'</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>down-script </strong>(Default:&quot;&quot;)</td><td style="text-align: left;" class="confluenceTd"><p>Script to execute on the event of probe state change 'OK' --&gt; 'fail'</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>test-script </strong>(Default:&quot;&quot;)</td><td style="text-align: left;" class="confluenceTd"><p>Script to execute at the end of every probe test</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>ignore-initial-up </strong><em>(no </em>|<em> yes </em>; Default<em>: </em><strong>no</strong>)</td><td style="text-align: left;" class="confluenceTd"><p>Specifies if &quot;Up&quot; script should be ran if probe state change goes from `Unknown` to 'Up', used to help against false positives after enabling the probe, or after a reboot. &quot;no&quot; means that change from Unknown to Up will not be ignored.</p></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>ignore-initial-down</strong> (<em>no</em> | <em>yes</em>; Default: <strong><strong>no</strong></strong>)</td><td style="text-align: left;" class="confluenceTd"><div class="content-wrapper"><p>Specifies if &quot;Down&quot; script should be ran if probe state change goes from `Unknown` to 'Down'. &quot;no&quot; means that change from 'Unknown' to 'Down' will not be ignored.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Should be used with care, as first &quot;Down&quot; status won't be executed, and Down script will only be ran if probe goes through &quot;Up&quot; &gt; &quot;Down&quot; state.</p></div></div><p><br/></p></div></td></tr></tbody></table></div><p>Netwatch executes scripts as *sys user, so any defined global variable in the Netwatch script will not be readable by for an example a scheduler or other users</p><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Netwatch is limited to <em>read,write,test,reboot</em> script policies. If the owner of the script does not have enough permissions to execute a certain command in the script, then the script will not be executed. If the script has greater policies than <em>read,write,test,reboot</em> - then the script will not be executed as well, make sure your scripts do not exceed the mentioned policies.</p></div></div><p>It is possible to disable permission checking for RouterOS scripts under <em>/system/scripts </em>menu. This is useful when Netwatch does not have enough permissions to execute a script, though this decreases overall security. It is recommended to assign proper permissions to a script instead.</p><h1 id="Netwatch-Type-specificoptions">Type-specific options</h1><p>All config options specific to one probe type (e.g. icmp's packet-interval) are ignored for other probe types.</p><h2 id="Netwatch-icmpICMPprobeoptions"><span class="confluence-anchor-link" id="Netwatch-icmp"></span>ICMP probe options</h2><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 84.8308%;"><colgroup><col style="width: 42.2283%;"/><col style="width: 57.6341%;"/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>packet-interval</strong> (Default: <strong>50ms</strong>)</td><td class="confluenceTd">The time between ICMP-request packet send</td></tr><tr><td class="confluenceTd"><strong>packet-count</strong> (Default: <strong>10</strong>)</td><td class="confluenceTd">Total count of ICMP packets to send out within a single test</td></tr><tr><td class="confluenceTd"><strong>packet-size</strong> (Default: <strong>54</strong> (IPv4) or <strong>54</strong> (IPv6))</td><td class="confluenceTd">The total size of the IP ICMP packet</td></tr><tr><td class="confluenceTd"><strong>thr-max</strong> (Default<strong>: 1s</strong>)</td><td class="confluenceTd">Fail threshold for rtt-max (a value above thr-max is a probe fail)</td></tr><tr><td class="confluenceTd"><strong>thr-avg</strong> (Default: <strong>100ms</strong>)</td><td class="confluenceTd">Fail threshold for rtt-avg (round trip time-avg)</td></tr><tr><td class="confluenceTd"><strong>thr-stdev</strong> (Default: <strong>250ms</strong>)</td><td class="confluenceTd">Fail threshold for rtt-stdev</td></tr><tr><td class="confluenceTd"><strong>thr-jitter </strong>(Default:<strong> 1s</strong>)</td><td class="confluenceTd">Fail threshold for rtt-jitter</td></tr><tr><td class="confluenceTd"><strong>thr-loss-percent </strong>(Default: <strong>85.0%</strong>)</td><td class="confluenceTd">Fail threshold for loss-percent</td></tr><tr><td class="confluenceTd"><strong>thr-loss-count</strong> (Default: <strong>4294967295</strong>(max))</td><td class="confluenceTd">Fail threshold for loss-count</td></tr><tr><td class="confluenceTd"><strong>ttl </strong>(Default; <strong>255</strong>)</td><td class="confluenceTd">Manually set time to live value for ICMP packet</td></tr><tr><td class="confluenceTd"><strong>accept-icmp-time-exceeded</strong> (<em>yes</em> | <em>no</em>; Default <strong>no</strong>)</td><td class="confluenceTd">If the ICMP &quot;time exceeded&quot; message should be considered a valid response</td></tr></tbody></table></div><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-background-accent-green-bolder,#1f845a);"><code>accept-icmp-time-exceeded=yes</code></span> can be used together with a manually set low <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">ttl</span></code> value to monitor Internet connectivity, without relying on a specific endpoint. </p><p>For example, you can monitor a public IP address, but that address can filter your ICMP request, or just become unreachable itself, if the Netwatch probe is using this address to monitor Internet connectivity this would cause a false alarm.</p><p>To make sure you can reach the Internet, it's generally enough to make sure you can reach a device a few routing hops away. Low time to live value will expire in transit to the specified host you want to monitor - each router passing the ICMP packet will subtract &quot;1&quot; from TTL value, upon TTL reaching 0, ICMP &quot;time exceeded&quot; packet will be generated, and sent back to the Netwatch probe. If all other fail thresholds are not broken, this response will be considered a success.</p></div></div><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Simple, ICMP, HTTP, and TCP-connect probes are sent with the &quot;don't fragment&quot; flag set. With an ICMP probe, you can set <span style="color:var(--ds-background-accent-green-bolder,#1f845a);"><code>packet-size</code></span>, which in combination with the DF flag, can be used to aid with path MTU discovery</p></div></div><p><br/></p><h2 id="Netwatch-tcpTCP-CONNECT"><span class="confluence-anchor-link" id="Netwatch-tcp"></span>TCP-CONNECT</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh"><strong>Property</strong></th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>port</strong> (Default: <strong>80</strong>)</td><td class="confluenceTd">TCP port (for both tcp-conn and http-get probes)</td></tr></tbody></table></div><h2 id="Netwatch-TCP-CONNECTpass-failcriteria">TCP-CONNECT pass-fail criteria</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>thr-tcp-conn-time</strong> (Default: <strong>00:05...00:30</strong>)</td><td class="confluenceTd">Fail threshold for tcp-connect-time, the configuration uses microseconds, if the time unit is not specified (s/m/h), log and status pages display the same value in milliseconds.</td></tr></tbody></table></div><h2 id="Netwatch-httpHTTP-GETprobeoptions"><span class="confluence-anchor-link" id="Netwatch-http"></span>HTTP-GET probe options</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup class=""><col class=""/><col class=""/></colgroup><tbody class=""><tr class=""><th class="confluenceTh"><strong>Property</strong></th><th class="confluenceTh">Description</th></tr><tr class=""><td class="confluenceTd"><strong>port</strong> (Default: <strong>80</strong>)</td><td class="confluenceTd">TCP port (for both tcp-conn and http-get probes)</td></tr></tbody></table></div><h2 id="Netwatch-httpsHTTPS-GETprobeoptions"><span class="confluence-anchor-link" id="Netwatch-https"></span>HTTPS-GET probe options</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup class=""><col class=""/><col class=""/></colgroup><tbody class=""><tr class=""><th class="confluenceTh"><strong>Property</strong></th><th class="confluenceTh">Description</th></tr><tr class=""><td class="confluenceTd"><strong>port</strong> (Default: <strong>443</strong>)</td><td class="confluenceTd">TCP port (for both tcp-conn and http-get probes)</td></tr><tr><td class="confluenceTd"><strong>certificate</strong> (Default:&quot;&quot;)</td><td class="confluenceTd"><span style="color:var(--ds-text,#172b4d);">Certificate from local store that should be used for host verification.</span></td></tr><tr><td class="confluenceTd"><strong>check-certificate</strong> (<em>yes</em> | <em>no</em>; Default <strong>no</strong>)</td><td class="confluenceTd"><span style="color:var(--ds-text,#172b4d);">Enables trust chain validation from local certificate store.<span> </span></span></td></tr></tbody></table></div><h2 id="Netwatch-HTTP-GET/HTTPS-GETprobepass/failcriteria">HTTP-GET/HTTPS-GET probe pass/fail criteria</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>thr-http-time </strong>(Default: <strong>10s</strong>)</td><td class="confluenceTd">Fail threshold for http-resp-time</td></tr><tr><td class="confluenceTd"><strong>http-code-min</strong> (Default: <strong>100</strong>) </td><td class="confluenceTd">OK/fail criteria for HTTP response code.</td></tr><tr><td class="confluenceTd"><strong>http-code-max</strong> (Default: <strong>299</strong>)</td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">Response in the range [</span><code>http-code-min</code><span style="color:var(--ds-text,#333333);"><span> </span>,<span> </span></span><code>http-code-max</code><span style="color:var(--ds-text,#333333);">] is a probe pass/OK; outside - a probe fail. See<span> </span></span><a class="external-link" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" rel="nofollow" title="HTTP Status">mozilla-http-status</a><span style="color:var(--ds-text,#333333);"><span> </span>or<span> </span></span><a class="external-link" href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" rel="nofollow" title="RFC7231">rfc7231</a></td></tr></tbody></table></div><h2 id="Netwatch-dnsDNSprobeoptions"><span class="confluence-anchor-link" id="Netwatch-dns"></span>DNS probe options</h2><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 84.8308%;"><colgroup class=""><col class="" style="width: 42.2283%;"/><col class="" style="width: 57.6341%;"/></colgroup><tbody class=""><tr class=""><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>host </strong>(Default:&quot;&quot;)</td><td class="confluenceTd">DNS name that should be resolved.</td></tr><tr class=""><td class="confluenceTd"><strong>record-type</strong> (<em>A</em> | <em>AAAA</em> | <em>MX</em> | <em>NS</em>; Default: <strong>A</strong>)</td><td class="confluenceTd">Record type that will be used for DNS probe.</td></tr><tr class=""><td class="confluenceTd"><strong>dns-server</strong></td><td class="confluenceTd">The DNS server that the probe should send its requests to, if not specified it will use the value from &quot;<code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">/ip dns</span></code>&quot;.</td></tr></tbody></table></div><h1 id="Netwatch-Probestatistics/variables">Probe statistics/variables</h1><p>You can view statistics and use these variables in scripting, keep in mind that variables containing &quot;-&quot; must be written like this, for example, &quot;done-tests&quot; would be $&quot;done-tests&quot;</p><h2 id="Netwatch-Generic:">Generic:</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>name</strong></td><td class="confluenceTd">user added name for the Netwatch entry</td></tr><tr><td class="confluenceTd"><strong>comment</strong></td><td class="confluenceTd"><p>user added comment</p></td></tr><tr><td class="confluenceTd"><strong>host</strong></td><td class="confluenceTd"><p>host that was probed</p></td></tr><tr><td class="confluenceTd"><strong>type</strong></td><td class="confluenceTd"><p>probe type</p></td></tr><tr><td class="confluenceTd"><strong>interval</strong></td><td class="confluenceTd"><p>interval</p></td></tr><tr><td class="confluenceTd"><strong>timeout</strong></td><td class="confluenceTd"><p>timeout</p></td></tr><tr><td class="confluenceTd"><strong>since</strong></td><td class="confluenceTd"><p>The last time the status change happened</p></td></tr><tr><td class="confluenceTd"><strong>status</strong></td><td class="confluenceTd"><p>The current status of probe</p></td></tr><tr><td class="confluenceTd"><strong>done-tests</strong></td><td class="confluenceTd">total count of probe tests already done so far</td></tr><tr><td class="confluenceTd"><strong>failed-tests</strong></td><td class="confluenceTd"><p>count of failed probe tests</p></td></tr></tbody></table></div><h2 id="Netwatch-ICMP:">ICMP:</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">sent-count</span></strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">ICMP packets sent out</span></td></tr><tr><td class="confluenceTd"><strong>response-count</strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">Matching/valid ICMP packet responses received</span></td></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">thr-loss-count</span></strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">number of lost packets</span></td></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">thr-loss-percent</span></strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">number of lost packets in percent</span></td></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">thr-avg</span></strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">mean value of round trip time</span></td></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">thr-max</span></strong></td><td class="confluenceTd">max round trip time</td></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">thr-jitter</span></strong></td><td class="confluenceTd">jitter ( = max - min) of round trip time</td></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">thr-stdev</span></strong></td><td class="confluenceTd">standard deviation of round trip time</td></tr></tbody></table></div><h2 id="Netwatch-TCP:">TCP:</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>tcp-connect-time</strong></td><td class="confluenceTd">time taken to establish a TCP connection</td></tr></tbody></table></div><h2 id="Netwatch-HTTP:">HTTP:</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th scope="col" class="confluenceTh">Property</th><th scope="col" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>http-status-code</strong></td><td class="confluenceTd">HTTP response status code (200 OK, 404 Not Found, etc.). See <a class="external-link" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" rel="nofollow">mozilla-http-status</a> or <a class="external-link" href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" rel="nofollow">RFC7231</a></td></tr></tbody></table></div><h2 id="Netwatch-HTTPS:">HTTPS:</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup class=""><col class=""/><col class=""/></colgroup><tbody class=""><tr class=""><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr class=""><td class="confluenceTd"><strong>http-status-code</strong></td><td class="confluenceTd">HTTP response status code (200 OK, 404 Not Found, etc.). See <a class="external-link" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" rel="nofollow">mozilla-http-status</a> or <a class="external-link" href="https://datatracker.ietf.org/doc/html/rfc7231#section-6" rel="nofollow">RFC7231</a></td></tr></tbody></table></div><h2 id="Netwatch-DNS:">DNS:</h2><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 64.2361%;"><colgroup class=""><col class="" style="width: 18.1348%;"/><col class="" style="width: 81.8652%;"/></colgroup><tbody class=""><tr class=""><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr class=""><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">ip</span></strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">IP address - the result of </span><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">A <span style="color:var(--ds-text,#172b4d);">record-type probe</span></span></td></tr><tr class=""><td class="confluenceTd"><strong>ip6</strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">IPv6 address - the result of <span style="color:var(--ds-background-accent-green-bolder,#1f845a);">A</span><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">A</span><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">A</span><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">A</span></span><span style="color:var(--ds-background-accent-green-bolder,#1f845a);"> <span style="color:var(--ds-text,#172b4d);">record-type probe</span></span></td></tr><tr class=""><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">mail-servers</span></strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">Mail servers along with their priority - the result of <span style="color:var(--ds-background-accent-green-bolder,#1f845a);">MX</span> record-type probe</span></td></tr><tr><td class="confluenceTd"><strong><span style="color:var(--ds-text,#333333);">name-servers</span></strong></td><td class="confluenceTd"><span style="color:var(--ds-text,#333333);">Name servers - the result of <span style="color:var(--ds-background-accent-green-bolder,#1f845a);">NS</span> record-type probe</span></td></tr></tbody></table></div><h1 id="Netwatch-Logs">Logs</h1><p>On each probe's OK/fail state change:</p><ul><li>probe identification info and OK-&gt;fail or fail-&gt;OK is printed to info level</li><li>detailed probe stats and config is printed to debug level</li></ul><h1 id="Netwatch-Status">Status</h1><p>Command <em>/tool/netwatch/print</em> will show the current status of Netwatch and <strong>read-only</strong> properties:</p><ul><li>since - Indicates when a state of the host changed last time;</li><li>status - Shows the current status of the host;</li><li>host - address being monitored</li></ul><h1 id="Netwatch-QuickExample">Quick Example</h1><p>Here we will use a simple ICMP check to host with IP 8.8.8.8:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@MikroTik] &gt; /tool/netwatch add host=8.8.8.8 interval=30s up-script=&quot;:log info \&quot;Ping to 8.8.8.8 successful\&quot;&quot;</pre>
</div></div><p>Afterward, in the logging section we can see Netwatch executed script:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@MikroTik] &gt; log print where message~&quot;8.8.8.8&quot;
08:03:26 script,info Ping to 8.8.8.8 successful </pre>
</div></div><p><br/></p><p><br/></p>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:54</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
