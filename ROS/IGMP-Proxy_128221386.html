<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : IGMP Proxy</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="Routing_328222.html">Routing</a></span>
                            </li>
                                                    <li>
                                <span><a href="Multicast_59965491.html">Multicast</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : IGMP Proxy
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Edgars P.</span>, last updated on May 31, 2022
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742032164 {padding: 0px;}
div.rbtoc1747742032164 ul {margin-left: 0px;}
div.rbtoc1747742032164 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742032164'>
<ul class='toc-indentation'>
<li><a href='#IGMPProxy-Summary'>Summary</a></li>
<li><a href='#IGMPProxy-Configurationoptions'>Configuration options</a></li>
<li><a href='#IGMPProxy-Examples'>Examples</a></li>
</ul>
</div></p><h1 id="IGMPProxy-Summary"><span class="mw-headline">Summary</span></h1><hr/><p>Internet Group Management Protocol (IGMP) proxy can implement multicast routing. It is forwarding IGMP frames and is commonly used when there is no need for a more advanced protocol like PIM.</p><p><strong>IGMP proxy features:</strong></p><ul><li>The simplest way how to do multicast routing;</li><li>Can be used in topologies where PIM-SM is not suitable for some reason;</li><li>It takes slightly less resources than PIM-SM;</li><li>Ease of configuration.</li></ul><p>On the other hand, IGMP proxy is not well suited for complicated multicast routing setups. Compared to PIM-based solutions, IGMP proxy does not support more than one upstream interface and routing loops are not detected or avoided.</p><p>By default, IGMP proxy upstream interface will send IGMPv3 membership reports and it will detect what IGMP version the upstream device (e.g. multicast router) is using based on received queries. In case IGMPv1/v2 queries are received, the upstream port will fall back to the lower IGMP version. It will convert back to IGMPv3 when IGMPv1/v2 querier present timer (400s) expires. Downstream interfaces of IGMP proxy will only send IGMPv2 queries.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>RouterOS v7 has IGMP proxy configuration available in the main <strong>system</strong> package. Older RouterOS versions need an additional <strong>multicast</strong> package installed in order to use IGMP proxy. See more details about <a href="https://help.mikrotik.com/docs/display/ROS/Packages" rel="nofollow">Packages</a>.</p></div></div><h1 id="IGMPProxy-Configurationoptions">Configuration options</h1><hr/><p>General IGMP proxy configuration.</p><p><strong>Sub-menu:</strong> <code>/routing igmp-proxy</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Property</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">query-interval </strong>(<em>time: <span style="color:var(--ds-text-accent-lime-bolder,#37471f);">1s..1h</span></em>; Default: <strong>2m5s</strong>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">How often to send out IGMP Query messages over downstream interfaces.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>query-response-interval</strong> (<em>time: 1s..1h</em>; Default: <strong>10s</strong>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">How long to wait for responses to an IGMP Query message.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">quick-leave</strong></td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">Specifies action on IGMP Leave message. If quick-leave is on, then an IGMP Leave message is sent upstream as soon as a leave message is received from the first client on the downstream interface. Use<span> </span></span><strong style="text-align: left;">yes</strong><span style="color:var(--ds-text-accent-lime-bolder,#37471f);"><span> </span>only in case there is only one subscriber behind the proxy.</span></td></tr></tbody></table></div><p>Configure what interfaces will participate as IGMP proxy interfaces on the router. If an interface is not configured as an IGMP proxy interface, then all IGMP traffic received on it will be ignored.</p><p><strong>Sub-menu:</strong> <code>/routing igmp-proxy interface</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Property</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">alternative-subnets </strong>(<em>IP/Mask</em><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">; Default:<span> </span></span>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">By default, only packets from directly attached subnets are accepted. This parameter can be used to specify a list of alternative valid packet source subnets, both for data or IGMP packets. Has an effect only on the upstream interface. Should be used when the source of multicast data often is in a different IP network.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">interface</strong> (<em>name</em>; Default: <strong>all</strong>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">Name of the interface.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">threshold <span style="color:var(--ds-text,#172b4d);"> </span></strong>(<em>integer: 0..4294967295</em>; Default: <strong>1</strong>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">Minimal TTL. Packets received with a lower TTL value are ignored</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">upstream</strong><span style="color:var(--ds-text,#172b4d);"> </span><span style="color:var(--ds-text,#172b4d);">(</span><em style="text-align: left;">yes | no</em><span style="color:var(--ds-text,#172b4d);">; Default:</span><span style="color:var(--ds-text,#172b4d);"> </span><strong style="text-align: left;">no</strong><span style="color:var(--ds-text,#172b4d);">)</span></td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The interface is called &quot;upstream&quot; if it's in the direction of the root of the multicast tree. An IGMP forwarding router must have exactly one upstream interface configured. The upstream interface is used to send out IGMP membership requests.</span></td></tr></tbody></table></div><p>It is possible to get detailed status information for each interface using the <span style="color:var(--ds-background-accent-magenta-bolder,#ae4787);"><code>print</code></span> <span style="color:var(--ds-background-accent-green-bolder,#1f845a);"><code>status</code></span> command.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">[admin@MikroTik] /routing igmp-proxy interface print status 
Flags: X - disabled, I - inactive, D - dynamic; U - upstream 
 0  U interface=ether2 threshold=1 alternative-subnets=&quot;&quot; upstream=yes source-ip-address=192.168.10.10 rx-bytes=3018487500 rx-packets=2012325 tx-bytes=0 tx-packets=0 

 1    interface=ether3 threshold=1 alternative-subnets=&quot;&quot; upstream=no querier=yes source-ip-address=192.168.20.10 rx-bytes=0 rx-packets=0 tx-bytes=2973486000 tx-packets=1982324 

 2    interface=ether4 threshold=1 alternative-subnets=&quot;&quot; upstream=no querier=yes source-ip-address=192.168.30.10 rx-bytes=0 rx-packets=0 tx-bytes=152019000 tx-packets=101346 </pre>
</div></div><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Property</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">querier</strong> (<em>read-only; yes|no</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">Whether the interface is acting as an IGMP querier.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">source-ip-address <span style="color:var(--ds-text,#172b4d);"> </span></strong>(<em>read-only; IP address</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The detected source IP for the interface.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">rx-bytes</strong><span style="color:var(--ds-text,#172b4d);"> </span><span style="color:var(--ds-text,#172b4d);">(<em>read-only; integer</em></span><span style="color:var(--ds-text,#172b4d);">)</span></td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The total amount of received multicast traffic on the interface.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">rx-packet</strong><span style="color:var(--ds-text,#172b4d);"> </span><span style="color:var(--ds-text,#172b4d);">(<em>read-only; integer</em></span><span style="color:var(--ds-text,#172b4d);">)</span></td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The total amount of received multicast packets on the interface.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">tx-bytes</strong><span style="color:var(--ds-text,#172b4d);"> </span><span style="color:var(--ds-text,#172b4d);">(<em>read-only; integer</em></span><span style="color:var(--ds-text,#172b4d);">)</span></td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The total amount of transmitted multicast traffic on the interface.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong style="text-align: left;">tx-packet</strong><span style="color:var(--ds-text,#172b4d);"> </span><span style="color:var(--ds-text,#172b4d);">(<em>read-only; integer</em></span><span style="color:var(--ds-text,#172b4d);">)</span></td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The total amount of transmitted multicast packets on the interface.</span></td></tr></tbody></table></div><p>Multicast forwarding cache (MFC) status.</p><p><strong>Sub-menu:</strong> <code>/routing igmp-proxy mfc</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Property</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd"><span><strong>active-downstream-interfaces</strong> </span>(<em>read-only:<span> </span>name</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The packet stream is going out of the router through this interface.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>bytes</strong><span> </span>(<em>read-only:<span> integer</span></em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The total amount of received multicast traffic.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>group</strong><span> </span>(<em>read-only: IP address</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">IGMP group address.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>packets</strong><span> </span>(<em>read-only: integer</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The total amount of received multicast packets.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>source</strong><span> </span>(<em>read-only: IP address</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The multicast data originator address.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>upstream-interface</strong><span> </span>(<em>read-only: name</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The packet stream is coming into the router through this interface.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>wrong-packets</strong><span> </span>(<em>read-only: integer</em>)</td><td style="text-align: left;" class="confluenceTd"><p>The total amount of received multicast packets that arrived on a wrong interface, for example, a multicast stream that is received on a downstream interface instead of an upstream interface.</p></td></tr></tbody></table></div><p>RouterOS support static multicast forwarding rules for IGMP proxy. If a static rule is added, all dynamic rules for that group will be ignored. These rules will take effect only if IGMP-proxy interfaces are configured (upstream and downstream interfaces should be set) or these rules won't be active.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Property</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd"><span><strong>downstream-interfaces</strong> </span>(<em>name</em>; Default: )</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The received stream will be sent out to the listed interfaces only.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>group</strong><span> </span>(<em>read-only: IP address</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);"><span>The </span>multicast group address this rule applies.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>source</strong><span> </span>(<em>read-only: IP address</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);">The multicast data originator address.</span></td></tr><tr><td style="text-align: left;" class="confluenceTd"><strong>upstream-interface</strong><span> </span>(<em>read-only: name</em>)</td><td style="text-align: left;" class="confluenceTd"><span style="color:var(--ds-text-accent-lime-bolder,#37471f);"><span>The </span>interface that is receiving stream data.</span></td></tr></tbody></table></div><h1 class="auto-cursor-target" id="IGMPProxy-Examples">Examples</h1><hr/><p>To forward all multicast data coming from<span> the </span>ether2<span> </span>interface to the downstream bridge interface, where subscribers are connected, use the configuration below. Both interfaces should have an IP address.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/routing igmp-proxy interface
add interface=ether2 upstream=yes
add interface=bridge1

[admin@MikroTik] /routing igmp-proxy interface print
Flags: U - UPSTREAM
Columns: INTERFACE, THRESHOLD
#   INTERFACE  THRESHOLD
0 U ether2             1
1   bridge1            1</pre>
</div></div><p>You may also need to configure <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">alternative-subnets</span></code> on the upstream interface in case the multicast sender address is in an IP subnet that is not directly reachable from the local router:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/routing igmp-proxy interface
set [find upstream=yes] alternative-subnets=192.168.50.0/24,192.168.60.0/24</pre>
</div></div><p>To enable <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">quick-leave</span></code>, use the setting below:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/routing igmp-proxy
set quick-leave=yes</pre>
</div></div>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:53</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
