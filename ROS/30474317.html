<!DOCTYPE html>
<html>
    <head>
        <title>RouterOS : CRS3xx, CRS5xx, CCR2116, CCR2216 switch chip features</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="RouterOS_328059.html">RouterOS</a></span>
                            </li>
                                                    <li>
                                <span><a href="Bridging-and-Switching_328068.html">Bridging and Switching</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RouterOS : CRS3xx, CRS5xx, CCR2116, CCR2216 switch chip features
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Edgars P.</span>, last updated on May 13, 2025
    
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><span class="mw-headline"><style type='text/css'>/*<![CDATA[*/
div.rbtoc1747742023831 {padding: 0px;}
div.rbtoc1747742023831 ul {margin-left: 0px;}
div.rbtoc1747742023831 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1747742023831'>
<ul class='toc-indentation'>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Summary'>Summary</a>
<ul class='toc-indentation'>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Features'>Features</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Models'>Models</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Abbreviations'>Abbreviations</a></li>
</ul>
</li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Portswitching'>Port switching</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLAN'>VLAN</a>
<ul class='toc-indentation'>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLANFiltering'>VLAN Filtering</a>
<ul class='toc-indentation'>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Port-BasedVLAN'>Port-Based VLAN</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-MACBasedVLAN'>MAC Based VLAN</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-ProtocolBasedVLAN'>Protocol Based VLAN</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLANTunneling(Q-in-Q)'>VLAN Tunneling (Q-in-Q)</a></li>
</ul>
</li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-IngressVLANtranslation'>Ingress VLAN translation</a></li>
</ul>
</li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-(R/M)STP'>(R/M)STP</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Bonding'>Bonding</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Multi-chassisLinkAggregationGroup'>Multi-chassis Link Aggregation Group</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-L3HardwareOffloading'>L3 Hardware Offloading</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Portisolation'>Port isolation</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-IGMP/MLDSnooping'>IGMP/MLD Snooping</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-DHCPSnoopingandDHCPOption82'>DHCP Snooping and DHCP Option 82</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-ControllerBridgeandPortExtender'>Controller Bridge and Port Extender</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Mirroring'>Mirroring</a>
<ul class='toc-indentation'>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Configurationexamples'>Configuration examples</a>
<ul class='toc-indentation'>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-PortBasedMirroring'>Port Based Mirroring</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLANBasedMirroring'>VLAN Based Mirroring</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-MACBasedMirroring'>MAC Based Mirroring</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-IPBasedMirroring'>IP Based Mirroring</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-RemoteSwitchPortAnalyzer'>Remote Switch Port Analyzer</a></li>
</ul>
</li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-PropertyReference'>Property Reference</a></li>
</ul>
</li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-TrafficShaping'>Traffic Shaping</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-TrafficStormControl'>Traffic Storm Control</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-MPLShardwareoffloading'>MPLS hardware offloading</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-SwitchRules(ACL)'>Switch Rules (ACL)</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-PortSecurity'>Port Security</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-DualBoot'>Dual Boot</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-ConfiguringSwOSusingRouterOS'>Configuring SwOS using RouterOS</a></li>
<li><a href='#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Seealso'>See also</a></li>
</ul>
</div></span></p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Summary"><span class="mw-headline">Summary</span></h1><hr/><p>The CCR3xx, CRS5xx series switches and CCR2116, CCR2216 routers have highly integrated switches with high-performance CPU and feature-rich packet processors. These devices can be designed into various Ethernet applications including unmanaged switch, Layer 2 managed switch, carrier switch, inter-VLAN router, and wired unified packet processor.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>This article applies to CRS3xx, CRS5xx series switches, CCR2116, CCR2216 routers, and not to <a href="https://help.mikrotik.com/docs/pages/viewpage.action?pageId=103841835" rel="nofollow">CRS1xx/CRS2xx series switches</a>.</p></div></div><h2 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Features"><span class="mw-headline">Features</span></h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Features</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>Forwarding</strong></td><td class="confluenceTd"><ul class="bullets"><li>Configurable ports for switching or routing</li><li>Full non-blocking wire-speed switching</li><li>Large Unicast FDB for Layer 2 unicast forwarding</li><li>Forwarding Databases works based on IVL</li><li>Jumbo frame support</li><li>IGMP Snooping support</li><li>DHCP Snooping with Option 82Â </li></ul></td></tr><tr><td class="confluenceTd"><strong>Routing</strong></td><td class="confluenceTd"><div class="content-wrapper"><ul><li>Layer 3 Hardware Offloading:<ul><li>IPv4, IPv6 Unicast Routing</li><li>Supported on Ethernet, Bridge, Bonding, and VLAN interfaces</li><li>ECMP</li><li>Blackholes</li><li>Offloaded Fasttrack connections <sup>1</sup></li><li>Offloaded NAT for Fasttrack connections <sup>1</sup></li><li>Multiple MTU profiles</li></ul></li></ul><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>1. Applies only to <a href="https://help.mikrotik.com/docs/spaces/ROS/pages/62390319/L3+Hardware+Offloading#L3HardwareOffloading-L3HWDeviceSupport" rel="nofollow">certain switch models</a></p></div></div></div></td></tr><tr><td class="confluenceTd"><strong>Spanning Tree Protocol</strong></td><td class="confluenceTd"><ul class="bullets"><li>STP</li><li>RSTP</li><li>MSTP</li><li data-uuid="d7ae0a36-b7d3-4b3d-abe3-c425a27091fd">Edge port, BPDU Guard, Root Guard</li></ul></td></tr><tr><td class="confluenceTd"><strong>Mirroring</strong></td><td class="confluenceTd"><ul class="bullets"><li>Various types of mirroring:<ul class="bullets"><li>Port based mirroring</li><li>VLAN based mirroring</li><li>MAC based mirroring</li><li data-uuid="99d9247c-d1ae-4ab8-b79e-3429d84765cd">Remote Switch Port Analyzer (RSPAN)</li></ul></li></ul></td></tr><tr><td class="confluenceTd"><strong>VLAN</strong></td><td class="confluenceTd"><ul class="bullets"><li>Fully compatible with IEEE802.1Q and IEEE802.1ad VLAN</li><li>4k active VLANs</li><li>Flexible VLAN assignment:<ul class="bullets"><li>Port based VLAN</li><li>Protocol based VLAN</li><li>MAC based VLAN</li></ul></li><li>VLAN filtering</li><li>Ingress VLAN translation</li><li data-uuid="a05d2e16-6f42-4a58-83e6-c98376108b84">Multiple VLAN Registration protocol (MVRP)</li></ul></td></tr><tr><td class="confluenceTd"><strong>Bonding</strong></td><td class="confluenceTd"><ul class="bullets"><li>Supports 802.3ad (LACP), balance-xor and active-backup modes</li><li>Up to 8 member ports per bonding interface</li><li>Hardware automatic failover and load balancing</li><li>MLAG</li></ul></td></tr><tr><td class="confluenceTd"><strong>Quality of Service (QoS)</strong></td><td class="confluenceTd"><div class="content-wrapper"><ul class="bullets"><li><p>Eight output queues per port</p></li><li data-uuid="6801dba0-bb0b-4a7e-9c94-51ea0d9e105d"><p>DSCP and 802.1p PCP mapping</p></li><li data-uuid="fa2eb019-eda2-4aa7-bbc7-31783120490f"><p>Port based Layer2 and Layer3 trust settings</p></li><li data-uuid="dd2a0168-56b7-4e96-8ded-22fc97835e04"><p>Port and Queue based egress rate limiter</p></li><li data-uuid="52b67055-cce9-4245-9791-eb97a2737b91"><p>Policy based QoS via ACL rules</p></li><li data-uuid="ec30438c-ac31-4195-bc2c-8c888d9889bc"><p>Strict Priority (SP) and Shaped Deficit Weighted Round Robin (SDWRR) queuing</p></li><li data-uuid="2af2dede-cb7b-41d3-894b-3f0ae83bab29"><p>Enhanced Transmission Selection (ETS) scheduling</p></li><li data-uuid="35059381-3bf4-43c4-82bb-994f1cf2a75a"><p>Weighted Random Early Detection (WRED) <sup>1</sup></p></li><li data-uuid="6471dd33-f67b-4414-a3cd-aea099dc93d3"><p>Explicit Congestion Notification (ECN) <sup>1</sup></p></li><li data-uuid="accd0cf0-45f1-4663-b1f4-cc5e771ea528"><p>Priority-based Flow Control (PFC) <sup>1</sup></p></li><li data-uuid="60c9d6c4-83a6-4bd0-a768-5dd5afdd602e"><p>Resource allocation control (queue, shared-pool and multicast based) with extensive monitoring capabilities</p></li><li data-uuid="e04a21b4-6ee9-4419-b518-e1399b973b31"><p>Compatible with Dante enviroments</p></li><li data-uuid="030db861-d096-4077-9d34-f39793ae6d09"><p>Compatible with RDMA over Converged Ethernet (RoCE) enviroment <sup>1</sup></p></li><li data-uuid="a87337f6-eef7-4677-b04e-791afb8b321d"><p>Ingress traffic limiting (port based or via ACL rules)</p></li><li data-uuid="94f18faf-cc18-4378-ae49-1a26afe03345"><p>Traffic storm control</p></li></ul><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>1. Applies only to <a href="https://help.mikrotik.com/docs/spaces/ROS/pages/189497483/Quality+of+Service#QualityofService-deviceQoSDeviceSupport" rel="nofollow">certain switch models</a></p></div></div></div></td></tr><tr><td class="confluenceTd"><strong>Port isolation</strong></td><td class="confluenceTd"><ul class="bullets"><li>Applicable for Private VLAN implementation</li></ul></td></tr><tr><td class="confluenceTd"><strong>Access Control List</strong></td><td class="confluenceTd"><ul class="bullets"><li>Ingress ACL tables</li><li>Classification based on ports, L2, L3, L4 protocol header fields</li><li>ACL actions include filtering, forwarding and modifying of the protocol header fields</li></ul></td></tr><tr><td class="confluenceTd"><strong>PTP</strong></td><td class="confluenceTd"><div class="content-wrapper"><ul class="alternate"><li data-uuid="1aa25f50-1101-4393-997d-0772705b1aec">Two-step Ordinary Clock and Boundary Clock.</li><li data-uuid="2e802959-bc7d-4100-b000-d872c1c69cd5">Hardware timestamping, ensuring clock syncronization in nanosecond(ns) range.</li><li data-uuid="74fda747-9236-45db-9bb2-2076cfe9f114">IPv4 and Layer 2 (L2) multicast transport modes.</li><li data-uuid="5395642e-6d3f-443f-8c45-3cdd44a0ca91">End-to-End (E2E) and Peer-to-Peer (P2P) delay mechanisms.</li><li data-uuid="fb14e78d-ca34-4616-bd94-2c233580452c">IEEE 1588-2008 (PTPv2)</li><li data-uuid="82ee00c1-d0aa-45d0-8289-f33401de4ff6">Profile Support for:<ul><li>802.1AS: Audio Video Bridging (AVB) and Time-Sensitive Networking (TSN).</li><li>AES67: High-performance audio-over-IP interoperability.</li><li>G.8275.1: Frequency and phase synchronization in PTP-aware networks.</li><li>SMPTE: Audio/video synchronization in professional broadcast environments</li></ul></li></ul><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-text,#333333);"><span style="color:var(--ds-text,#172b4d);">PTP support is hardware-dependent, please refer to the list of </span><a href="https://help.mikrotik.com/docs/display/ROS/Precision+Time+Protocol#PrecisionTimeProtocol-SupportedDevices" rel="nofollow" style="text-align: left;">supported devices.</a></span></p></div></div></div></td></tr></tbody></table></div><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>For L3 hardware offloading feature support and hardware limits, please refer to <a href="https://help.mikrotik.com/docs/display/ROS/L3+Hardware+Offloading#L3HardwareOffloading-L3HWFeatureSupport" rel="nofollow">Feature Support</a> and <a href="https://help.mikrotik.com/docs/display/ROS/L3+Hardware+Offloading#L3HardwareOffloading-L3HWDeviceSupport" rel="nofollow">Device Support</a> user manuals.</p></div></div><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>For QoS hardware offloading feature support and hardware limits, please refer toÂ <a href="https://help.mikrotik.com/docs/spaces/ROS/pages/189497483/Quality+of+Service" rel="nofollow">Quality of Service (QoS)</a> user manuals.</p></div></div><h2 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Models"><span class="mw-headline">Models</span></h2><p>This table clarifies the main differences between Cloud Router Switch models and CCR routers.</p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="text-align: center;width: 100.1%;"><colgroup><col style="width: 16.2013%;"/><col style="width: 9.60347%;"/><col style="width: 6.45118%;"/><col style="width: 4.25192%;"/><col style="width: 8.35721%;"/><col style="width: 9.8967%;"/><col style="width: 6.15795%;"/><col style="width: 6.45118%;"/><col style="width: 7.33089%;"/><col style="width: 5.49817%;"/><col style="width: 9.60347%;"/><col style="width: 10.1899%;"/></colgroup><tbody><tr><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title=""><u>Model</u></strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title="">Switch Chip</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title="">CPU</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title="">Cores</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title="">10G SFP+</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background color :"><strong title="">10G Ethernet</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background color :"><strong title="">25G SFP28</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background color :"><strong title="">40G QSFP+</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background color :"><strong title="">100G QSFP28</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title="">ACL rules</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title="">Unicast FDB entries</strong></td><td class="highlight-grey confluenceTd" data-highlight-colour="grey" title="Background colour : undefined"><strong title="">Jumbo Frame (Bytes)</strong></td></tr><tr><td class="confluenceTd">netPower 15FR (CRS318-1Fi-15Fr-2S)</td><td class="confluenceTd"><strong>Marvell-98DX224S</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">netPower 16P (CRS318-16P-2S+)</td><td class="confluenceTd"><strong>Marvell-98DX226S</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS310-1G-5S-4S+ (netFiber 9/IN)</td><td class="confluenceTd"><strong>Marvell-98DX226S</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS320-8P-8B-4S+RM</td><td class="confluenceTd"><strong>Marvell-98DX226S</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>128<br/></strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS304-4XG-IN</td><td class="confluenceTd"><strong>Marvell-98DX2528</strong></td><td class="confluenceTd"><strong>1200 MHz</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS326-24G-2S+ (RM/IN)</td><td class="confluenceTd"><strong>Marvell-98DX3236</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS328-24P-4S+</td><td class="confluenceTd"><strong>Marvell-98DX3236</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS328-4C-20S-4S+</td><td class="confluenceTd"><strong>Marvell-98DX3236</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS305-1G-4S+</td><td class="confluenceTd"><strong>Marvell-98DX3236</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>128</strong></td><td class="confluenceTd"><strong>16,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS309-1G-8S+</td><td class="confluenceTd"><strong>Marvell-98DX8208</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>8</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>1024</strong></td><td class="confluenceTd"><strong>32,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS317-1G-16S+</td><td class="confluenceTd"><strong>Marvell-98DX8216</strong></td><td class="confluenceTd"><strong>800MHz</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>16</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>1024</strong></td><td class="confluenceTd"><strong>128,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS312-4C+8XG</td><td class="confluenceTd"><strong>Marvell-98DX8212</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>4 (combo ports)</strong></td><td class="confluenceTd"><strong>8 + 4 (combo ports)</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>512</strong></td><td class="confluenceTd"><strong>32,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS326-24S+2Q+</td><td class="confluenceTd"><strong>Marvell-98DX8332</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>24</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>256</strong></td><td class="confluenceTd"><strong>32,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS326-4C+20G+2Q+RM</td><td class="confluenceTd"><strong>Marvell-98DX8332</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1<br/></strong></td><td class="confluenceTd"><strong>4 (combo ports)</strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>256</strong></td><td class="confluenceTd"><strong>32,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS354-48G-4S+2Q+</td><td class="confluenceTd"><strong>Marvell-98DX3257</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>170</strong></td><td class="confluenceTd"><strong>32,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS354-48P-4S+2Q+</td><td class="confluenceTd"><strong>Marvell-98DX3257</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>170</strong></td><td class="confluenceTd"><strong>32,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS504-4XQ (IN/OUT)</td><td class="confluenceTd"><strong>Marvell-98DX4310</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>1024</strong></td><td class="confluenceTd"><strong>128,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS510-8XS-2XQ-IN</td><td class="confluenceTd"><strong>Marvell-98DX4310</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>8</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>1024</strong></td><td class="confluenceTd"><strong>128,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd">CRS518-16XS-2XQ</td><td class="confluenceTd"><strong>Marvell-98DX8525</strong></td><td class="confluenceTd"><strong>650MHz</strong></td><td class="confluenceTd"><strong>1</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>16</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>1024</strong></td><td class="confluenceTd"><strong>128,000</strong></td><td class="confluenceTd"><strong>10218</strong></td></tr><tr><td class="confluenceTd"><span class="productMainTitle">CRS520-4XS-16XQ-RM</span></td><td class="confluenceTd"><strong>Marvell-98CX8410</strong></td><td class="confluenceTd"><strong>2000MHz</strong></td><td class="confluenceTd"><strong>4<br/></strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>2<br/></strong></td><td class="confluenceTd"><strong>4<br/></strong></td><td class="confluenceTd"><strong>-<br/></strong></td><td class="confluenceTd"><strong>16<br/></strong></td><td class="confluenceTd"><strong>682<br/></strong></td><td class="confluenceTd"><strong>256,000<br/></strong></td><td class="confluenceTd"><strong>9570</strong></td></tr><tr><td class="confluenceTd">CCR2116-12G-4S+</td><td class="confluenceTd"><strong>Marvell-98DX3255</strong></td><td class="confluenceTd"><strong>2000MHz</strong></td><td class="confluenceTd"><strong>16</strong></td><td class="confluenceTd"><strong>4</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>512</strong></td><td class="confluenceTd"><strong>32,000</strong></td><td class="confluenceTd"><strong>9570</strong></td></tr><tr><td class="confluenceTd">CCR2216-1G-12XS-2XQ</td><td class="confluenceTd"><strong>Marvell-98DX8525</strong></td><td class="confluenceTd"><strong>2000MHz</strong></td><td class="confluenceTd"><strong>16</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>12</strong></td><td class="confluenceTd"><strong>-</strong></td><td class="confluenceTd"><strong>2</strong></td><td class="confluenceTd"><strong>1024</strong></td><td class="confluenceTd"><strong>128,000</strong></td><td class="confluenceTd"><strong>9570</strong></td></tr></tbody></table></div><h2 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Abbreviations"><span class="mw-headline">Abbreviations</span></h2><ul><li>FDB - Forwarding Database</li><li>MDB - Multicast Database</li><li>SVL - Shared VLAN Learning</li><li>IVL - Independent VLAN Learning</li><li>PVID - Port VLAN ID</li><li>ACL - Access Control List</li><li>CVID - Customer VLAN ID</li><li>SVID - Service VLAN ID</li></ul><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Portswitching"><span class="mw-headline">Port switching</span></h1><hr/><p>In order to set up a port switching, check the<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-BridgeHardwareOffloading" rel="nofollow">Bridge Hardware Offloading</a><span>Â </span>page.</p><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Currently, it is possible to create only one bridge with hardware offloading. Use the<span>Â </span><code>hw=yes/no</code><span>Â </span>parameter to select which bridge will use hardware offloading.</p></div></div><p><br/></p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Bridge STP/RSTP/MSTP, IGMP Snooping and VLAN filtering settings don't affect hardware offloading, since RouterOS v6.42 Bonding interfaces are also hardware offloaded.</p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLAN"><span class="mw-headline">VLAN</span></h1><hr/><p>Since RouterOS version 6.41, a bridge provides VLAN aware Layer2 forwarding and VLAN tag modifications within the bridge. This set of features makes bridge operation more like a traditional Ethernet switch and allows to overcome Spanning Tree compatibility issues compared to the configuration when tunnel-like VLAN interfaces are bridged. Bridge VLAN Filtering configuration is highly recommended to comply with STP (802.1D), RSTP (802.1w) standards and it is mandatory to enable MSTP (802.1s) support in RouterOS.</p><h2 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLANFiltering"><span class="mw-headline">VLAN Filtering</span></h2><p><span class="mw-headline">VLAN filtering is described on the<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-BridgeVLANFiltering" rel="nofollow">Bridge VLAN Filtering</a><span>Â </span>section.</span></p><p><span style="font-size: 20.0px;letter-spacing: -0.008em;">VLAN setup examples</span></p><p><span class="mw-headline">Below are describes some of the most common ways how to utilize VLAN forwarding.</span></p><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Port-BasedVLAN"><span class="mw-headline">Port-Based VLAN</span></h3><p>The configuration is described on the<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-BridgeVLANFiltering" rel="nofollow">Bridge VLAN FIltering</a><span>Â </span>section.</p><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-MACBasedVLAN"><span class="mw-headline">MAC Based VLAN</span></h3><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><ul><li>The Switch Rule table is used for MAC Based VLAN functionality, see<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Models" rel="nofollow">this table</a><span>Â </span>on how many rules each device supports.</li><li>MAC-based VLANs will only work properly between switch ports and not between switch ports and CPU. When a packet is being forwarded to the CPU, theÂ <code>pvid</code>Â property for the bridge port will be always used instead ofÂ <code>new-vlan-idÂ </code>from ACL rules.</li><li>MAC-based VLANs will not work for DHCP packets when DHCP snooping is enabled.</li></ul></div></div><p>Enable switching on ports by creating a bridge with enabled hw-offloading:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge
add name=bridge1 vlan-filtering=yes
/interface bridge port
add bridge=bridge1 interface=ether2 hw=yes
add bridge=bridge1 interface=ether7 hw=yes</pre>
</div></div><p>Add VLANs in the Bridge VLAN table and specify ports:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge vlan
add bridge=bridge1 tagged=ether2 untagged=ether7 vlan-ids=200,300,400</pre>
</div></div><p>Add Switch rules which assign VLAN id based on MAC address:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch rule
add switch=switch1 ports=ether7 src-mac-address=A4:12:6D:77:94:43/FF:FF:FF:FF:FF:FF new-vlan-id=200
add switch=switch1 ports=ether7 src-mac-address=84:37:62:DF:04:20/FF:FF:FF:FF:FF:FF new-vlan-id=300
add switch=switch1 ports=ether7 src-mac-address=E7:16:34:A1:CD:18/FF:FF:FF:FF:FF:FF new-vlan-id=400</pre>
</div></div><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-ProtocolBasedVLAN"><span class="mw-headline">Protocol Based VLAN</span></h3><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><ul><li>The Switch Rule table is used for Protocol Based VLAN functionality, see<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Models" rel="nofollow">this table</a><span>Â </span>on how many rules each device supports.</li><li class="auto-cursor-target">Protocol-based VLANs will only work properly between switch ports and not between switch ports and CPU. When a packet is being forwarded to the CPU, the <code>pvid</code>Â property for the bridge port will be always used instead ofÂ <code>new-vlan-idÂ </code>from ACL rules.</li><li class="auto-cursor-target">Protocol-based VLANs will not work for DHCP packets when DHCP snooping is enabled.</li></ul></div></div><p>Enable switching on ports by creating a bridge with enabled hw-offloading:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge
add name=bridge1 vlan-filtering=yes
/interface bridge port
add bridge=bridge1 interface=ether2 hw=yes
add bridge=bridge1 interface=ether6 hw=yes
add bridge=bridge1 interface=ether7 hw=yes
add bridge=bridge1 interface=ether8 hw=yes</pre>
</div></div><p>Add VLANs in the Bridge VLAN table and specify ports:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge vlan
add bridge=bridge1 tagged=ether2 untagged=ether6 vlan-ids=200
add bridge=bridge1 tagged=ether2 untagged=ether7 vlan-ids=300
add bridge=bridge1 tagged=ether2 untagged=ether8 vlan-ids=400</pre>
</div></div><p>Add Switch rules which assign VLAN id based on MAC protocol:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch rule
add mac-protocol=ip new-vlan-id=200 ports=ether6 switch=switch1
add mac-protocol=ipx new-vlan-id=300 ports=ether7 switch=switch1
add mac-protocol=0x80F3 new-vlan-id=400 ports=ether8 switch=switch1</pre>
</div></div><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLANTunneling(Q-in-Q)">VLAN Tunneling (Q-in-Q)</h3><p>Since RouterOS v6.43 it is possible to use a provider bridge (IEEE 802.1ad) and Tag Stacking VLAN filtering, and hardware offloading at the same time. The configuration is described in the<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-VLANTunneling(QinQ)" rel="nofollow">Bridge VLAN Tunneling (Q-in-Q)</a><span>Â </span>section.</p><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Devices with switch chip Marvell-98DX3257 (e.g. CRS354 series) do not support VLAN filtering on 1Gbps Ethernet interfaces for other VLAN types (<span style="color:var(--ds-icon-success,#22a06b);"><code>0x88a8</code></span> and <span style="color:var(--ds-icon-success,#22a06b);"><code>0x9100</code></span>).</p></div></div><h2 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-IngressVLANtranslation">Ingress VLAN translation</h2><p>It is possible to translate a certain VLAN ID to a different VLAN ID using ACL rules on an ingress port. In this example we create two ACL rules, allowing bidirectional communication. This can be done by doing the following.</p><p>Create a new bridge and add ports to it with hardware offloading:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge
add name=bridge1 vlan-filtering=no
/interface bridge port
add interface=ether1 bridge=bridge1 hw=yes
add interface=ether2 bridge=bridge1 hw=yes</pre>
</div></div><p>Add ACL rules to translate a VLAN ID in each direction:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch rule
add new-dst-ports=ether2 new-vlan-id=20 ports=ether1 switch=switch1 vlan-id=10
add new-dst-ports=ether1 new-vlan-id=10 ports=ether2 switch=switch1 vlan-id=20</pre>
</div></div><p>Add both VLAN IDs to the bridge VLAN table:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge vlan
add bridge=bridge1 tagged=ether1 vlan-ids=10
add bridge=bridge1 tagged=ether2 vlan-ids=20</pre>
</div></div><p>Enable bridge VLAN filtering:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge set bridge1 vlan-filtering=yes</pre>
</div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Bidirectional communication is limited only between two switch ports. Translating VLAN ID between more ports can cause traffic flooding or incorrect forwarding between the same VLAN ports.</p></div></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>By enabling<span>Â </span><code>vlan-filtering</code><span>Â </span>you will be filtering out traffic destined to the CPU, before enabling VLAN filtering you should make sure that you set up a<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-Managementaccessconfiguration" rel="nofollow">Management port</a>.</p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-(R/M)STP"><span class="mw-headline">(R/M)STP</span></h1><hr/><p>CRS3xx, CRS5xx series switches, and CCR2116, CCR2216 routers are capable of running STP, RSTP, and MSTP on a hardware level. For more detailed information you should check out the<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Spanning+Tree+Protocol" rel="nofollow">Spanning Tree Protocol</a><span>Â </span>manual page.</p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Bonding"><span class="mw-headline">Bonding</span></h1><hr/><p>CRS3xx, CRS5xx series switches and CCR2116, CCR2216 routers support hardware offloading with bonding interfaces. Only<span>Â </span><span style="color:var(--ds-background-accent-green-bolder,#1f845a);"><code>802.3ad</code></span> (LACP),Â <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">balance-xor</span></code> (static LAG) and <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">active-backup</span></code> bonding modes are hardware offloaded, other bonding modes will use the CPU's resources. You can find more information about the bonding interfaces in theÂ <a href="https://help.mikrotik.com/docs/display/ROS/Bonding" rel="nofollow">Bonding InterfaceÂ </a>section.</p><p>To create a hardware offloaded bonding interface, you must create a bonding interface with a supported bonding mode:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bonding
add mode=802.3ad name=bond1 slaves=ether1,ether2</pre>
</div></div><p><span style="letter-spacing: 0.0px;">This interface can be added to a bridge alongside other interfaces:</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge
add name=bridge
/interface bridge port
add bridge=bridge interface=bond1 hw=yes
add bridge=bridge interface=ether3 hw=yes
add bridge=bridge interface=ether4 hw=yes</pre>
</div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Do not add interfaces to a bridge that are already in a bond, RouterOS will not allow you to add an interface to bridge that is already a slave port for bonding.</p></div></div><p>Make sure that the bonding interface is hardware offloaded by checking the &quot;H&quot; flag:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false">/interface bridge port print 
Flags: X - disabled, I - inactive, D - dynamic, H - hw-offload 
 #     INTERFACE                                 BRIDGE                                 HW
 0   H bond1                                     bridge                                 yes
 1   H ether3                                    bridge                                 yes
 2   H ether4                                    bridge                                 yes</pre>
</div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>With HW-offloaded bonding interfaces, the built-in switch chip will always use Layer2+Layer3+Layer4 for a transmit hash policy, changing the transmit hash policy manually will have no effect.</p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Multi-chassisLinkAggregationGroup">Multi-chassis Link Aggregation Group</h1><hr/><p><span class="mw-headline"><span style="color:var(--ds-text,#172b4d);">MLAG (Multi-chassis Link Aggregation Group) implementation in RouterOS allows configuring LACP bonds on two separate devices, while the client device believes to be connected on the same machine. This provides a physical redundancy in case of switch failure. All CRS3xx, CRS5xx series and CCR2116, CCR2216 devices can be configured with MLAG. Read <a href="https://help.mikrotik.com/docs/display/ROS/Multi-chassis+Link+Aggregation+Group" rel="nofollow">here</a> for more information.</span></span></p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-L3HardwareOffloading"><span class="mw-headline">L3 Hardware Offloading</span></h1><hr/><p><span class="mw-headline"><span style="text-decoration: none;color:var(--ds-text,#172b4d);">Layer3 hardware offloading (otherwise known as IP switching or HW routing) will allow to offload some of the router features onto the switch chip. This allows reaching wire speeds when routing packets, which simply would not be possible with the CPU.Â </span></span></p><p><span class="mw-headline">Offloaded feature set depends on the used chipset. Read <a href="L3-Hardware-Offloading_62390319.html">here</a> for more info.</span></p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Portisolation"><span class="mw-headline">Port isolation</span></h1><hr/><p>Since RouterOS v6.43 is it possible to create a Private VLAN setup, an example can be found in the<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Switch+Chip+Features#SwitchChipFeatures-Portisolation" rel="nofollow">Switch chip port isolation</a><span>Â </span>manual page. Hardware offloaded bonding interfaces are not included in the switch port-isolation menu, but it is still possible to configure port-isolation individually on<span style="color:var(--ds-text,#172b4d);">Â each secondary interface of the bonding.</span></p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Port isolation can be used with vlan-filtering bridge and it is possible to isolate ports that are members of the same VLAN. The isolation works per-port, it is not possible to isolate ports per-VLAN.</p></div></div><p><br/></p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-IGMP/MLDSnooping"><span class="mw-headline">IGMP/MLD Snooping</span></h1><hr/><p>CRS3xx, CRS5xx series switches and CCR2116, CCR2216 routers are capable of using IGMP/MLD Snooping on a hardware level. To see more detailed information, you should check out the<span>Â </span><a href="https://help.mikrotik.com/docs/pages/viewpage.action?pageId=59277403" rel="nofollow">IGMP/MLD snooping</a><span>Â </span>manual page.</p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-DHCPSnoopingandDHCPOption82"><span class="mw-headline">DHCP Snooping and DHCP Option 82</span></h1><hr/><p>CRS3xx, CRS5xx series switches and CCR2116, CCR2216 routers are capable of using DHCP Snooping with Option 82 on a hardware level. The switch will create a dynamic ACL rule to capture the DHCP packets and redirect them to the main CPU for further processing. To see more detailed information, please visit the <a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-DHCPSnoopingandDHCPOption82" rel="nofollow">DHCP Snooping and DHCP Option 82</a><span>Â </span>manual page.</p><div role="region" aria-label="Info" class="confluence-information-macro  confluence-information-macro-information" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-info-filled confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Starting from RouterOS v7.17, DHCP snooping is supported with hardware offloading bonding interfaces.</p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-ControllerBridgeandPortExtender"><span class="mw-headline">Controller Bridge and Port Extender</span></h1><hr/><p><span class="mw-headline"><span style="color:var(--ds-text,#172b4d);">Controller Bridge (CB) and Port Extender (PE) is an IEEE 802.1BR standard implementation in RouterOS. It allows virtually extending the CB ports with a PE device and managing these extended interfaces from a single controlling device. Such configuration provides a simplified network topology, flexibility, increased port density, and ease of manageability. See more details on </span><a href="https://help.mikrotik.com/docs/display/ROS/Controller+Bridge+and+Port+Extender" rel="nofollow" style="text-decoration: none;">Controller Bridge and Port Extender manual</a><span style="color:var(--ds-text,#172b4d);">.</span></span></p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Mirroring"><span class="mw-headline">Mirroring</span></h1><hr/><p>Mirroring is a function that allows a network switch to duplicate all the data passing through it and send a copy to another specified port, known as the <span style="color:var(--ds-icon-success,#22a06b);"><code>mirror-target</code></span>. This feature is useful for setting up a tap device, which allows for analyzing network traffic using a separate device. You can set up mirroring in a simple way by designating source ports (see <span style="color:var(--ds-icon-success,#22a06b);"><code>mirror-egress</code></span> and <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-ingress</span></code> in <code>/interface/ethernet/switch/port</code>), or you can configure more advanced mirroring based on different criteria (see <code><span style="color:var(--ds-icon-success,#22a06b);">mirror</span></code> in <code>/interface/ethernet/switch/rule</code>).</p><p>It is important to note that the <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-target</span></code> port must be on the same switch. You can check the device block diagram or navigate to the <code>/interface/ethernet</code> menu to identify which interfaces are connected where. When setting up the configration, it is not mandatory to add the <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-target</span></code> interface to the same hardware offloaded bridge where the source ports are set up. The <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-target</span></code> port can be a standalone interface (not configured as a bridge port), or it can be within a bridge setup. When using the <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-target </span></code>with a bridge, note that data and mirrored traffic may both travel on the same LAN. In such cases, consider employing RSPAN (Remote Switch Port Analyzer), where mirrored traffic is encapsulated into a separate VLAN before being transmitted over the network.</p><p>Additionally, you can set the <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-target</span></code> port to a special value &quot;cpu&quot;, which means that the copied packets will be sent to the switch chip's CPU port.</p><h2 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Configurationexamples">Configuration examples</h2><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-PortBasedMirroring">Port Based Mirroring</h3><p class="auto-cursor-target">Starting from RouterOS version 7.15, it is possible to configure multiple source ports and selectively choose whether to mirror incoming traffic, outgoing traffic, or both. In this example, both incoming and outgoing traffic from the <strong>ether2</strong> interface will be copied and sent to the <strong>ether3</strong> interface for monitoring or analysis.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false"># Since RouterOS v7.15
/interface ethernet switch port
set ether2 mirror-egress=yes mirror-ingress=yes
/interface ethernet switch
set switch1 mirror-target=ether3

# Older RouterOS:
/interface ethernet switch
set switch1 mirror-source=ether2 mirror-target=ether3</pre>
</div></div><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-VLANBasedMirroring"><span style="letter-spacing: 0.0px;">VLAN Based Mirroring</span></h3><p><span style="letter-spacing: 0.0px;">Using ACL rules, it is possible to mirror packets from multiple interfaces using the <code><span style="color:var(--ds-icon-success,#22a06b);">ports</span></code> setting. Additionally, you can specify more detailed criteria such as VLAN ID, MAC/IP address or TCP/UDP port. Only <strong>ingress</strong> packets are mirrored to<span>Â </span><span style="color:var(--ds-icon-success,#22a06b);"><code>mirror-target</code></span><span>Â </span>interface. This example will mirror incoming VLAN 11 traffic from the <strong>ether2</strong> interface, and send copies to the <strong>ether3</strong> interface. To use an ACL rule with a <code><span style="color:var(--ds-icon-success,#22a06b);">vlan-id</span></code> matcher, you need to have <a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-BridgeVLANFiltering" rel="nofollow">bridge vlan-filtering</a> enabled.</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge
set bridge1 vlan-filtering=yes
/interface ethernet switch
set switch1 mirror-target=ether3
/interface ethernet switch rule
add mirror=yes ports=ether1 switch=switch1 vlan-id=11</pre>
</div></div><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-MACBasedMirroring">MAC Based Mirroring</h3><p>This example will mirror incoming traffic with 64:D1:54:D9:27:E6 MAC destination or source address from the <strong>ether1</strong> interface, and send copies to the <strong>ether3</strong> interface.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch
set switch1 mirror-target=ether3
/interface ethernet switch rule
add mirror=yes ports=ether1 switch=switch1 dst-mac-address=64:D1:54:D9:27:E6/FF:FF:FF:FF:FF:FF
add mirror=yes ports=ether1 switch=switch1 src-mac-address=64:D1:54:D9:27:E6/FF:FF:FF:FF:FF:FF</pre>
</div></div><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-IPBasedMirroring"><span style="letter-spacing: 0.0px;">IP Based Mirroring</span></h3><p><span style="letter-spacing: 0.0px;">This example will mirror incoming traffic with 192.168.88.0/24 IP destination or source address from the <strong>ether1</strong> interface, and send copies to the <strong>ether3</strong> interface.</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch
set switch1 mirror-target=ether3 mirror-source=none
/interface ethernet switch rule
add mirror=yes ports=ether1 switch=switch1 src-address=192.168.88.0/24
add mirror=yes ports=ether1 switch=switch1 dst-address=192.168.88.0/24</pre>
</div></div><p><span style="letter-spacing: 0.0px;">There are other options as well, check the</span><span style="letter-spacing: 0.0px;">Â </span><a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-SwitchRules(ACL)" rel="nofollow">ACL section</a><span style="letter-spacing: 0.0px;">Â </span><span style="letter-spacing: 0.0px;">to find out all possible parameters that can be used to match packets.</span></p><h3 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-RemoteSwitchPortAnalyzer"><span style="letter-spacing: 0.0px;">Remote Switch Port Analyzer</span></h3><p><span>This example will mirror incomming and outgoing traffic from the <strong>ether2</strong> interface, copies will be encapsulated in 802.1Q VLAN using the 999 as VLAN ID, and packets will be sent to the <strong>ether3</strong> interface. If the original traffic is already VLAN tagged, RSPAN will add another layer of VLAN tagging as an outer tag. This results in the mirrored traffic being tagged twice. If the <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-target</span></code> port is included in vlan-filtering bridge, it is not required to make the interface as tagged VLAN member under the <code>/interface/bridge/vlan</code> menuÂ for the RSPAN.</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch port
set ether2 mirror-egress=yes mirror-ingress=yes
/interface ethernet switch
set switch1 mirror-target=ether3 rspan=yes rspan-egress-vlan-id=999 rspan-ingress-vlan-id=999</pre>
</div></div><h2 style="text-align: left;" id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-PropertyReference"><span class="mw-headline">Property Reference</span></h2><p style="text-align: left;"><strong style="text-decoration: none;">Sub-menu:<code><span>Â </span></code></strong><code>/interface/ethernet/switch</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup class=""><col class=""/><col class=""/></colgroup><tbody class=""><tr class=""><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr class=""><td class="confluenceTd"><strong>mirror-target</strong><span>Â </span>(<em>cpu | name | none</em>; Default:<span> </span><strong>none</strong>)</td><td class="confluenceTd"><p>Selects a single mirroring target port. Packets from <span style="color:var(--ds-icon-success,#22a06b);"><code>mirror-egress</code></span> and <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-ingress</span></code> (<code>/interface/ethernet/switch/port</code>) andÂ <span style="color:var(--ds-icon-success,#22a06b);">mirror</span> (<code>/interface/ethernet/switch/rule</code>) will be sent to the selected port.</p></td></tr><tr class=""><td class="confluenceTd"><strong>rspan</strong><span>Â </span>(<em>no | yes</em>; Default:<span> <strong>no</strong></span>)</td><td class="confluenceTd">Enables Remote Switch Port Analyzer (RSPAN) feature on <code><span style="color:var(--ds-icon-success,#22a06b);">mirror-target</span></code>. Traffic marked for ingress or egress mirroring is carried over a specified remote analyzer VLAN - <code><span style="color:var(--ds-icon-success,#22a06b);">rspan-egress-vlan-id</span></code> and <code><span style="color:var(--ds-icon-success,#22a06b);">rspan-ingress-vlan-id</span></code>.</td></tr><tr class=""><td class="confluenceTd"><strong>rspan-egress-vlan-id</strong><span>Â </span>(<em>integer: 1..4095</em>; Default: <strong>1</strong>)</td><td class="confluenceTd">Selects the VLAN ID for marked egress traffic. Only applies when <code><span style="color:var(--ds-icon-success,#22a06b);">rspan</span></code> is enabled.</td></tr><tr class=""><td class="confluenceTd"><strong>rspan-ingress-vlan-id</strong><span>Â </span>(<em>integer: 1..4095</em>; Default: <strong>1</strong>)</td><td class="confluenceTd">Selects the VLAN ID for marked ingress traffic. Only applies when <code><span style="color:var(--ds-icon-success,#22a06b);">rspan</span></code> is enabled.</td></tr></tbody></table></div><p style="text-align: left;"><strong style="text-decoration: none;">Sub-menu:<code><span>Â </span></code></strong><code>/interface/ethernet/switch/port</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup class=""><col class=""/><col class=""/></colgroup><tbody class=""><tr class=""><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr class=""><td style="text-align: left;vertical-align: top;" class="confluenceTd"><span><strong>mirror-egress</strong><span>Â </span>(<em>noÂ | yes</em>; Default:Â <strong>no</strong>)</span></td><td style="text-align: left;vertical-align: top;" class="confluenceTd"><p>Whether to send egress packet copy to the<span>Â </span><span style="color:var(--ds-icon-success,#22a06b);"><code>mirror-target</code></span><span>Â </span>port.</p></td></tr><tr class=""><td style="text-align: left;vertical-align: top;" class="confluenceTd"><span><strong>mirror-ingress</strong><span>Â </span>(<em>noÂ | yes</em>; Default:Â <strong>no</strong>)</span></td><td style="text-align: left;vertical-align: top;" class="confluenceTd"><p>Whether to send ingress packet copy to the<span>Â </span><span style="color:var(--ds-icon-success,#22a06b);"><code>mirror-target</code></span><span>Â </span>port.</p></td></tr></tbody></table></div><p style="text-align: left;"><strong style="text-decoration: none;">Sub-menu:<code><span>Â </span></code></strong><code>/interface/ethernet/switch/rule</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup class=""><col class=""/><col class=""/></colgroup><tbody class=""><tr class=""><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr class=""><td style="text-align: left;vertical-align: top;" class="confluenceTd"><strong>mirror</strong><span>Â </span>(<em>noÂ | yes</em>; Default:<span>Â <strong>no</strong></span>)</td><td style="text-align: left;vertical-align: top;" class="confluenceTd">Whether to send a packet copy to<span>Â </span><span style="color:var(--ds-icon-success,#22a06b);"><code>mirror-target</code></span><span>Â </span>port.</td></tr></tbody></table></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-TrafficShaping"><span class="mw-headline">Traffic Shaping</span></h1><hr/><p>It is possible to limit ingress traffic that matches certain parameters with ACL rules and it is possible to limit ingress/egress traffic per port basis. The policer is used for ingress traffic, the shaper is used for egress traffic. The ingress policer controls the received traffic with packet drops. Everything that exceeds the defined limit will get dropped. This can affect the TCP congestion control mechanism on end hosts and achieved bandwidth can be actually less than defined. The egress shaper tries to queue packets that exceed the limit instead of dropping them. Eventually, it will also drop packets when the output queue gets full, however, it should allow utilizing the defined throughput better.</p><p>Port-based traffic police and shaper:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch port
set ether1 ingress-rate=10M egress-rate=5M</pre>
</div></div><p><span style="letter-spacing: 0.0px;">MAC-based traffic policer:</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch rule
add ports=ether1 switch=switch1 src-mac-address=64:D1:54:D9:27:E6/FF:FF:FF:FF:FF:FF rate=10M</pre>
</div></div><p><span style="letter-spacing: 0.0px;">VLAN-based traffic policer:</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge
set bridge1 vlan-filtering=yes
/interface ethernet switch rule
add ports=ether1 switch=switch1 vlan-id=11 rate=10M</pre>
</div></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>By enabling<span>Â </span><code>vlan-filtering</code><span>Â </span>you will be filtering out traffic destined to the CPU, before enabling VLAN filtering you should make sure that you set up a<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-Managementaccessconfiguration" rel="nofollow">Management port</a>.</p></div></div><p>Protocol-based traffic policer:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch rule
add ports=ether1 switch=switch1 mac-protocol=ipx rate=10M</pre>
</div></div><p><span style="letter-spacing: 0.0px;">There are other options as well, check the</span><span style="letter-spacing: 0.0px;">Â </span><a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-SwitchRules(ACL)" rel="nofollow">ACL section</a><span style="letter-spacing: 0.0px;">Â </span><span style="letter-spacing: 0.0px;">to find out all possible parameters that can be used to match packets.</span></p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The Switch Rule table is used for QoS functionality, see<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Models" rel="nofollow">this table</a><span>Â </span>on how many rules each device supports.</p></div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-text,#333333);">Due to hardware limitations, the <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">egress-rate</span></code> and <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">storm-rate</span></code> settings do not work correctly on 10Gbps switch ports when they are linked at 10/100Mbps, 1/2.5/5Gbps. This applies to 98DX224S, 98DX226S, 98DX2528, 98DX3236 switch chips.</span></p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-TrafficStormControl"><span class="mw-headline">Traffic Storm Control</span></h1><hr/><p>Since RouterOS v6.42 it is possible to enable traffic storm control. A traffic storm can emerge when certain frames are continuously flooded on the network. <span style="text-decoration: none;color:var(--ds-text,#172b4d);">Storm control settings is generally configured on non-uplink ports to restrict incoming storm traffic on those specific ports. This helps safeguard the entire switch and its connected ports by minimizing the impact of traffic storms across the network.Â </span></p><p>For example, if a network loop has been created and no loop avoidance mechanisms are used (e.g.<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/Spanning+Tree+Protocol" rel="nofollow">Spanning Tree Protocol</a>), broadcast or multicast frames can quickly overwhelm the network, causing degraded network performance or even complete network breakdown. With CRS3xx, CRS5xx series switches and CCR2116, CCR2216 routers it is possible to limit broadcast, unknown multicast and unknown unicast traffic. Unknown unicast traffic is considered when a switch does not contain a host entry for the destined MAC address. Unknown multicast traffic is considered when a switch does not contain a multicast group entry in the<span>Â </span><code>/interface bridge mdb</code><span>Â </span>menu. Storm control settings should be applied to ingress ports, the egress traffic will be limited.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" draggable="false" width="720" src="attachments/30474317/287506442.jpg" data-image-src="attachments/30474317/287506442.jpg" data-unresolved-comment-count="0" data-linked-resource-id="287506442" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="traffic_storm.jpg" data-base-url="https://help.mikrotik.com/docs" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="30474317" data-linked-resource-container-version="78" tabindex="0" alt=""></span></p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The storm control parameter is specified in percentage (%) of the link speed. If your link speed is 1Gbps, then specifying<span>Â </span><code>storm-rate</code><span>Â </span>as<span>Â </span><code>10</code><span>Â </span>will allow only 100Mbps of broadcast, unknown multicast and/or unknown unicast traffic to be forwarded.</p></div></div><p><strong>Sub-menu:</strong><span>Â </span><code>/interface ethernet switch port</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>limit-broadcasts</strong><span>Â </span>(<em>yes | no</em>; Default:<span>Â </span><strong>yes</strong>)</td><td class="confluenceTd">Limit broadcast traffic on a switch port.</td></tr><tr><td class="confluenceTd"><strong>limit-unknown-multicasts</strong><span>Â </span>(<em>yes | no</em>; Default:<span>Â </span><strong>no</strong>)</td><td class="confluenceTd">Limit unknown multicast traffic on a switch port.</td></tr><tr><td class="confluenceTd"><strong>limit-unknown-unicasts</strong><span>Â </span>(<em>yes | no</em>; Default:<span>Â </span><strong>no</strong>)</td><td class="confluenceTd">Limit unknown unicast traffic on a switch port.</td></tr><tr><td class="confluenceTd"><strong>storm-rate</strong><span>Â </span>(<em>integer 0..100</em>; Default:<span>Â </span><strong>100</strong>)</td><td class="confluenceTd">Amount of broadcast, unknown multicast and/or unknown unicast traffic is limited to in percentage of the link speed.</td></tr></tbody></table></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Devices with <span style="color:var(--ds-text,#333333);">98DX224S, 98DX226S, 98DX2528, 98DX3236</span> switch chip cannot distinguish unknown multicast traffic from all multicast traffic. For example, CRS326-24G-2S+ will limit all multicast traffic when<span>Â </span><code>limit-unknown-multicasts</code><span>Â </span>and<span>Â </span><code>storm-rate</code><span>Â </span>is used. For other devices, for example, CRS317-1G-16S+ the<span>Â </span><code>limit-unknown-multicasts</code><span>Â </span>parameter will limit only unknown multicast traffic (addresses that are not present in<span>Â </span><code>/interface bridge mdb).</code></p></div></div><p>For example, to limit 1% (10Mbps) of broadcast and unknown unicast traffic on ether1 (1Gbps), use the following commands:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch port
set ether1 storm-rate=1 limit-broadcasts=yes limit-unknown-unicasts=yes</pre>
</div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-text,#333333);">Due to hardware limitations, the <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">egress-rate</span></code> and <code><span style="color:var(--ds-background-accent-green-bolder,#1f845a);">storm-rate</span></code> settings do not work correctly on 10Gbps switch ports when they are linked at 10/100Mbps, 1/2.5/5Gbps. This applies to 98DX224S, 98DX226S, 98DX2528, 98DX3236 switch chips.</span></p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-MPLShardwareoffloading"><span class="mw-headline">MPLS hardware offloading</span></h1><hr/><p>Since RouterOS v6.41 it is possible to offload certain MPLS functions to the switch chip, the switch must be a (P)rovider router in a PE-P-PE setup in order to achieve hardware offloading. A setup example can be found in the<span>Â </span><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:Basic_MPLS_setup_example" rel="nofollow" style="text-decoration: none;" title="Manual:Basic MPLS setup example">Basic MPLS setup example</a><span>Â </span>manual page. The hardware offloading will only take place when LDP interfaces are configured as physical switch interfaces (e.g. Ethernet, SFP, SFP+).</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Currently only<span>Â </span><code>CRS317-1G-16S+</code><span>Â </span>and<span>Â </span><code>CRS309-1G-8S+</code><span>Â </span>using RouterOS v6.41 and newer are capable of hardware offloading certain MPLS functions.<span>Â </span><code>CRS317-1G-16S+</code><span>Â </span>and<span>Â </span><code>CRS309-1G-8S+</code><span>Â </span>built-in switch chip is not capable of popping MPLS labels from packets, in a PE-P-PE setup you either have to use explicit null or disable TTL propagation in MPLS network to achieve hardware offloading.</p></div></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The MPLS hardware offloading has been removed since RouterOS v7.</p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-SwitchRules(ACL)"><span class="mw-headline">Switch Rules (ACL)</span></h1><hr/><p>Access Control List contains ingress policy and egress policy engines. See<span>Â </span><a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Models" rel="nofollow">this table</a><span>Â </span>on how many rules each device supports. It is an advanced tool for wire-speed packet filtering, forwarding and modifying based on Layer2, Layer3 and Layer4 protocol header field conditions.</p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>ACL rules are checked for each received packet until a match has been found. If there are multiple rules that can match, then only the first rule will be triggered. A rule without any action parameters is a rule to accept the packet.</p></div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>It is not required to set <code><span style="color:var(--ds-icon-success,#22a06b);">mac-protocol</span></code> to certain IP version when using L3 or L4 matchers, however, it is recommended to set the <code><span style="color:var(--ds-icon-success,#22a06b);">mac-protocol=ip</span></code> or <code><span style="color:var(--ds-icon-success,#22a06b);">mac-protocol=ipv6</span></code>Â  when filtering any IP packets.</p></div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-text,#333333);">When switch ACL rules are modified (e.g. added, removed, disabled, enabled, or moved), the existing switch rules will be inactive for a short time. This can cause some packet leakage during the ACL rule modifications.</span></p></div></div><p><br/></p><p><strong>Sub-menu:</strong><span>Â </span><code>/interface ethernet switch rule</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>copy-to-cpu</strong><span>Â </span>(<em>no | yes</em>; Default:<span>Â </span><strong>no</strong>)</td><td class="confluenceTd">Clones the matching packet and sends it to the CPU.</td></tr><tr><td class="confluenceTd"><strong>disabled</strong><span>Â </span>(<em>yes | no</em>; Default:<span>Â </span><strong>no</strong>)</td><td class="confluenceTd">Enables or disables ACL entry.</td></tr><tr><td class="confluenceTd"><strong>dscp</strong><span>Â </span>(<em>0..63</em>)</td><td class="confluenceTd">Matching the DSCP field of the packet (only applies to IPv4 packets).</td></tr><tr><td class="confluenceTd"><strong>dst-address</strong><span>Â </span>(<em>IP address/Mask</em>)</td><td class="confluenceTd">Matching destination IPv4 address and mask, also matches the destination IP in ARP packets.Â </td></tr><tr><td class="confluenceTd"><strong>dst-address6</strong><span>Â </span>(<em>IPv6 address/Mask</em>)</td><td class="confluenceTd">Matching destination IPv6 address and mask.</td></tr><tr><td class="confluenceTd"><strong>dst-mac-address</strong><span>Â </span>(<em>MAC address/Mask</em>)</td><td class="confluenceTd">Matching destination MAC address and mask.</td></tr><tr><td class="confluenceTd"><strong>dst-port</strong><span>Â </span>(<em>0..65535</em>)</td><td class="confluenceTd">Matching destination protocol port number (applies to IPv4 and IPv6 packets if <span style="color:var(--ds-icon-success,#22a06b);"><code>mac-protocol</code></span> is not specified).</td></tr><tr><td class="confluenceTd"><strong>flow-label</strong><span>Â </span>(<em>0..1048575</em>)</td><td class="confluenceTd">Matching IPv6 flow label.</td></tr><tr><td class="confluenceTd"><strong>mac-protocol</strong><span>Â </span>(<em>802.2 | arp | capsman | dot1x | homeplug-av | ip | ipv6 | ipx | lacp | lldp | loop-protect | macsec | mpls-multicast | mpls-unicast | packing-compr | packing-simple | pppoe | pppoe-discovery | rarp | romon | service-vlan | vlan | or 0..65535 | or 0x0000-0xffff</em>)</td><td class="confluenceTd">Matching particular MAC protocol specified by protocol name or number</td></tr><tr><td class="confluenceTd"><strong>mirror</strong><span>Â </span>(<em>no | yes</em>)</td><td class="confluenceTd">Clones the matching packet and sends it to the mirror-target port.</td></tr><tr><td class="confluenceTd"><strong>new-dst-ports</strong><span>Â </span>(<em>ports | bond | all</em>)</td><td class="confluenceTd"><p>Changes the destination port to the specified value:</p><ul><li>If theÂ setting is left empty (e.g. <code>new-dst-ports=&quot;&quot;</code>), the packet will be dropped;</li><li>If a port orÂ <a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Bonding" rel="nofollow"> hardware-offloaded bonding </a>interface is specified, the packet will be redirected to that port. Only single port or bond interface is supported;</li><li>if you use theÂ <code>all</code> argument, packet will be allowed to pass through to the egress processing without being dropped;</li><li>If this parameter is not used, the packet will be accepted as is.</li></ul></td></tr><tr><td class="confluenceTd"><strong>new-vlan-id</strong><span>Â </span>(<em>0..4095</em>)</td><td class="confluenceTd">Changes the VLAN ID to the specified value. Requires<span>Â </span><code>vlan-filtering=yes</code>.</td></tr><tr><td class="confluenceTd"><strong>new-vlan-priority</strong><span>Â </span>(<em>0..7</em>)</td><td class="confluenceTd">Changes the VLAN priority (priority code point). Requires<span>Â </span><code>vlan-filtering=yes</code>.</td></tr><tr><td class="confluenceTd"><strong>ports</strong><span>Â </span>(<em>ports | bond</em>)</td><td class="confluenceTd">Matching switch interfaces where the rule will apply to incoming traffic. Multiple ports and <a href="https://help.mikrotik.com/docs/display/ROS/CRS3xx%2C+CRS5xx%2C+CCR2116%2C+CCR2216+switch+chip+features#CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Bonding" rel="nofollow">hardware-offloaded bonding</a> interfaces can be selected. Note that the <code>switch1-cpu</code> port cannot be selected. If <span style="color:var(--ds-background-accent-green-bolder,#1f845a);"><code>ports</code></span> property is left empty, the rule will apply to all switch interfaces.</td></tr><tr><td class="confluenceTd"><strong>protocol</strong><span>Â </span>(<em>dccp | ddp | egp | encap | etherip | ggp | gre | hmp | icmp | icmpv6 | idpr-cmtp | igmp | ipencap | ipip | ipsec-ah | ipsec-esp | ipv6 | ipv6-frag | ipv6-nonxt | ipv6-opts | ipv6-route | iso-tp4 | l2tp | ospf | pim | pup | rdp | rspf | rsvp | sctp | st | tcp | udp | udp-lite | vmtp | vrrp | xns-idp | xtp | or 0..255</em>)</td><td class="confluenceTd">Matching particular IP protocol specified by protocol name or number. Only applies to IPv4 packets if <code><span style="color:var(--ds-icon-success,#22a06b);">mac-protocol</span></code> is not specified. To match certain IPv6 protocols, use the <code><span style="color:var(--ds-icon-success,#22a06b);">mac-protocol=ipv6</span></code> setting.</td></tr><tr><td class="confluenceTd"><strong>rate</strong><span>Â </span>(<em>0..4294967295</em>)</td><td class="confluenceTd">Sets ingress traffic limitation (bits per second) for matched traffic.</td></tr><tr><td class="confluenceTd"><strong>redirect-to-cpu</strong><span>Â </span>(<em>no | yes</em>)</td><td class="confluenceTd">Changes the destination port of a matching packet to the CPU.</td></tr><tr><td class="confluenceTd"><strong>src-address</strong><span>Â </span>(<em>IP address/Mask</em>)</td><td class="confluenceTd">Matching source IPv4 address and mask, also matches the source IP in ARP packets.Â </td></tr><tr><td class="confluenceTd"><strong>src-address6</strong><span>Â </span>(<em>IPv6 address/Mask</em>)</td><td class="confluenceTd">Matching source IPv6 address and mask.</td></tr><tr><td class="confluenceTd"><strong>src-mac-address</strong><span>Â </span>(<em>MAC address/Mask</em>)</td><td class="confluenceTd">Matching source MAC address and mask.</td></tr><tr><td class="confluenceTd"><strong>src-port</strong><span>Â </span>(<em>0..65535</em>)</td><td class="confluenceTd">Matching source protocol port number (applies to IPv4 and IPv6 packets if <span style="color:var(--ds-icon-success,#22a06b);"><code>mac-protocol</code></span> is not specified).</td></tr><tr><td class="confluenceTd"><strong>switch</strong><span>Â </span>(<em>switch group</em>)</td><td class="confluenceTd">Matching switch group on which will the rule apply.</td></tr><tr><td class="confluenceTd"><strong>traffic-class</strong><span>Â </span>(<em>0..255</em>)</td><td class="confluenceTd">Matching IPv6 traffic class.</td></tr><tr><td class="confluenceTd"><strong>vlan-id</strong><span>Â </span>(<em>0..4095</em>)</td><td class="confluenceTd">Matching VLAN ID. Requires<span>Â </span><code>vlan-filtering=yes</code>.</td></tr><tr><td class="confluenceTd"><strong>vlan-header</strong><span>Â </span>(<em>not-present | present</em>)</td><td class="confluenceTd">Matching VLAN header, whether the VLAN header is present or not. Requires<span>Â </span><code>vlan-filtering=yes</code>.</td></tr><tr><td class="confluenceTd"><strong>vlan-priority</strong><span>Â </span>(<em>0..7</em>)</td><td class="confluenceTd">Matching VLAN priority (priority code point).</td></tr></tbody></table></div><p>Action parameters:</p><ul><li>copy-to-cpu</li><li>redirect-to-cpu</li><li>mirror</li><li>new-dst-ports (can be used to drop packets)</li><li>new-vlan-id</li><li>new-vlan-priority</li><li>rate</li></ul><p>Layer2 condition parameters:</p><ul><li>dst-mac-address</li><li>mac-protocol</li><li>src-mac-address</li><li>vlan-id</li><li>vlan-header</li><li>vlan-priority</li></ul><p>Layer3 condition parameters:</p><ul><li>dscp</li><li>protocol</li><li>IPv4 conditions:<ul><li>dst-address</li><li>src-address</li></ul></li><li>IPv6 conditions:<ul><li>dst-address6</li><li>flow-label</li><li>src-address6</li><li>traffic-class</li></ul></li></ul><p>Layer4 condition parameters:</p><ul><li>dst-port</li><li>src-port</li></ul><p><br/></p><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>For VLAN related matchers or VLAN related action parameters to work, you need to enable<span>Â </span><code>vlan-filtering</code><span>Â </span>on the bridge interface and make sure that hardware offloading is enabled on those ports, otherwise, these parameters will not have any effect.</p></div></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>When bridge interface<span>Â <code><span style="color:var(--ds-icon-success,#22a06b);">ether-type</span></code></span><span>Â </span>is set to <code><span style="color:var(--ds-icon-success,#22a06b);">0x8100</span></code>, then VLAN related ACL rules are relevant to<span> frames tagged using regular/customer VLAN (TPID </span>0x8100), this includes<span>Â </span><span style="color:var(--ds-icon-success,#22a06b);"><code>vlan-id</code></span><span>Â </span>and<span>Â </span><span style="color:var(--ds-icon-success,#22a06b);"><code>new-vlan-id</code></span>. When bridge interface <span><code><span style="color:var(--ds-icon-success,#22a06b);">ether-type</span></code></span><span>Â </span>is set to <code><span style="color:var(--ds-icon-success,#22a06b);">0x88a8</span></code>, then ACL rules are relevant to frames tagged with 802.1ad service tag (TPID 0x88a8).</p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-PortSecurity"><span class="mw-headline">Port Security</span></h1><hr/><p>It is possible to limit allowed MAC addresses on a single switch port. For example, to allow<span>Â </span>64:D1:54:81:EF:8E MAC address on a switch port,<span>Â </span>start by switching multiple ports together, in this example<span>Â </span>64:D1:54:81:EF:8EÂ is going to be located behind<span>Â </span><strong>ether1</strong>.Â </p><p><span style="letter-spacing: 0.0px;">Create an ACL rule to allow the given MAC address and drop all other traffic on</span><span style="letter-spacing: 0.0px;">Â </span><strong style="letter-spacing: 0.0px;">ether1</strong><span style="letter-spacing: 0.0px;">Â </span><span style="letter-spacing: 0.0px;">(for ingress traffic):</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface ethernet switch rule
add ports=ether1 src-mac-address=64:D1:54:81:EF:8E/FF:FF:FF:FF:FF:FF switch=switch1
add new-dst-ports=&quot;&quot; ports=ether1 switch=switch1</pre>
</div></div><p>Switch all required ports together, disable MAC learning and disable unknown unicast flooding on<span>Â </span><strong>ether1</strong>:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge
add name=bridge1
/interface bridge port
add bridge=bridge1 interface=ether1 hw=yes learn=no unknown-unicast-flood=no
add bridge=bridge1 interface=ether2 hw=yes</pre>
</div></div><p>Add a static hosts entry for<span>Â </span>64:D1:54:81:EF:8E<span>Â </span>(for egress traffic):</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: ros; gutter: false">/interface bridge host
add bridge=bridge1 interface=ether1 mac-address=64:D1:54:81:EF:8E</pre>
</div></div><div role="region" aria-label="Warning" class="confluence-information-macro  confluence-information-macro-warning" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>Broadcast traffic will still be sent out from<span>Â </span><strong>ether1</strong>. To limit broadcast traffic flood on a bridge port, you can use the<span>Â </span><code>broadcast-flood</code><span>Â </span>parameter to toggle it. Do note that some protocols depend on broadcast traffic, such as streaming protocols and DHCP.</p></div></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-DualBoot"><span class="mw-headline">Dual Boot</span></h1><hr/><p>The âdual bootâ feature allows you to choose which operating system you prefer to use on CRS3xx series switches, RouterOS or SwOS. Device operating system could be changed using:</p><ul><li>Command-line (<code>/system routerboard settings set boot-os=swos</code>)</li><li>Winbox</li><li><span style="letter-spacing: 0.0px;">Webfig</span></li><li><span style="letter-spacing: 0.0px;">Serial Console</span></li></ul><p><span style="letter-spacing: 0.0px;">More details about SwOS are described here:</span><span style="letter-spacing: 0.0px;">Â </span><a href="https://help.mikrotik.com/docs/display/SWOS/SwOS" rel="nofollow">SwOS manual</a></p><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-ConfiguringSwOSusingRouterOS"><span class="mw-headline">Configuring SwOS using RouterOS</span></h1><hr/><p>Since RouterOS 6.43 it is possible to load, save and reset SwOS configuration, as well as upgrade SwOS and set an IP address for the CRS3xx series switches by using RouterOS.</p><ul><li>Save configuration with<span>Â </span><code>/system swos save-config</code></li></ul><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The configuration will be saved on the same device withÂ <code>swos.config</code> as a filename, make sure you download the file from your device since the configuration file will be removed after a reboot.</p></div></div><ul><li>Load configuration with<span>Â </span><code>/system swos load-config</code></li><li>Change password with<span>Â </span><code>/system swos password</code></li><li>Reset configuration with<span>Â </span><code>/system swos reset-config</code></li><li>Upgrade SwOS from RouterOS using<span>Â </span><code>/system swos upgrade</code></li></ul><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p>The upgrade command will automatically install the latest available SwOS primary backup version, make sure that your device has access to the Internet in order for the upgrade process to work properly. When the device is booted into SwOS, the version number will include the letter &quot;p&quot;, indicating a primary backup version. You can then install the latest available SwOS secondary main version from the SwOS &quot;Upgrade&quot; menu.</p></div></div><div role="region" aria-label="Note" class="confluence-information-macro  confluence-information-macro-note" ><span role="presentation" class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" ></span><div class="confluence-information-macro-body"><p><span style="color:var(--ds-text,#172b4d);">Starting from RouterOS version 7.17 device-mode restricts SwOS/RouterOS transition for dual-boot; in order to enable: system/device-mode/update routerboard=yes</span></p></div></div><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><strong>address-acquisition-mode</strong><span>Â </span>(<em>dhcp-only | dhcp-with-fallback | static</em>; Default:<span>Â </span><strong>dhcp-with-fallback</strong>)</td><td class="confluenceTd">Changes address acquisition method:<p>dhcp-only<span>Â </span>- uses only a DHCP client to acquire address</p><p>dhcp-with-fallback<span>Â </span>- for the first 10 seconds will try to acquire address using a DHCP client. If the request is unsuccessful, then address falls back to static as defined by<span>Â </span>static-ip-address<span>Â </span>property</p><p>static<span>Â </span>- address is set as defined by<span>Â </span>static-ip-address<span>Â </span>property</p></td></tr><tr><td class="confluenceTd"><strong>allow-from</strong><span>Â </span>(<em>IP/Mask</em>; Default:<span>Â </span><strong>0.0.0.0/0</strong>)</td><td class="confluenceTd">IP address or a network from which the switch is accessible. By default, the switch is accessible by any IP address.</td></tr><tr><td class="confluenceTd"><strong>allow-from-ports</strong><span>Â </span>(<em>name</em>; Default: )</td><td class="confluenceTd">List of switch ports from which the device is accessible. By default, all ports are allowed to access the switch</td></tr><tr><td class="confluenceTd"><strong>allow-from-vlan</strong><span>Â </span>(<em>integer: 0..4094</em>; Default:<span>Â </span><strong>0</strong>)</td><td class="confluenceTd">VLAN ID from which the device is accessible. By default, all VLANs are allowed</td></tr><tr><td class="confluenceTd"><strong>identity</strong><span>Â </span>(<em>name</em>; Default:<span>Â </span><strong>Mikrotik</strong>)</td><td class="confluenceTd">Name of the switch (used for Mikrotik Neighbor Discovery protocol)</td></tr><tr><td class="confluenceTd"><strong>static-ip-address</strong><span>Â </span>(<em>IP</em>; Default:<span>Â </span><strong>192.168.88.1</strong>)</td><td class="confluenceTd">IP address of the switch in case<span>Â </span>address-acquisition-mode<span>Â </span>is either set to<span>Â </span>dhcp-with-fallback<span>Â </span>or<span>Â </span>static. By setting a static IP address, the address acquisition process does not change, which is DHCP with fallback by default. This means that the configured static IP address will become active only when there is going to be no DHCP servers in the same broadcast domain</td></tr></tbody></table></div><h1 id="CRS3xx,CRS5xx,CCR2116,CCR2216switchchipfeatures-Seealso"><span class="mw-headline">See also</span></h1><p><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:CRS_Router" rel="nofollow" style="text-decoration: none;" title="Manual:CRS Router">CRS Router</a></p><p><a class="external-link" href="https://wiki.mikrotik.com/wiki/Manual:CRS3xx_VLANs_with_Bonds" rel="nofollow" style="text-decoration: none;" title="Manual:CRS3xx VLANs with Bonds">CRS3xx VLANs with Bonds</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/Basic+VLAN+switching" rel="nofollow">Basic VLAN switching</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/Bridging+and+Switching#BridgingandSwitching-BridgeHardwareOffloading" rel="nofollow">Bridge Hardware Offloading</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/L3+Hardware+Offloading" rel="nofollow">Route Hardware Offloading</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/Spanning+Tree+Protocol" rel="nofollow">Spanning Tree Protocol</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/MTU+in+RouterOS" rel="nofollow">MTU on RouterBOARD</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/Layer2+misconfiguration" rel="nofollow">Layer2 misconfiguration</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/Bridge+VLAN+Table" rel="nofollow">Bridge VLAN Table</a></p><p><a href="https://help.mikrotik.com/docs/pages/viewpage.action?pageId=59277403" rel="nofollow">Bridge IGMP/MLD snooping</a></p><p><a href="https://help.mikrotik.com/docs/display/ROS/Multi-chassis+Link+Aggregation+Group" rel="nofollow">Multi-chassis Link Aggregation Group</a></p><p><br/></p>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/30474317/287506442.jpg">traffic_storm.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 20, 2025 14:53</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
